(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{486:function(s,t,a){"use strict";a.r(t);var n=a(8),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("[toc]")]),s._v(" "),t("h2",{attrs:{id:"insert"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#insert"}},[s._v("#")]),s._v(" Insert")]),s._v(" "),t("h3",{attrs:{id:"插入数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插入数据"}},[s._v("#")]),s._v(" 插入数据")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("values")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("…"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("…"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"查询表插入表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询表插入表"}},[s._v("#")]),s._v(" 查询表插入表")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("table_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("table_name_2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"update-和-delete"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update-和-delete"}},[s._v("#")]),s._v(" Update 和 Delete")]),s._v(" "),t("p",[s._v("ClickHouse 提供了 Delete 和 Update 的能力，这类操作被称为 Mutation 查询，它可以看做 Alter 的一种。")]),s._v(" "),t("p",[s._v("虽然可以实现修改和删除，但是和一般的 OLTP 数据库不一样，Mutation语句是一种很“重”的操作，而且不支持事务。“重”的原因主要是每次修改或者删除都会导致放弃目标数据的原有分区，重建新分区。")]),s._v(" "),t("p",[s._v("所以尽量做批量的变更，不要进行频繁小数据的操作。")]),s._v(" "),t("h3",{attrs:{id:"删除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" t_order_smt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" sku_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_001'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"修改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改"}},[s._v("#")]),s._v(" 修改")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" t_order_smt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" total_amount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("toDecimal32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("102")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("由于操作比较“重”，所以 Mutation 语句分两步执行，同步执行的部分其实只是进行新增数据新增分区和并把旧分区打上逻辑上的失效标记。直到触发分区合并的时候，才会删除旧数据释放磁盘空间，一般不会开放这样的功能给用户，由管理员完成。")]),s._v(" "),t("h2",{attrs:{id:"查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),t("h3",{attrs:{id:"group-by"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#group-by"}},[s._v("#")]),s._v(" Group by")]),s._v(" "),t("p",[s._v("创建表")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" t_order_mt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\nid UInt32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nsku_id String"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\ntotal_amount "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Decimal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\ncreate_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Datetime")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("engine")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("MergeTree\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("partition")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" toYYYYMMDD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("create_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("primary")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("插入测试数据")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" t_order_mt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("values")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_001'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-01 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_002'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-01 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_004'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-01 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_002'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-01 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_003'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-02 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_001'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-04 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_002'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-04 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_004'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-04 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_002'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-04 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sku_003'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2020-06-01 12:00:00'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h4",{attrs:{id:"with-rollup-从右至左去掉维度进行统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#with-rollup-从右至左去掉维度进行统计"}},[s._v("#")]),s._v(" with rollup:从右至左去掉维度进行统计")]),s._v(" "),t("p",[s._v("如：group by a,b,c ；")]),s._v(" "),t("p",[s._v("统计内容包括：group by a,b,c  / group by a,b /group by a  /group by")]),s._v(" "),t("p",[s._v("查询结果：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v(":"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_order_mt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" \n:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sku_id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with rollup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t_order_mt\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v("\n    id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    sku_id\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH ROLLUP")]),s._v("\n\nQuery id: acb0999c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6886")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("c4a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a51e"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("338116414836")]),s._v("\n\n┌──id─┬─sku_id──┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" │ sku_003 │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" │ sku_003 │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n└─────┴─────────┴───────────────────┘\n┌──id─┬─sku_id─┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" │        │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" │        │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000.00")]),s._v(" │\n└─────┴────────┴───────────────────┘\n┌─id─┬─sku_id─┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │        │          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16200.00")]),s._v(" │\n└────┴────────┴───────────────────┘\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Elapsed: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.007")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br")])]),t("h4",{attrs:{id:"with-cube-多维分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#with-cube-多维分析"}},[s._v("#")]),s._v(" with cube:多维分析")]),s._v(" "),t("p",[s._v("从右至左去掉维度进行小计，再从左至右去掉维度进行小计")]),s._v(" "),t("p",[s._v("如：group by a,b,c ；")]),s._v(" "),t("p",[s._v("统计内容包括：group by a,b,c  / group by a,b /group by a  /group by  b/group by  c/group by a,c / group by a,b /group by b,c/group by")]),s._v(" "),t("p",[s._v("查询结果：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_order_mt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" \nid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sku_id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" cube"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v(":"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_order_mt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" \n:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sku_id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" cube"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" t_order_mt\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v("\n    id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    sku_id\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" CUBE\n\nQuery id: fd93453a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("db65"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("b8"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("a5"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("be989d938743\n\n┌──id─┬─sku_id──┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" │ sku_003 │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" │ sku_003 │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n└─────┴─────────┴───────────────────┘\n┌──id─┬─sku_id─┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" │        │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" │        │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │        │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000.00")]),s._v(" │\n└─────┴────────┴───────────────────┘\n┌─id─┬─sku_id──┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │ sku_003 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1200.00")]),s._v(" │\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000.00")]),s._v(" │\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000.00")]),s._v(" │\n└────┴─────────┴───────────────────┘\n┌─id─┬─sku_id─┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │        │          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16200.00")]),s._v(" │\n└────┴────────┴───────────────────┘\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Elapsed: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.014")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br")])]),t("h4",{attrs:{id:"with-total-额外计算合计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#with-total-额外计算合计"}},[s._v("#")]),s._v(" with total：额外计算合计")]),s._v(" "),t("p",[s._v("除了 group by 字段外，额外统计一下总额")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sku_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_order_mt "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" \nid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sku_id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" totals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("统计结果")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("┌──id─┬─sku_id──┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" │ sku_003 │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │ sku_002 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" │ sku_004 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" │ sku_003 │            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600.00")]),s._v(" │\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" │ sku_001 │           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000.00")]),s._v(" │\n└─────┴─────────┴───────────────────┘\n\nTotals:\n┌─id─┬─sku_id─┬─"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("total_amount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("─┐\n│  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" │        │          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16200.00")]),s._v(" │\n└────┴────────┴───────────────────┘\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"sample-采样"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sample-采样"}},[s._v("#")]),s._v(" SAMPLE 采样")]),s._v(" "),t("p",[s._v("SAMPLE子句能够实现数据采样的功能，使查询仅返回采样数据而不是全部数据，从而有效减少查询负载。SAMPLE子句的采样机制是一种幂等设计，也就是说在数据不发生变化的情况下，使用相同的采样规则总是能够返回相同的数据，所以这项特性非常适合在那些可以接受近似查询结果的场合使用。例如在数据量十分巨大的情况下，对查询时效性的要求大于准确性时就可以尝试使用SAMPLE子句。")]),s._v(" "),t("p",[s._v("SAMPLE子句"),t("strong",[s._v("只能用于MergeTree系列引擎")]),s._v("的数据表，并且要求在CREATE TABLE时声明SAMPLE BY抽样表达式，例如下面的语句：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" hits_v1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" CounterID UInt64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" EventDate "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" UserID UInt64 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MergeTree"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PARTITION")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" toYYYYMM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("EventDate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CounterID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" intHash32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("UserID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \nSAMPLE "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" intHash32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("UserID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--Sample Key声明的表达式必须也包含在主键的声明中")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("SAMPLE BY表示"),t("code",[s._v("hits_v1")]),s._v("内的数据，可以按照"),t("code",[s._v("intHash32(UserID)")]),s._v("分布后的结果采样查询。")]),s._v(" "),t("p",[s._v("在声明Sample Key的时候有两点需要注意：")]),s._v(" "),t("ul",[t("li",[s._v("SAMPLE BY所声明的表达式必须同时包含在主键的声明内；")]),s._v(" "),t("li",[s._v("Sample Key必须是Int类型，如若不是，ClickHouse在进行CREATE\nTABLE操作时也不会报错，但在数据查询时会得到如下类似异常：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Invalid sampling column type in storage parameters: Float32. Must be unsigned integer type. \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"sample子句目前支持如下3种用法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sample子句目前支持如下3种用法"}},[s._v("#")]),s._v(" "),t("strong",[s._v("SAMPLE子句目前支持如下3种用法")])]),s._v(" "),t("h5",{attrs:{id:"sample-factor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sample-factor"}},[s._v("#")]),s._v(" SAMPLE factor")]),s._v(" "),t("p",[s._v("SAMPLE factor表示按因子系数采样，其中factor表示采样因子，它的取值支持0～1之间的小数。如果factor设置为0或者1，则效果等同于不进行数据采样。如下面的语句表示按10%的因子采样数据：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" CounterID "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hits_v1 SAMPLE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("factor也支持使用十进制的形式表述：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" CounterID "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hits_v1 SAMPLE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在进行统计查询时，为了得到最终的近似结果，需要将得到的直接结果乘以采样系数。例如若想按0.1的因子采样数据，则需要将统计结果放大10倍：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hits_v1 SAMPLE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"sample-rows"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sample-rows"}},[s._v("#")]),s._v(" SAMPLE rows")]),s._v(" "),t("p",[s._v("SAMPLE rows表示按样本数量采样，其中rows表示至少采样多少行数据，它的取值必须是大于1的整数。如果rows的取值大于表内数据的总行数，则效果等于rows=1（即不使用采样）。")]),s._v(" "),t("p",[s._v("下面的语句表示采样10000行数据：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hits_v1 SAMPLE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("最终查询返回了9576行数据，从返回的结果中可以得知，数据采样的范围是一个近似范围，这是由于采样数据的最小粒度是由index_granularity索引粒度决定的。由此可知，设置一个小于索引粒度\n或者较小的rows值没有什么意义，应该设置一个较大的值。")]),s._v(" "),t("p",[s._v("可以使用虚拟字段_sample_factor来获取当前查询所对应的采样系数：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" CounterID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("_sample_factor "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hits_v1 SAMPLE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"sample-factor-offset-n"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sample-factor-offset-n"}},[s._v("#")]),s._v(" SAMPLE factor OFFSET n")]),s._v(" "),t("p",[s._v("SAMPLE factor OFFSET n表示按因子系数和偏移量采样，其中factor表示采样因子，n表示偏移多少数据后才开始采样，它们两个的取值都是0～1之间的小数。例如下面的语句表示偏移量为0.5并按0.4的系数采样：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" CounterID "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hits_v1 SAMPLE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OFFSET")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.5")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果在计算OFFSET偏移量后，按照SAMPLE比例采样出现了溢出，则数据会被自动截断。")]),s._v(" "),t("h2",{attrs:{id:"alter操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#alter操作"}},[s._v("#")]),s._v(" alter操作")]),s._v(" "),t("h3",{attrs:{id:"新增字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新增字段"}},[s._v("#")]),s._v(" 新增字段")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" tableName "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" newcolname String "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("after")]),s._v(" col1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"修改字段类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改字段类型"}},[s._v("#")]),s._v(" 修改字段类型")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" tableName "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("modify")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" newcolname String"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"删除字段"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除字段"}},[s._v("#")]),s._v(" 删除字段")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" tableName "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" newcolname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"导出数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导出数据"}},[s._v("#")]),s._v(" 导出数据")]),s._v(" "),t("h3",{attrs:{id:"导出csv"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导出csv"}},[s._v("#")]),s._v(" 导出CSV")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("clickhouse"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--query \"select * from t_order_mt where create_time='2020-06-01 12:00:00'\" --format CSVWithNames> /opt/module/data/rs1.csv")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"更多格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更多格式"}},[s._v("#")]),s._v(" 更多格式")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://clickhouse.com/docs/en/interfaces/formats/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://clickhouse.com/docs/en/interfaces/formats/"),t("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);