(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{538:function(s,t,a){"use strict";a.r(t);var n=a(8),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("[toc]")]),s._v(" "),t("h2",{attrs:{id:"版本信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#版本信息"}},[s._v("#")]),s._v(" 版本信息")]),s._v(" "),t("p",[s._v("ElasticSearch：7.14.2")]),s._v(" "),t("p",[s._v("elasticsearch_exporter：1.7.0（latest）")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("下载地址："),t("a",{attrs:{href:"https://github.com/prometheus-community/elasticsearch_exporter/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/prometheus-community/elasticsearch_exporter/releases"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[s._v("下载版本：1.7.0")])])]),s._v(" "),t("p",[s._v("Grafana：10.0.10")]),s._v(" "),t("h2",{attrs:{id:"构建docker-compose-yml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建docker-compose-yml"}},[s._v("#")]),s._v(" 构建"),t("code",[s._v("docker-compose.yml")])]),s._v(" "),t("p",[s._v("创建并进入目录")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("mkdir /opt/docker-es-monitor\ncd /opt/docker-es-monitor\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("创建配置文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("vim /opt/docker-es-monitor/docker-compose.yml\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("注意：配置文件中不能使用tab，需要是用空格")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("prometheus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" prom/prometheus\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" prometheus\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("limits")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cpus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0.8'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cpus: '0.8'表示该服务的CPU使用限制为主机CPU的80%。这意味着，无论主机的CPU有多强大，该服务只能使用其80%的计算能力。")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 12G "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# memory: 12G表示该服务的内存使用限制为12GB。这意味着，该服务使用的内存不会超过12GB。")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("privileged")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# privileged: true是一个选项，它允许容器访问主机系统的所有设备，并允许容器中的进程获取几乎与主机系统相同的权限。在某些情况下，你可能需要容器具有更高的权限来执行特定的任务，例如直接操作网络设备或硬件，或者访问主机系统的特定文件。在这些情况下，你可以在Docker Compose文件中为特定的服务设置privileged: true。")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ports字段用于定义容器的端口映射。格式为- <主机端口>:<容器端口>")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 9090"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# volumes字段用于定义容器的卷映射。格式为- <主机路径>:<容器路径>")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /etc/prometheus/prometheus.yml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/prometheus/prometheus.yml\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# depends_on字段用于定义服务的启动顺序，grafana服务会在当前服务之前启动")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" grafana\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" TZ=Asia/Shanghai "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置服务的时区")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("grafana")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" grafana/grafana\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hostname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" grafana\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" grafana\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 3000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" TZ=Asia/Shanghai\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("elasticsearch_exporter1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" quay.io/prometheuscommunity/elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("exporter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.uri=http://172.16.24.199:9200'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ElasticSearch集群地址")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.all'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过es.uri获取全部节点状态，如果不设置，仅仅获取了配置的那个节点信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.indices'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群中所有索引的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.indices_settings'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群中所有索引的设置统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.indices_mappings'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群所有索引映射的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.shards'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群中所有索引的统计信息，包括分片级别的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.snapshots'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群快照的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.timeout=20s'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.24.224:9114:9114"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# elasticsearch_exporter 对外提供的端口，通过该端口可以获取到监控信息，ip为部署docker的机器IP")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("elasticsearch_exporter2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" quay.io/prometheuscommunity/elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("exporter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.uri=http://elastic:Avris2222@172.16.24.191:9200'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ElasticSearch集群地址")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.all'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过es.uri获取全部节点状态，如果不设置，仅仅获取了配置的那个节点信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.indices'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群中所有索引的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.indices_settings'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群中所有索引的设置统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.indices_mappings'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群所有索引映射的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.shards'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询集群中所有索引的统计信息，包括分片级别的统计信息")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--es.timeout=20s'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.24.224:9115:9114"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# elasticsearch_exporter 对外提供的端口，通过该端口可以获取到监控信息，ip为部署docker的机器IP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br")])]),t("h3",{attrs:{id:"参数说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[s._v("#")]),s._v(" 参数说明")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[t("code",[s._v("scrape_interval")])]),s._v(": 指定 Prometheus 抓取数据的时间间隔，默认为 15 秒。这意味着 Prometheus 每隔 15 秒抓取一次数据。")])]),s._v(" "),t("li",[t("p",[t("strong",[t("code",[s._v("evaluation_interval")])]),s._v(": 指定规则评估的时间间隔，默认为 15 秒。这影响了 Prometheus 对规则的评估频率。")])]),s._v(" "),t("li",[t("p",[t("strong",[t("code",[s._v("alertmanagers")])]),s._v(": 告警管理器配置，这里定义了一个静态的告警管理器的目标地址为 "),t("code",[s._v("10.0.0.101:9093")]),s._v("。这是 Alertmanager 的地址，Prometheus 会将告警发送到这里。")])]),s._v(" "),t("li",[t("p",[t("strong",[t("code",[s._v("rule_files")])]),s._v(': 规则文件的配置，这里指定了一个名为 "node_down.yml" 的规则文件。这个文件用于定义 Prometheus 告警的规则。')])]),s._v(" "),t("li",[t("p",[t("strong",[t("code",[s._v("scrape_configs")])]),s._v(": 抓取配置的主要部分。Prometheus 通过这里的配置定期从目标服务抓取指标数据。")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Job 'prometheus'")]),s._v(": 针对 Prometheus 本身的抓取配置，指定了抓取的目标为 "),t("code",[s._v("10.0.0.101:9090")]),s._v("。这个是用于监控 Prometheus 本身的指标。")]),s._v(" "),t("li",[t("strong",[s._v("Job 'node'")]),s._v(": 针对节点的抓取配置，设置了较短的抓取间隔（8 秒）并指定了两个目标节点 "),t("code",[s._v("10.0.0.101:9100")]),s._v(" 和 "),t("code",[s._v("10.0.0.102:9100")]),s._v("。这用于监控节点的指标。")]),s._v(" "),t("li",[t("strong",[s._v("Job 'cadvisor'")]),s._v(": 针对 cAdvisor 的抓取配置，同样设置了较短的抓取间隔并指定了两个 cAdvisor 实例的目标地址。")])])])]),s._v(" "),t("h3",{attrs:{id:"elasticsearch-exporter参数说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-exporter参数说明"}},[s._v("#")]),s._v(" elasticsearch_exporter参数说明")]),s._v(" "),t("p",[s._v("https://www.cnblogs.com/qianyuliang/p/15410892.html")]),s._v(" "),t("h2",{attrs:{id:"创建prometheus配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建prometheus配置文件"}},[s._v("#")]),s._v(" 创建Prometheus配置文件")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("vim /etc/prometheus/prometheus.yml\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("这个位置对应"),t("code",[s._v("docker-compse.yml")]),s._v("Prometheus配置文件挂载的目录")])]),s._v(" "),t("p",[s._v("修改内容")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("global")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("scrape_interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("     5s\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("evaluation_interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5s\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("scrape_configs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n \n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("job_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'prometheus'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# prometheus默认的")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("static_configs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'172.16.24.224:9090'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("job_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'elasticsearch'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监控ElasticSearch的job名称，自定义即可")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("scrape_interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 60s \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("scrape_timeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  30s\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metrics_path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/metrics"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监控后缀")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("static_configs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'172.16.24.224:9114'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刚刚配置的elasticsearch_exporter监控地址")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker-compose -f docker-compose.yml up -d\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[s._v("#")]),s._v(" 验证")]),s._v(" "),t("p",[s._v("访问Prometheus UI ：http://172.16.24.224:9090 可以看到是否监控成功")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/WrTfVC7G9iswLep.png",alt:"image-20240104170603539"}})]),s._v(" "),t("p",[s._v("可以看到状态为UP，说明Prometheus监控到了ElasticSearch信息")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/52wMQUjPSLEz6kx.png",alt:"image-20240104170618403"}})]),s._v(" "),t("h2",{attrs:{id:"配置grafana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置grafana"}},[s._v("#")]),s._v(" 配置Grafana")]),s._v(" "),t("p",[s._v("访问地址：http://172.16.24.224:3000 可以进入Grafana页面，默认账号密码：admin/admin")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/R7avZ23rwesQMNL.png",alt:"image-20240104170820176"}})]),s._v(" "),t("p",[s._v("首次登录需要修改密码")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/nRzimBUbyLlHNaO.png",alt:"image-20240104170843857"}})]),s._v(" "),t("p",[s._v("创建数据源")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/e8VxORtYXquZ5np.png",alt:"image-20240104171517944"}})]),s._v(" "),t("p",[s._v("选择Prometheus")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/VSowPTjgsAcWnxi.png",alt:"image-20240104171539813"}})]),s._v(" "),t("p",[s._v("输入地址")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/z4Ifd9MZQAoNVtb.png",alt:"image-20240104171612299"}})]),s._v(" "),t("p",[s._v("点击保存")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/mWLZc1l5d3CoV4h.png",alt:"image-20240104171627551"}})]),s._v(" "),t("p",[s._v("会提示成功")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/7YjPSCpAHsFcywk.png",alt:"image-20240104171636486"}})]),s._v(" "),t("h3",{attrs:{id:"导入监控模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入监控模板"}},[s._v("#")]),s._v(" 导入监控模板")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/8tgorFDCQ7UJV2I.png",alt:"image-20240104171702306"}})]),s._v(" "),t("h4",{attrs:{id:"模板说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#模板说明"}},[s._v("#")]),s._v(" 模板说明")]),s._v(" "),t("p",[s._v("官方模板：编号为2322")]),s._v(" "),t("p",[s._v("推荐模板：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("13071: Dashboard for Elasticsearch Cluster Stats\n13072: Dashboard for Elasticsearch Index Stats\n13073: Dashboard for Elasticsearch Node Stats\n13074: Dashboard for Elasticsearch History Stats\n")])])]),t("p",[s._v("这里我们使用推荐的模板，比较全")]),s._v(" "),t("p",[s._v("输入模板编号，并点击load")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/3GzRaPX6UuiLyFl.png",alt:"image-20240104171801175"}})]),s._v(" "),t("p",[s._v("选择数据源，并点击Import")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/3vgdDnWoVrw1imu.png",alt:"image-20240104171857739"}})]),s._v(" "),t("p",[s._v("导入完成后可以看到监控信息")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://s2.loli.net/2024/01/13/Od6nwYPyAbRz52Z.png",alt:"image-20240104171930864"}})]),s._v(" "),t("p",[s._v("其他三个模板安装上面方式导入即可。")]),s._v(" "),t("h2",{attrs:{id:"中文显示监控模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#中文显示监控模板"}},[s._v("#")]),s._v(" 中文显示监控模板")]),s._v(" "),t("h3",{attrs:{id:"集群监控中文版"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群监控中文版"}},[s._v("#")]),s._v(" 集群监控中文版")]),s._v(" "),t("p",[s._v("下载地址："),t("a",{attrs:{href:"https://download.csdn.net/download/zhangshenghang/88719538",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.csdn.net/download/zhangshenghang/88719538"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),t("p",[s._v("参考：https://download.csdn.net/blog/column/12357358/131353971")]),s._v(" "),t("p",[s._v("官网说明：https://github.com/prometheus-community/elasticsearch_exporter")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/u011487470/article/details/124302479")])])}),[],!1,null,null,null);t.default=e.exports}}]);