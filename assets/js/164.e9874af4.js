(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{530:function(s,a,t){"use strict";t.r(a);var e=t(8),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("[toc]")]),s._v(" "),a("p",[s._v("集群设置密码后通过下面这两个方法都可以进行密码修改")]),s._v(" "),a("h2",{attrs:{id:"方法一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法一"}},[s._v("#")]),s._v(" 方法一")]),s._v(" "),a("p",[s._v("通过发送HTTP请求进行密码修改")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XPOST")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" elastic "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bigdata-01:9200/_security/user/elastic/_password"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"password" : "123456789"}\'')]),s._v("\nEnter "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'elastic'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入我们原密码")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("password:123456789 指定的是我们修改后的密码")]),s._v(" "),a("h2",{attrs:{id:"方法二"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法二"}},[s._v("#")]),s._v(" 方法二")]),s._v(" "),a("p",[s._v("当我们想通过"),a("code",[s._v("bin/elasticsearch-setup-passwords interactive")]),s._v("修改密码时，发现提示密码已经设置过了,没有办法再次设置。")]),s._v(" "),a("blockquote",[a("p",[s._v("tip:")]),s._v(" "),a("p",[s._v("echo -e 'y\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n'")]),s._v(" "),a("p",[s._v("这段命令是直接将987654当成密码设置，实现一行命令交互设置密码。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# echo -e 'y\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n' | bin/elasticsearch-setup-passwords interactive\nwarning: usage of JAVA_HOME is deprecated, use ES_JAVA_HOME\nFuture versions of Elasticsearch will require Java 11; your Java version from [/usr/local/src/jdk1.8.0_151/jre] does not meet this requirement. Consider switching to a distribution of Elasticsearch with a bundled JDK. If you are already using a distribution with a bundled JDK, ensure the JAVA_HOME environment variable is not set.\n\nFailed to authenticate user 'elastic' against http://172.31.0.8:9200/_security/_authenticate?pretty\nPossible causes include:\n * The password for the 'elastic' user has already been changed on this cluster\n * Your elasticsearch node is running against a different keystore\n   This tool used the keystore at /usr/hdp/3.1.5.0-152/elasticsearch/config/elasticsearch.keystore\n\nERROR: Failed to verify bootstrap password\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("删除"),a("code",[s._v(".security-7")]),s._v("索引之后，就可以继续使用上面命令进行密码设置了。")]),s._v(" "),a("p",[s._v("删除索引")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-X")]),s._v(" DELETE "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://bigdata-01:9200/.security-7"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" elastic:123456\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("重新设置密码，设置成功。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'y\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n987654\\n'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" bin/elasticsearch-setup-passwords interactive\nwarning: usage of JAVA_HOME is deprecated, use ES_JAVA_HOME\nFuture versions of Elasticsearch will require Java "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" your Java version from "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/usr/local/src/jdk1.8.0_151/jre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" does not meet this requirement. Consider switching to a distribution of Elasticsearch with a bundled JDK. If you are already using a distribution with a bundled JDK, ensure the JAVA_HOME environment variable is not set.\nInitiating the setup of passwords "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" reserved "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" elastic,apm_system,kibana,kibana_system,logstash_system,beats_system,remote_monitoring_user.\nYou will be prompted to enter passwords as the process progresses.\n\n\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("apm_system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kibana_system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kibana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("logstash_system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("beats_system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("remote_monitoring_user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nChanged password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("elastic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);