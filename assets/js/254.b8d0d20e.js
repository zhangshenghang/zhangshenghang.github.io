(window.webpackJsonp=window.webpackJsonp||[]).push([[254],{621:function(s,t,a){"use strict";a.r(t);var e=a(8),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("[toc]")]),s._v(" "),t("h2",{attrs:{id:"官方说明文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官方说明文档"}},[s._v("#")]),s._v(" 官方说明文档")]),s._v(" "),t("p",[s._v("https://iotdb.apache.org/zh/UserGuide/V1.2.x/Deployment-and-Maintenance/Deployment-Recommendation.html#%E9%83%A8%E7%BD%B2%E6%A8%A1%E5%BC%8F%E9%80%89%E5%9E%8B")]),s._v(" "),t("h2",{attrs:{id:"下载地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载地址"}},[s._v("#")]),s._v(" 下载地址")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://iotdb.apache.org/Download/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://iotdb.apache.org/Download/"),t("OutboundLink")],1)]),s._v(" "),t("blockquote",[t("p",[s._v("这里下载的1.2.2版本")]),s._v(" "),t("p",[s._v("链接: https://pan.baidu.com/s/1B1c2DTd1k8MA84V4CxdAjw?pwd=k5c8 提取码: k5c8")])]),s._v(" "),t("p",[s._v("安装包目录结构")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("/data/iotdb/\n├── conf    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置文件")]),s._v("\n├── lib     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jar library")]),s._v("\n├── sbin    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动/停止等脚本")]),s._v("\n└── tools   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他工具")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"服务安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务安装"}},[s._v("#")]),s._v(" 服务安装")]),s._v(" "),t("h3",{attrs:{id:"节点服务分配"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#节点服务分配"}},[s._v("#")]),s._v(" 节点服务分配")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("节点IP")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.10")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.11")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.12")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("服务")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("ConfigNode")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("ConfigNode")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("ConfigNode")])]),s._v(" "),t("tr",[t("td",[s._v("服务")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("DataNode")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("DataNode")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("DataNode")])])])]),s._v(" "),t("p",[s._v("端口占用：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("服务")]),s._v(" "),t("th",[s._v("ConfigNode")]),s._v(" "),t("th",[s._v("DataNode")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("端口")]),s._v(" "),t("td",[s._v("10710, 10720")]),s._v(" "),t("td",[s._v("6667, 10730, 10740, 10750, 10760")])])])]),s._v(" "),t("h3",{attrs:{id:"修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[s._v("#")]),s._v(" 修改配置文件")]),s._v(" "),t("p",[s._v("配置文件在 "),t("code",[s._v("/data/iotdb/conf")]),s._v("目录下。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("配置文件")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("配置项")]),s._v(" "),t("th",[s._v("IP:192.168.132.10")]),s._v(" "),t("th",[s._v("IP:192.168.132.11")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("IP:192.168.132.12")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("iotdb-confignode.properties")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("cn_internal_address")]),s._v(" "),t("td",[s._v("192.168.132.10")]),s._v(" "),t("td",[s._v("192.168.132.11")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.12")])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("cn_target_config_node_list")]),s._v(" "),t("td",[s._v("192.168.132.10:10710")]),s._v(" "),t("td",[s._v("192.168.132.10:10710")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.10:10710")])]),s._v(" "),t("tr",[t("td",[s._v("iotdb-datanode.properties")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("dn_rpc_address")]),s._v(" "),t("td",[s._v("192.168.132.10")]),s._v(" "),t("td",[s._v("192.168.132.11")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.12")])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("dn_internal_address")]),s._v(" "),t("td",[s._v("192.168.132.10")]),s._v(" "),t("td",[s._v("192.168.132.11")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.12")])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("dn_target_config_node_list")]),s._v(" "),t("td",[s._v("192.168.132.10:10710")]),s._v(" "),t("td",[s._v("192.168.132.10:10710")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.10:10710")])])])]),s._v(" "),t("h3",{attrs:{id:"修改堆内存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改堆内存"}},[s._v("#")]),s._v(" 修改堆内存")]),s._v(" "),t("p",[t("code",[s._v("confignode-env.sh")]),s._v(" 设置 "),t("code",[s._v('MAX_HEAP_SIZE="2G"')])]),s._v(" "),t("p",[t("code",[s._v("datanode-env.sh")]),s._v("设置"),t("code",[s._v('MAX_HEAP_SIZE="16G"')])]),s._v(" "),t("ul",[t("li",[s._v("JVM堆内存配置: "),t("code",[s._v("confignode-env.sh")]),s._v(" 和 "),t("code",[s._v("datanode-env.sh")]),s._v(" 内配置"),t("code",[s._v("MAX_HEAP_SIZE")]),s._v(", 建议设置值大于等于1G。ConfigNode 1~2G就足够了，DataNode的内存配置则要取决于数据接入的数据量和查询数据量。")])]),s._v(" "),t("h3",{attrs:{id:"启动集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动集群"}},[s._v("#")]),s._v(" 启动集群")]),s._v(" "),t("h4",{attrs:{id:"启动第一个节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动第一个节点"}},[s._v("#")]),s._v(" 启动第一个节点")]),s._v(" "),t("p",[s._v("即上面表格中"),t("code",[s._v("cn_target_config_node_list")]),s._v("配置的节点。\n登录该节点 192.168.132.10，执行下面命令：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data/iotdb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 ConfigNode 和 DataNode 服务")]),s._v("\nsbin/start-standalone.sh\n    \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 DataNode 日志以确定启动成功")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" logs/log_datanode_all.log\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 期望看见类似下方的日志")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2023-07-21 20:26:01,881 [main] INFO  o.a.i.db.service.DataNode:192 - Congratulation, IoTDB DataNode is set up successfully. Now, enjoy yourself!")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("如果没有看到上面所说的日志或者看到了 Exception，那么代表启动失败了。请查看 "),t("code",[s._v("/data/iotdb/logs")]),s._v(" 目录内的"),t("code",[s._v("log_confignode_all.log")]),s._v(" 和 "),t("code",[s._v("log_datanode_all.log")]),s._v(" 日志文件。")]),s._v(" "),t("p",[t("strong",[s._v("注意")]),s._v("：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("要保证第一个节点启动成功后，再启动其他节点。确切的说，要先保证第一个 ConfigNode 服务启动成功，即"),t("code",[s._v("cn_target_config_node_list")]),s._v("配置的节点。")])]),s._v(" "),t("li",[t("p",[s._v("如果启动失败，需要清理环境（参考清理环境章节）后，再次启动。")])]),s._v(" "),t("li",[t("p",[s._v("ConfigNode 和 DataNode 服务都可以单独启动:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 单独启动 ConfigNode， 后台启动")]),s._v("\nsbin/start-confignode.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 单独启动 DataNode，后台启动")]),s._v("\nsbin/start-datanode.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"启动其他两个节点的-confignode-和-datanode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动其他两个节点的-confignode-和-datanode"}},[s._v("#")]),s._v(" 启动其他两个节点的 ConfigNode 和 DataNode")]),s._v(" "),t("p",[s._v("在节点 192.168.132.11 和 192.168.132.12 两个节点上分别执行：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data/iotdb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 ConfigNode 和 DataNode 服务")]),s._v("\nsbin/start-standalone.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("如果启动失败，需要在所有节点执行清理环境后，然后从启动第一个节点开始，再重新执行一次。")]),s._v(" "),t("h4",{attrs:{id:"检验集群状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#检验集群状态"}},[s._v("#")]),s._v(" 检验集群状态")]),s._v(" "),t("p",[s._v("在任意节点上，在 Cli 执行 "),t("code",[s._v("show cluster")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("iotdb"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".10")]),s._v("\nIoTDB"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例结果如下：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("------+----------+-------+---------------+------------+-------+---------+")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("NodeID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  NodeType"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Status")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("InternalAddress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("InternalPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("BuildInfo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("------+----------+-------+---------------+------------+-------+---------+")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".11")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".11")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".12")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".12")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("------+----------+-------+---------------+------------+--------------+---------+")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[t("strong",[s._v("说明：")]),s._v(" "),t("code",[s._v("start-cli.sh -h")]),s._v(" 后指定的IP地址，可以是任意一个 DataNode 的IP地址。")]),s._v(" "),t("h4",{attrs:{id:"修改集群密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改集群密码"}},[s._v("#")]),s._v(" 修改集群密码")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v(" bash sbin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cli"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".24")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".224")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6667")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("pw root\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" root "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" PASSWORD "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123123'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"【附录】清理环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【附录】清理环境"}},[s._v("#")]),s._v(" 【附录】清理环境")]),s._v(" "),t("p",[s._v("在所有节点执行：")]),s._v(" "),t("ol",[t("li",[s._v("结束 ConfigNode 和 DataNode 进程。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 停止 ConfigNode 和 DataNode 服务")]),s._v("\nsbin/stop-standalone.sh\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 检查是否还有进程残留")]),s._v("\njps\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("gerp iotdb\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 如果有进程残留，则手动kill")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果确定机器上仅有1个iotdb，可以使用下面命令清理残留进程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" iotdb"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  '")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' '")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cut")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' '")]),s._v(" -f2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-9")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("删除 data 和 logs 目录。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data/iotdb\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" data logs\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("说明：删除 data 目录是必要的，删除 logs 目录是为了纯净日志，非必需。")]),s._v(" "),t("h2",{attrs:{id:"集群扩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群扩容"}},[s._v("#")]),s._v(" 集群扩容")]),s._v(" "),t("p",[s._v("扩容方式与上方启动其他节点相同。也就是，在要添加的节点上，下载IoTDB的安装包，解压，修改配置，然后启动。这里要添加节点的IP为 "),t("code",[s._v("192.168.132.13")]),s._v(" "),t("strong",[s._v("注意：")])]),s._v(" "),t("ul",[t("li",[s._v("扩容的节点必须是干净的节点，不能有数据(也就是"),t("code",[s._v("data")]),s._v("目录)")]),s._v(" "),t("li",[s._v("iotdb-common.properties中的"),t("code",[s._v("cluster_name")]),s._v("的配置必须和已有集群一致。")]),s._v(" "),t("li",[t("code",[s._v("cn_target_config_node_list")]),s._v(" 和 "),t("code",[s._v("dn_target_config_node_list")]),s._v("的配置必须和已有集群一致。")]),s._v(" "),t("li",[s._v("原有数据不会移动到新节点，新创建的元数据分区和数据分区很可能在新的节点。")])]),s._v(" "),t("h3",{attrs:{id:"修改配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改配置"}},[s._v("#")]),s._v(" 修改配置")]),s._v(" "),t("p",[s._v("按照下表修改相应的配置文件：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("配置")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("配置项")]),s._v(" "),t("th",{staticStyle:{"text-align":"left"}},[s._v("IP:192.168.132.13")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("iotdb-confignode.properties")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("cn_internal_address")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.13")])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("cn_target_config_node_list")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.10:10710")])]),s._v(" "),t("tr",[t("td",[s._v("iotdb-datanode.properties")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("dn_rpc_address")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.13")])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("dn_internal_address")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.13")])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("dn_target_config_node_list")]),s._v(" "),t("td",{staticStyle:{"text-align":"left"}},[s._v("192.168.132.10:10710")])])])]),s._v(" "),t("h3",{attrs:{id:"扩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#扩容"}},[s._v("#")]),s._v(" 扩容")]),s._v(" "),t("p",[s._v("在新增节点"),t("code",[s._v("192.168.132.13")]),s._v("上，执行：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data/iotdb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 ConfigNode 和 DataNode 服务")]),s._v("\nsbin/start-standalone.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"验证扩容结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证扩容结果"}},[s._v("#")]),s._v(" 验证扩容结果")]),s._v(" "),t("p",[s._v("在 Cli 执行 "),t("code",[s._v("show cluster")]),s._v("，结果如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("/data/iotdb/sbin/start-cli.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.10\nIoTDB"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("show cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例结果如下：")]),s._v("\n+------+----------+-------+---------------+------------+-------+---------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("NodeID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  NodeType"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("InternalAddress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("InternalPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("BuildInfo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------+----------+-------+---------------+------------+-------+---------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.10"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.10"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.11"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.11"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.12"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.12"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.13"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.13"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------+----------+-------+---------------+------------+-------+---------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"集群缩容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群缩容"}},[s._v("#")]),s._v(" 集群缩容")]),s._v(" "),t("p",[t("strong",[s._v("注意:")])]),s._v(" "),t("ul",[t("li",[s._v("可以在任何一个集群内的节点上，执行缩容操作。")]),s._v(" "),t("li",[s._v("集群内的任意节点都可以被缩容。但是存留的 DataNode 服务不能小于副本数设置。")]),s._v(" "),t("li",[s._v("请耐心等待缩容脚本执行结束，并仔细阅读日志说明，尤其是结束前的指南说明。")])]),s._v(" "),t("h3",{attrs:{id:"缩容一个-confignode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缩容一个-confignode"}},[s._v("#")]),s._v(" 缩容一个 ConfigNode")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data/iotdb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式一：使用 ip:port 移除")]),s._v("\nsbin/remove-confignode.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.13:10710\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式二：使用节点编号移除, `show cluster`中的 NodeID ")]),s._v("\nsbin/remove-confignode.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"缩容一个-datanode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缩容一个-datanode"}},[s._v("#")]),s._v(" 缩容一个 DataNode")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data/iotdb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式一：使用 ip:port 移除")]),s._v("\nsbin/remove-datanode.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.13:6667\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式二：使用节点编号移除, `show cluster`中的 NodeID")]),s._v("\nsbin/remove-confignode.sh "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"验证缩容结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证缩容结果"}},[s._v("#")]),s._v(" 验证缩容结果")]),s._v(" "),t("p",[s._v("在 Cli 执行 "),t("code",[s._v("show cluster")]),s._v("，结果如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("+------+----------+-------+---------------+------------+-------+---------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("NodeID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  NodeType"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("InternalAddress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("InternalPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("BuildInfo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------+----------+-------+---------------+------------+-------+---------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.10"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.10"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.11"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.11"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ConfigNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.12"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10710")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  DataNode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Running"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".132.12"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10730")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".x.x  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  xxxxxxx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------+----------+-------+---------------+------------+-------+---------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);