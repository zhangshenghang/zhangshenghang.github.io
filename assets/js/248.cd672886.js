(window.webpackJsonp=window.webpackJsonp||[]).push([[248],{617:function(a,s,t){"use strict";t.r(s);var e=t(8),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("[toc]")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.hadoop.wiki/pages/d3710b",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-简介(1)"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://www.hadoop.wiki/pages/ded150/",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-存储结构(2)"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://www.hadoop.wiki/pages/9a96a6/",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-Hive集成Iceberg(3)"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://www.hadoop.wiki/pages/592494/",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-SparkSQL集成(4)"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://www.hadoop.wiki/pages/12fe6d/",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-FlinkSQL集成(5)"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://www.hadoop.wiki/pages/edf0ba/",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-FlinkSQL-kafka类型表数据无法成功写入(6)"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://www.hadoop.wiki/pages/571843/",target:"_blank",rel:"noopener noreferrer"}},[a._v("数据湖Iceberg-Flink DataFrame集成(7)"),s("OutboundLink")],1)]),a._v(" "),s("h1",{attrs:{id:"hive集成iceberg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hive集成iceberg"}},[a._v("#")]),a._v(" Hive集成Iceberg")]),a._v(" "),s("h2",{attrs:{id:"环境准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境准备"}},[a._v("#")]),a._v(" 环境准备")]),a._v(" "),s("h3",{attrs:{id:"hive与iceberg的版本对应关系如下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hive与iceberg的版本对应关系如下"}},[a._v("#")]),a._v(" Hive与Iceberg的版本对应关系如下")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("Hive版本")]),a._v(" "),s("th",[a._v("官方推荐Hive版本")]),a._v(" "),s("th",[a._v("Iceberg版本")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("2.x")]),a._v(" "),s("td",[a._v("2.3.8")]),a._v(" "),s("td",[a._v("0.8.0-incubating~1.1.0")])]),a._v(" "),s("tr",[s("td",[a._v("3.x")]),a._v(" "),s("td",[a._v("3.1.2")]),a._v(" "),s("td",[a._v("0.10.0~1.1.0")])])])]),a._v(" "),s("p",[a._v("Iceberg与Hive 2和Hive 3的集成，支持以下特性：")]),a._v(" "),s("ul",[s("li",[a._v("创建表")]),a._v(" "),s("li",[a._v("删除表")]),a._v(" "),s("li",[a._v("读取表")]),a._v(" "),s("li",[a._v("插入表（INSERT into）")])]),a._v(" "),s("p",[a._v("更多功能需要Hive 4.x（目前alpha版本）才能支持。")]),a._v(" "),s("h3",{attrs:{id:"上传jar包-拷贝到hive的auxlib目录中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传jar包-拷贝到hive的auxlib目录中"}},[a._v("#")]),a._v(" 上传jar包，拷贝到Hive的auxlib目录中")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" auxlib\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" iceberg-hive-runtime-1.1.0.jar /opt/module/hive/auxlib\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" libfb303-0.9.3.jar /opt/module/hive/auxlib\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"修改hive-site-xml-添加配置项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改hive-site-xml-添加配置项"}},[a._v("#")]),a._v(" 修改hive-site.xml，添加配置项")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("iceberg.engine.hive.enabled"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("true"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("hive.aux.jars.path"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("/opt/module/hive/auxlib"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("使用TEZ引擎注意事项：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("使用Hive版本>=3.1.2，需要TEZ版本>=0.10.1")])]),a._v(" "),s("li",[s("p",[a._v("指定tez更新配置：")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("tez.mrreader.config.update.properties"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("hive.io.file.readcolumn.names,hive.io.file.readcolumn.ids"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])])]),a._v(" "),s("li",[s("p",[a._v("从Iceberg 0.11.0开始，如果Hive使用Tez引擎，需要关闭向量化执行：")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("hive.vectorized.execution.enabled"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("false"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])])])]),a._v(" "),s("h3",{attrs:{id:"启动-hms-服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动-hms-服务"}},[a._v("#")]),a._v(" 启动 HMS 服务")]),a._v(" "),s("h3",{attrs:{id:"启动-hadoop"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动-hadoop"}},[a._v("#")]),a._v(" 启动 Hadoop")]),a._v(" "),s("h2",{attrs:{id:"创建和管理-catalog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建和管理-catalog"}},[a._v("#")]),a._v(" 创建和管理 Catalog")]),a._v(" "),s("p",[a._v("​\tIceberg支持多种不同的Catalog类型，例如:Hive、Hadoop、亚马逊的AWS Glue和自定义Catalog。")]),a._v(" "),s("p",[a._v("根据不同配置，分为三种情况：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("没有设置iceberg.catalog，默认使用HiveCatalog")])]),a._v(" "),s("li",[s("p",[a._v("设置了 iceberg.catalog的类型，使用指定的Catalog类型，如下表格")])])]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("配置项")]),a._v(" "),s("th",[a._v("说明")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("iceberg.catalog.<catalog_name>.type")]),a._v(" "),s("td",[a._v("Catalog的类型: hive, hadoop, 如果使用自定义Catalog，则不设置")])]),a._v(" "),s("tr",[s("td",[a._v("iceberg.catalog.<catalog_name>.catalog-impl")]),a._v(" "),s("td",[a._v("Catalog的实现类, 如果上面的type没有设置，则此参数必须设置")])]),a._v(" "),s("tr",[s("td",[a._v("iceberg.catalog.<catalog_name>."),s("key")],1),a._v(" "),s("td",[a._v("Catalog的其他配置项")])])])]),a._v(" "),s("ul",[s("li",[a._v("设置 iceberg.catalog=location_based_table，直接通过指定的根路径来加载Iceberg表")])]),a._v(" "),s("h3",{attrs:{id:"默认使用-hivecatalog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#默认使用-hivecatalog"}},[a._v("#")]),a._v(" 默认使用 HiveCatalog")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_test1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" iceberg_test1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("查看HDFS可以发现，表目录在默认的hive仓库路径下。")]),a._v(" "),s("h3",{attrs:{id:"指定-catalog-类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定-catalog-类型"}},[a._v("#")]),a._v(" 指定 Catalog 类型")]),a._v(" "),s("h4",{attrs:{id:"使用-hivecatalog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-hivecatalog"}},[a._v("#")]),a._v(" 使用 HiveCatalog")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" iceberg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("catalog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("iceberg_hive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" iceberg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("catalog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("iceberg_hive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("uri"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("thrift:"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//hadoop1:9083;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" iceberg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("catalog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("iceberg_hive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("clients"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" iceberg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("catalog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("iceberg_hive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("warehouse"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hdfs:"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//hadoop1:8020/warehouse/iceberg-hive;")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_test2 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),a._v("\nTBLPROPERTIES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'iceberg.catalog'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'iceberg_hive'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" iceberg_test2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h4",{attrs:{id:"使用-hadoopcatalog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-hadoopcatalog"}},[a._v("#")]),a._v(" 使用 HadoopCatalog")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" iceberg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("catalog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("iceberg_hadoop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hadoop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" iceberg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("catalog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("iceberg_hadoop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("warehouse"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hdfs:"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//hadoop1:8020/warehouse/iceberg-hadoop;")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_test3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),a._v(" \nLOCATION "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'hdfs://hadoop1:8020/warehouse/iceberg-hadoop/default/iceberg_test3'")]),a._v("\nTBLPROPERTIES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'iceberg.catalog'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'iceberg_hadoop'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" iceberg_test3 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("h4",{attrs:{id:"指定路径加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定路径加载"}},[a._v("#")]),a._v(" 指定路径加载")]),a._v(" "),s("p",[a._v("如果HDFS中已经存在iceberg格式表，我们可以通过在Hive中创建Icerberg格式表指定对应的location路径映射数据。")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" EXTERNAL "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_test4 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),a._v("\nLOCATION "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'hdfs://hadoop1:8020/warehouse/iceberg-hadoop/default/iceberg_test3'")]),a._v("\nTBLPROPERTIES "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'iceberg.catalog'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'location_based_table'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h2",{attrs:{id:"基本操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本操作"}},[a._v("#")]),a._v(" 基本操作")]),a._v(" "),s("h3",{attrs:{id:"创建表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建表"}},[a._v("#")]),a._v(" 创建表")]),a._v(" "),s("h4",{attrs:{id:"创建外部表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建外部表"}},[a._v("#")]),a._v(" 创建外部表")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" EXTERNAL "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_create1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("describe")]),a._v(" formatted iceberg_create1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h4",{attrs:{id:"创建内部表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建内部表"}},[a._v("#")]),a._v(" 创建内部表")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_create2 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("describe")]),a._v(" formatted iceberg_create2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h4",{attrs:{id:"创建分区表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建分区表"}},[a._v("#")]),a._v(" 创建分区表")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" EXTERNAL "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_create3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("name string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nPARTITIONED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("age "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nSTORED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("describe")]),a._v(" formatted iceberg_create3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("p",[a._v("Hive语法创建分区表，不会在HMS中创建分区，而是将分区数据转换为Iceberg标识分区。这种情况下不能使用Iceberg的分区转换，例如：days(timestamp)，如果想要使用Iceberg格式表的分区转换标识分区，需要使用Spark或者Flink引擎创建表")]),a._v(" "),s("h3",{attrs:{id:"修改表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改表"}},[a._v("#")]),a._v(" 修改表")]),a._v(" "),s("p",[a._v("只支持HiveCatalog表修改表属性，Iceberg表属性和Hive表属性存储在HMS中是同步的。")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_create1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" TBLPROPERTIES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'external.table.purge'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'FALSE'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"插入表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插入表"}},[a._v("#")]),a._v(" 插入表")]),a._v(" "),s("p",[a._v("支持标准单表INSERT INTO操作")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" iceberg_create2 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VALUES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" iceberg_create1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" iceberg_create2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("在HIVE 3.x中，INSERT OVERWRITE虽然能执行，但其实是追加。")]),a._v(" "),s("h3",{attrs:{id:"删除表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除表"}},[a._v("#")]),a._v(" 删除表")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" iceberg_create1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("hr"),a._v(" "),s("h1",{attrs:{id:"hive集成iceberg-ambari2-7-5-该版本无法集成iceberg-记录了集成失败过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hive集成iceberg-ambari2-7-5-该版本无法集成iceberg-记录了集成失败过程"}},[a._v("#")]),a._v(" Hive集成Iceberg-Ambari2.7.5（该版本无法集成Iceberg,记录了集成失败过程）")]),a._v(" "),s("h2",{attrs:{id:"版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本"}},[a._v("#")]),a._v(" 版本")]),a._v(" "),s("p",[a._v("Hive:3.1.0")]),a._v(" "),s("p",[a._v("Tez:0.9.1")]),a._v(" "),s("p",[a._v("Iceberg:1.1.0")]),a._v(" "),s("h3",{attrs:{id:"上传jar包-拷贝到hive-meatastore服务所在机器的-opt-hive-iceberglib目录中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传jar包-拷贝到hive-meatastore服务所在机器的-opt-hive-iceberglib目录中"}},[a._v("#")]),a._v(" 上传jar包，拷贝到Hive MeataStore服务所在机器的/opt/hive/iceberglib目录中")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[root@bigdata-24-199 iceberglib]# pwd\n/opt/hive/iceberglib\n[root@bigdata-24-199 iceberglib]# ls\niceberg-hive-runtime-1.1.0.jar  libfb303-0.9.3.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"修改hive-site-xml-添加配置项-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改hive-site-xml-添加配置项-2"}},[a._v("#")]),a._v(" 修改hive-site.xml，添加配置项")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/T4Eh8Vuv9yzieg7.png",alt:"image-20230412153436426"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/OeDSytFmEIrLMq8.png",alt:"image-20230412153506106"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/YzBKoma8eGj45CT.png",alt:"image-20230412153529286"}})]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("iceberg.engine.hive.enabled"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("true"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("hive.aux.jars.path"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("/opt/hive/iceberglib"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("在Ambari中配置hive(Ambari版本中必须配置这一步，不然后续创建表提示招不到类)")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/z5CmsPHKDOFLxUy.png",alt:"image-20230413095702994"}})]),a._v(" "),s("p",[a._v("修改hive-interactive-env template和hive-env template中搜索HIVE_AUX_JARS_PATH,被配置我们引用的包")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("HIVE_AUX_JARS_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/hdp/current/hive-server2/lib/hive-hcatalog-core.jar:/opt/hive/iceberglib/iceberg-hive-runtime-1.1.0.jar:/opt/hive/iceberglib/libfb303-0.9.3.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/ICoj4HvxtYhS63g.png",alt:"image-20230413095445732"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/GQDHdckagzpe7wK.png",alt:"image-20230413095511128"}})]),a._v(" "),s("p",[a._v("从Iceberg 0.11.0开始，如果Hive使用Tez引擎，需要关闭向量化执行：")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("hive.vectorized.execution.enabled"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("false"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("property")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("保存重启")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/Wm2pFHyYc71G6xE.png",alt:"image-20230412153633612"}})]),a._v(" "),s("h3",{attrs:{id:"可能遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#可能遇到的问题"}},[a._v("#")]),a._v(" 可能遇到的问题")]),a._v(" "),s("h4",{attrs:{id:"创建表提示-error-error-while-compiling-statement-failed-semanticexception-cannot-find-class-org-apache-iceberg-mr-hive-hiveicebergstoragehandler-state-42000-code-40000"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建表提示-error-error-while-compiling-statement-failed-semanticexception-cannot-find-class-org-apache-iceberg-mr-hive-hiveicebergstoragehandler-state-42000-code-40000"}},[a._v("#")]),a._v(" 创建表提示 Error: Error while compiling statement: FAILED: SemanticException Cannot find class 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler' (state=42000,code=40000)")]),a._v(" "),s("p",[a._v("通过"),s("code",[a._v("set hive.aux.jars.path;")]),a._v("命令查看是否配置成功")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(": jdbc:hive2:"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//bigdata-24-199:2181,bigdata-2> set hive.aux.jars.path;")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("----------------------------------------------------+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("                        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v("                         "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("----------------------------------------------------+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" hive"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("aux"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("jars"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("path"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("file")]),a._v(":"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("///usr/hdp/current/hive-webhcat/share/hcatalog/hive-hcatalog-core.jar |")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("----------------------------------------------------+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("row")]),a._v(" selected "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.836")]),a._v(" seconds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("p",[a._v("发现没有我们配置的jar包")]),a._v(" "),s("p",[a._v("说明我们之前配置没有生效，原因为：Ambari配置hive.aux.jars.path方式不同")]),a._v(" "),s("p",[a._v("配置方法：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("1.hive添加第三方jar包")])]),a._v(" "),s("li",[s("p",[a._v("2.上传jar包,添加到hive-server所在服务器")])]),a._v(" "),s("li",[s("p",[a._v("3.在Ambari>hive>config中\n的hive-interactive-env template和hive-env template中搜索HIVE_AUX_JARS_PATH,被配置我们引用的包")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("HIVE_AUX_JARS_PATH=/usr/hdp/current/hive-server2-hive2/lib/hive-hcatalog-core.jar:/usr/hdp/current/hive-server2-hive2/lib/hive-udf.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/ICoj4HvxtYhS63g.png",alt:"image-20230413095445732"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2023/04/24/GQDHdckagzpe7wK.png",alt:"image-20230413095511128"}})])]),a._v(" "),s("li",[s("p",[a._v("4.重启服务，解决问题")])])]),a._v(" "),s("h4",{attrs:{id:"不兼容-insert数据后查询不到-在hdfs中也看不到快照等文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不兼容-insert数据后查询不到-在hdfs中也看不到快照等文件"}},[a._v("#")]),a._v(" 不兼容-insert数据后查询不到，在HDFS中也看不到快照等文件")]),a._v(" "),s("p",[a._v("执行"),s("code",[a._v("INSERT INTO iceberg_test1 values(1);")]),a._v("添加数据后")]),a._v(" "),s("p",[a._v("执行查询看不到数据")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(": jdbc:hive2:"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//bigdata-24-199:2181,bigdata-2> select * from iceberg_test1;")]),a._v("\nINFO  : Compiling command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("queryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hive_20230413105058_0937e14c"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("613")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("43")]),a._v("ce"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ba17"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),a._v("a6601f044c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" iceberg_test1\nINFO  : Semantic Analysis Completed "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("retrial "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nINFO  : "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Returning")]),a._v(" Hive "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("schema")]),a._v(": "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Schema")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("fieldSchemas:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("FieldSchema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name:iceberg_test1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("type")]),a._v(":"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("comment")]),a._v(":"),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" properties:"),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nINFO  : Completed compiling command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("queryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hive_20230413105058_0937e14c"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("613")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("43")]),a._v("ce"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ba17"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),a._v("a6601f044c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Time")]),a._v(" taken: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7.631")]),a._v(" seconds\nINFO  : Executing command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("queryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hive_20230413105058_0937e14c"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("613")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("43")]),a._v("ce"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ba17"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),a._v("a6601f044c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" iceberg_test1\nINFO  : Completed executing command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("queryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hive_20230413105058_0937e14c"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("613")]),a._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("43")]),a._v("ce"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ba17"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),a._v("a6601f044c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("Time")]),a._v(" taken: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.027")]),a._v(" seconds\nINFO  : OK\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("------------------+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" iceberg_test1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("i  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("------------------+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("------------------+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("No")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("rows")]),a._v(" selected "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7.953")]),a._v(" seconds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br")])]),s("p",[a._v("查看HDFS存储该表的路径发现，数据文件在里面，metadata.json文件在里面，但是快照文件没有（文件接口可以查看文章：数据湖Iceberg-存储结构(2)）暂时无法解决")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hdfs@bigdata-24-199 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ hdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /warehouse/tablespace/managed/hive/iceberg_test1\nFound "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" items\ndrwx------+  - hive hadoop          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2023")]),a._v("-04-13 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(":37 /warehouse/tablespace/managed/hive/iceberg_test1/data\ndrwx------+  - hive hadoop          "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2023")]),a._v("-04-13 09:50 /warehouse/tablespace/managed/hive/iceberg_test1/metadata\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hdfs@bigdata-24-199 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ hdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /warehouse/tablespace/managed/hive/iceberg_test1/data\nFound "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" items\n-rw-rw----+  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" hive hadoop        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("404")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2023")]),a._v("-04-13 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(":36 /warehouse/tablespace/managed/hive/iceberg_test1/data/00000-0-hive_20230413103536_153504ef-df11-4744-adf8-6148912f484d-job_1681281011930_0005-00001.parquet\n-rw-rw----+  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" hive hadoop        "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("404")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2023")]),a._v("-04-13 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(":37 /warehouse/tablespace/managed/hive/iceberg_test1/data/00000-0-hive_20230413103726_6d188296-1ea0-453d-bc00-54f98cd97ee6-job_1681281011930_0005-00001.parquet\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hdfs@bigdata-24-199 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ hdfs dfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-ls")]),a._v(" /warehouse/tablespace/managed/hive/iceberg_test1/metadata\nFound "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" items\n-rw-rw----+  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" hive hadoop       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1359")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2023")]),a._v("-04-13 09:50 /warehouse/tablespace/managed/hive/iceberg_test1/metadata/00000-d21b6e4e-636a-45ec-a3a5-805a8b99ffc2.metadata.json\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);