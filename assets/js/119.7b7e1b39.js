(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{482:function(n,e,a){"use strict";a.r(e);var s=a(8),i=Object(s.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("p",[n._v("[toc]")]),n._v(" "),e("h2",{attrs:{id:"问题描述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[n._v("#")]),n._v(" 问题描述")]),n._v(" "),e("p",[n._v("在安装自定义服务时，Agent报错,提示"),e("code",[n._v("ValueError: unknown locale: UTF-8")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('Traceback (most recent call last):\n  File "/var/lib/ambari-agent/cache/stack-hooks/before-INSTALL/scripts/hook.py", line 37, in <module>\n    BeforeInstallHook().execute()\n  File "/usr/lib/ambari-agent/lib/resource_management/libraries/script/script.py", line 352, in execute\n    method(env)\n  File "/var/lib/ambari-agent/cache/stack-hooks/before-INSTALL/scripts/hook.py", line 33, in hook\n    install_packages()\n  File "/var/lib/ambari-agent/cache/stack-hooks/before-INSTALL/scripts/shared_initialization.py", line 37, in install_packages\n    retry_count=params.agent_stack_retry_count)\n  File "/usr/lib/ambari-agent/lib/resource_management/core/base.py", line 125, in __new__\n    cls(names_list.pop(0), env, provider, **kwargs)\n  File "/usr/lib/ambari-agent/lib/resource_management/core/base.py", line 166, in __init__\n    self.env.run()\n  File "/usr/lib/ambari-agent/lib/resource_management/core/environment.py", line 160, in run\n    self.run_action(resource, action)\n  File "/usr/lib/ambari-agent/lib/resource_management/core/environment.py", line 124, in run_action\n    provider_action()\n  File "/usr/lib/ambari-agent/lib/resource_management/core/providers/packaging.py", line 30, in action_install\n    self._pkg_manager.install_package(package_name, self.__create_context())\n  File "/usr/lib/ambari-agent/lib/ambari_commons/repo_manager/yum_manager.py", line 211, in install_package\n    elif context.is_upgrade or context.use_repos or not self._check_existence(name):\n  File "/usr/lib/ambari-agent/lib/ambari_commons/repo_manager/yum_manager.py", line 278, in _check_existence\n    return self.yum_check_package_available(name)\n  File "/usr/lib/ambari-agent/lib/ambari_commons/repo_manager/yum_manager.py", line 293, in yum_check_package_available\n    package_list = yb.rpmdb.simplePkgList()\n  File "/usr/lib/python2.7/site-packages/yum/__init__.py", line 1083, in <lambda>\n    rpmdb = property(fget=lambda self: self._getRpmDB(),\n  File "/usr/lib/python2.7/site-packages/yum/__init__.py", line 648, in _getRpmDB\n    self._rpmdb = rpmsack.RPMDBPackageSack(root=self.conf.installroot,\n  File "/usr/lib/python2.7/site-packages/yum/__init__.py", line 1079, in <lambda>\n    conf = property(fget=lambda self: self._getConfig(),\n  File "/usr/lib/python2.7/site-packages/yum/__init__.py", line 386, in _getConfig\n    startupconf.pluginconfpath,disabled_plugins,enabled_plugins)\n  File "/usr/lib/python2.7/site-packages/yum/__init__.py", line 630, in doPluginSetup\n    plugin_types, confpath, disabled_plugins, enabled_plugins)\n  File "/usr/lib/python2.7/site-packages/yum/plugins.py", line 166, in __init__\n    self.run(\'config\')\n  File "/usr/lib/python2.7/site-packages/yum/plugins.py", line 188, in run\n    func(conduitcls(self, self.base, conf, **kwargs))\n  File "/usr/lib/yum-plugins/langpacks.py", line 205, in config_hook\n    (lang, encoding) = locale.getdefaultlocale()\n  File "/usr/lib64/python2.7/locale.py", line 511, in getdefaultlocale\n    return _parse_localename(localename)\n  File "/usr/lib64/python2.7/locale.py", line 443, in _parse_localename\n    raise ValueError, \'unknown locale: %s\' % localename\nValueError: unknown locale: UTF-8\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br")])]),e("h2",{attrs:{id:"解决方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[n._v("#")]),n._v(" 解决方法")]),n._v(" "),e("p",[n._v("服务器编码问题,在文件:"),e("code",[n._v("/usr/sbin/ambari-agent")]),n._v("中添加")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("export LANG=en_US.UTF-8\nexport LC_ALL=en_US.UTF-8\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br")])]),e("p",[n._v("如下图所示：")]),n._v(" "),e("p",[e("img",{attrs:{src:"https://s2.loli.net/2024/04/08/EzBD3ktXbCY7Qcr.png",alt:"image-20240227192418847"}})]),n._v(" "),e("p",[n._v("重启服务：")]),n._v(" "),e("p",[e("code",[n._v("ambari-agent restart")])])])}),[],!1,null,null,null);e.default=i.exports}}]);