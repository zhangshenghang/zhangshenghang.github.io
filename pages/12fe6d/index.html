<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据湖Iceberg-FlinkSQL集成(5) | Jast blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="后端技术博客,专注大数据、java后端、运维学习与总结。Hadoop、Hbase、Spark、Flink等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.6b2f3ec1.css" as="style"><link rel="preload" href="/assets/js/app.a5c64990.js" as="script"><link rel="preload" href="/assets/js/2.9cc65402.js" as="script"><link rel="preload" href="/assets/js/250.26ffc44a.js" as="script"><link rel="prefetch" href="/assets/js/10.ba6c1d32.js"><link rel="prefetch" href="/assets/js/100.ccd1a39e.js"><link rel="prefetch" href="/assets/js/101.91cade52.js"><link rel="prefetch" href="/assets/js/102.027c71bd.js"><link rel="prefetch" href="/assets/js/103.de30883d.js"><link rel="prefetch" href="/assets/js/104.da277c7f.js"><link rel="prefetch" href="/assets/js/105.3bf9d637.js"><link rel="prefetch" href="/assets/js/106.a9e6dde2.js"><link rel="prefetch" href="/assets/js/107.860f85f9.js"><link rel="prefetch" href="/assets/js/108.4db25d5c.js"><link rel="prefetch" href="/assets/js/109.25820bdd.js"><link rel="prefetch" href="/assets/js/11.f1952de8.js"><link rel="prefetch" href="/assets/js/110.b15ac071.js"><link rel="prefetch" href="/assets/js/111.2de3d63d.js"><link rel="prefetch" href="/assets/js/112.0d5386a4.js"><link rel="prefetch" href="/assets/js/113.0039984c.js"><link rel="prefetch" href="/assets/js/114.dbfd963d.js"><link rel="prefetch" href="/assets/js/115.1dcd21d8.js"><link rel="prefetch" href="/assets/js/116.48600243.js"><link rel="prefetch" href="/assets/js/117.bbcc1071.js"><link rel="prefetch" href="/assets/js/118.d7cd7dc2.js"><link rel="prefetch" href="/assets/js/119.7b7e1b39.js"><link rel="prefetch" href="/assets/js/12.83759251.js"><link rel="prefetch" href="/assets/js/120.330446cb.js"><link rel="prefetch" href="/assets/js/121.fd2c8119.js"><link rel="prefetch" href="/assets/js/122.ec0a20e0.js"><link rel="prefetch" href="/assets/js/123.256a201a.js"><link rel="prefetch" href="/assets/js/124.e46e6a5a.js"><link rel="prefetch" href="/assets/js/125.93869b30.js"><link rel="prefetch" href="/assets/js/126.6e6b45bb.js"><link rel="prefetch" href="/assets/js/127.7b7d0615.js"><link rel="prefetch" href="/assets/js/128.75398be2.js"><link rel="prefetch" href="/assets/js/129.1410d7a1.js"><link rel="prefetch" href="/assets/js/13.bd1c4176.js"><link rel="prefetch" href="/assets/js/130.bfe1cad6.js"><link rel="prefetch" href="/assets/js/131.286e4fb2.js"><link rel="prefetch" href="/assets/js/132.298f0154.js"><link rel="prefetch" href="/assets/js/133.25e9e0fd.js"><link rel="prefetch" href="/assets/js/134.a156117e.js"><link rel="prefetch" href="/assets/js/135.b5580f83.js"><link rel="prefetch" href="/assets/js/136.8446e66a.js"><link rel="prefetch" href="/assets/js/137.4291a0c3.js"><link rel="prefetch" href="/assets/js/138.03e36af0.js"><link rel="prefetch" href="/assets/js/139.753d5e11.js"><link rel="prefetch" href="/assets/js/14.c30cabe4.js"><link rel="prefetch" href="/assets/js/140.b136f09c.js"><link rel="prefetch" href="/assets/js/141.6e321584.js"><link rel="prefetch" href="/assets/js/142.19594f5a.js"><link rel="prefetch" href="/assets/js/143.83b5a670.js"><link rel="prefetch" href="/assets/js/144.143de838.js"><link rel="prefetch" href="/assets/js/145.ead82905.js"><link rel="prefetch" href="/assets/js/146.f037d4ec.js"><link rel="prefetch" href="/assets/js/147.2416d84a.js"><link rel="prefetch" href="/assets/js/148.c672f1e5.js"><link rel="prefetch" href="/assets/js/149.caf20103.js"><link rel="prefetch" href="/assets/js/15.a36cf9fa.js"><link rel="prefetch" href="/assets/js/150.43e61e26.js"><link rel="prefetch" href="/assets/js/151.d3d8d0ca.js"><link rel="prefetch" href="/assets/js/152.4ebef6e9.js"><link rel="prefetch" href="/assets/js/153.3c49a9bd.js"><link rel="prefetch" href="/assets/js/154.6d6660a6.js"><link rel="prefetch" href="/assets/js/155.e80efaba.js"><link rel="prefetch" href="/assets/js/156.1a2c1468.js"><link rel="prefetch" href="/assets/js/157.65dab597.js"><link rel="prefetch" href="/assets/js/158.5342d014.js"><link rel="prefetch" href="/assets/js/159.a1c44f33.js"><link rel="prefetch" href="/assets/js/16.01d2a439.js"><link rel="prefetch" href="/assets/js/160.f6de5687.js"><link rel="prefetch" href="/assets/js/161.4a33f4f3.js"><link rel="prefetch" href="/assets/js/162.293b5c45.js"><link rel="prefetch" href="/assets/js/163.94f8c46f.js"><link rel="prefetch" href="/assets/js/164.e9874af4.js"><link rel="prefetch" href="/assets/js/165.c40136e3.js"><link rel="prefetch" href="/assets/js/166.b9514f6f.js"><link rel="prefetch" href="/assets/js/167.b55df3a5.js"><link rel="prefetch" href="/assets/js/168.bfd7b561.js"><link rel="prefetch" href="/assets/js/169.ec8ee5ab.js"><link rel="prefetch" href="/assets/js/17.4a34d519.js"><link rel="prefetch" href="/assets/js/170.4e8ebcdb.js"><link rel="prefetch" href="/assets/js/171.046b515a.js"><link rel="prefetch" href="/assets/js/172.0bfdc048.js"><link rel="prefetch" href="/assets/js/173.b1065684.js"><link rel="prefetch" href="/assets/js/174.a26151c8.js"><link rel="prefetch" href="/assets/js/175.af67d813.js"><link rel="prefetch" href="/assets/js/176.8351882c.js"><link rel="prefetch" href="/assets/js/177.a5985895.js"><link rel="prefetch" href="/assets/js/178.3803a24d.js"><link rel="prefetch" href="/assets/js/179.943ff67a.js"><link rel="prefetch" href="/assets/js/18.40ac91d6.js"><link rel="prefetch" href="/assets/js/180.88c378a7.js"><link rel="prefetch" href="/assets/js/181.55d56274.js"><link rel="prefetch" href="/assets/js/182.2a01d579.js"><link rel="prefetch" href="/assets/js/183.4f593acd.js"><link rel="prefetch" href="/assets/js/184.a476b544.js"><link rel="prefetch" href="/assets/js/185.02a334a8.js"><link rel="prefetch" href="/assets/js/186.e13edcb1.js"><link rel="prefetch" href="/assets/js/187.522769b5.js"><link rel="prefetch" href="/assets/js/188.c7145e3e.js"><link rel="prefetch" href="/assets/js/189.19159109.js"><link rel="prefetch" href="/assets/js/19.c6a1d5d4.js"><link rel="prefetch" href="/assets/js/190.7eeef6ca.js"><link rel="prefetch" href="/assets/js/191.d891e4cd.js"><link rel="prefetch" href="/assets/js/192.d57db752.js"><link rel="prefetch" href="/assets/js/193.51d140b9.js"><link rel="prefetch" href="/assets/js/194.719c07fb.js"><link rel="prefetch" href="/assets/js/195.d1f4ad39.js"><link rel="prefetch" href="/assets/js/196.89045dfe.js"><link rel="prefetch" href="/assets/js/197.8b582e17.js"><link rel="prefetch" href="/assets/js/198.dd108c0b.js"><link rel="prefetch" href="/assets/js/199.6dcb685e.js"><link rel="prefetch" href="/assets/js/20.2c61c41b.js"><link rel="prefetch" href="/assets/js/200.980a6e3a.js"><link rel="prefetch" href="/assets/js/201.0022dd0a.js"><link rel="prefetch" href="/assets/js/202.b1771899.js"><link rel="prefetch" href="/assets/js/203.5b8c52fb.js"><link rel="prefetch" href="/assets/js/204.1de31510.js"><link rel="prefetch" href="/assets/js/205.e4c193e9.js"><link rel="prefetch" href="/assets/js/206.c43d57fd.js"><link rel="prefetch" href="/assets/js/207.a7696d68.js"><link rel="prefetch" href="/assets/js/208.5b51bd38.js"><link rel="prefetch" href="/assets/js/209.f2c6e228.js"><link rel="prefetch" href="/assets/js/21.9630f7d2.js"><link rel="prefetch" href="/assets/js/210.d499c1e8.js"><link rel="prefetch" href="/assets/js/211.7caf7044.js"><link rel="prefetch" href="/assets/js/212.eb88150d.js"><link rel="prefetch" href="/assets/js/213.7a66a771.js"><link rel="prefetch" href="/assets/js/214.650eca57.js"><link rel="prefetch" href="/assets/js/215.d58c9428.js"><link rel="prefetch" href="/assets/js/216.17c5fbbb.js"><link rel="prefetch" href="/assets/js/217.cc6016b1.js"><link rel="prefetch" href="/assets/js/218.0f2ad43c.js"><link rel="prefetch" href="/assets/js/219.0cc56748.js"><link rel="prefetch" href="/assets/js/22.ae388eb6.js"><link rel="prefetch" href="/assets/js/220.c6da1ce9.js"><link rel="prefetch" href="/assets/js/221.c2499e5c.js"><link rel="prefetch" href="/assets/js/222.b87b5047.js"><link rel="prefetch" href="/assets/js/223.14221086.js"><link rel="prefetch" href="/assets/js/224.48415224.js"><link rel="prefetch" href="/assets/js/225.3323e2fd.js"><link rel="prefetch" href="/assets/js/226.97115136.js"><link rel="prefetch" href="/assets/js/227.51ac123d.js"><link rel="prefetch" href="/assets/js/228.ac7adb8a.js"><link rel="prefetch" href="/assets/js/229.4423a81d.js"><link rel="prefetch" href="/assets/js/23.1b7a265e.js"><link rel="prefetch" href="/assets/js/230.93f5e7f6.js"><link rel="prefetch" href="/assets/js/231.5c829d72.js"><link rel="prefetch" href="/assets/js/232.b497791c.js"><link rel="prefetch" href="/assets/js/233.0759dd52.js"><link rel="prefetch" href="/assets/js/234.5c77c942.js"><link rel="prefetch" href="/assets/js/235.62c61b2a.js"><link rel="prefetch" href="/assets/js/236.d6e69fa9.js"><link rel="prefetch" href="/assets/js/237.0392f6c6.js"><link rel="prefetch" href="/assets/js/238.46dc8425.js"><link rel="prefetch" href="/assets/js/239.6f9df60c.js"><link rel="prefetch" href="/assets/js/24.32543ee9.js"><link rel="prefetch" href="/assets/js/240.bae013f7.js"><link rel="prefetch" href="/assets/js/241.c81b66a5.js"><link rel="prefetch" href="/assets/js/242.9296a5c8.js"><link rel="prefetch" href="/assets/js/243.4b16b49b.js"><link rel="prefetch" href="/assets/js/244.f9ee3d4b.js"><link rel="prefetch" href="/assets/js/245.a1a4b62f.js"><link rel="prefetch" href="/assets/js/246.3c7d7878.js"><link rel="prefetch" href="/assets/js/247.03056af4.js"><link rel="prefetch" href="/assets/js/248.cd672886.js"><link rel="prefetch" href="/assets/js/249.4c6c1707.js"><link rel="prefetch" href="/assets/js/25.bd2e359f.js"><link rel="prefetch" href="/assets/js/251.85db4e67.js"><link rel="prefetch" href="/assets/js/252.d4febe54.js"><link rel="prefetch" href="/assets/js/253.df2ea5e2.js"><link rel="prefetch" href="/assets/js/254.b8d0d20e.js"><link rel="prefetch" href="/assets/js/255.49c4ec7d.js"><link rel="prefetch" href="/assets/js/256.98014536.js"><link rel="prefetch" href="/assets/js/257.25c9f009.js"><link rel="prefetch" href="/assets/js/258.1ae5e480.js"><link rel="prefetch" href="/assets/js/259.7333eaaf.js"><link rel="prefetch" href="/assets/js/26.dc9e3004.js"><link rel="prefetch" href="/assets/js/260.8edc3b07.js"><link rel="prefetch" href="/assets/js/261.e6ee2a4e.js"><link rel="prefetch" href="/assets/js/262.f248c8c3.js"><link rel="prefetch" href="/assets/js/263.82be0c8f.js"><link rel="prefetch" href="/assets/js/264.55691777.js"><link rel="prefetch" href="/assets/js/265.e346b753.js"><link rel="prefetch" href="/assets/js/266.92dc4b9b.js"><link rel="prefetch" href="/assets/js/267.c32ec0a7.js"><link rel="prefetch" href="/assets/js/268.0b55a11d.js"><link rel="prefetch" href="/assets/js/269.cc1d3112.js"><link rel="prefetch" href="/assets/js/27.f6948f93.js"><link rel="prefetch" href="/assets/js/270.8151a5d3.js"><link rel="prefetch" href="/assets/js/271.7a93b23b.js"><link rel="prefetch" href="/assets/js/272.473c500f.js"><link rel="prefetch" href="/assets/js/273.b9a56533.js"><link rel="prefetch" href="/assets/js/274.e7b60a0c.js"><link rel="prefetch" href="/assets/js/275.2adf8ff0.js"><link rel="prefetch" href="/assets/js/276.9777514a.js"><link rel="prefetch" href="/assets/js/277.c511d92a.js"><link rel="prefetch" href="/assets/js/278.abac46d2.js"><link rel="prefetch" href="/assets/js/279.5f806255.js"><link rel="prefetch" href="/assets/js/28.564c26dd.js"><link rel="prefetch" href="/assets/js/280.b4fa1858.js"><link rel="prefetch" href="/assets/js/281.5c28de7b.js"><link rel="prefetch" href="/assets/js/282.716ae2bd.js"><link rel="prefetch" href="/assets/js/283.39be7d8b.js"><link rel="prefetch" href="/assets/js/284.abc5f110.js"><link rel="prefetch" href="/assets/js/285.65637f3b.js"><link rel="prefetch" href="/assets/js/286.e004360d.js"><link rel="prefetch" href="/assets/js/287.d33c8cd1.js"><link rel="prefetch" href="/assets/js/288.ba9e1859.js"><link rel="prefetch" href="/assets/js/289.f8794ca0.js"><link rel="prefetch" href="/assets/js/29.7aa96265.js"><link rel="prefetch" href="/assets/js/290.eaebdbe2.js"><link rel="prefetch" href="/assets/js/291.bafcfffb.js"><link rel="prefetch" href="/assets/js/292.2a76dceb.js"><link rel="prefetch" href="/assets/js/293.f0ad6ee5.js"><link rel="prefetch" href="/assets/js/294.e6cd28e7.js"><link rel="prefetch" href="/assets/js/295.75c0c32e.js"><link rel="prefetch" href="/assets/js/296.1ba987c7.js"><link rel="prefetch" href="/assets/js/297.df4e6a7c.js"><link rel="prefetch" href="/assets/js/298.aa1d1380.js"><link rel="prefetch" href="/assets/js/299.dfe05cd0.js"><link rel="prefetch" href="/assets/js/3.cce5b785.js"><link rel="prefetch" href="/assets/js/30.c13ddbd0.js"><link rel="prefetch" href="/assets/js/300.19933949.js"><link rel="prefetch" href="/assets/js/301.9fa4f769.js"><link rel="prefetch" href="/assets/js/302.48bb0bca.js"><link rel="prefetch" href="/assets/js/303.60801364.js"><link rel="prefetch" href="/assets/js/304.0ec54d13.js"><link rel="prefetch" href="/assets/js/305.22aeb531.js"><link rel="prefetch" href="/assets/js/306.35173816.js"><link rel="prefetch" href="/assets/js/307.6f9f609e.js"><link rel="prefetch" href="/assets/js/308.69064216.js"><link rel="prefetch" href="/assets/js/309.185a8a53.js"><link rel="prefetch" href="/assets/js/31.e36024e9.js"><link rel="prefetch" href="/assets/js/310.39eacd5b.js"><link rel="prefetch" href="/assets/js/311.94730eab.js"><link rel="prefetch" href="/assets/js/312.372b86fb.js"><link rel="prefetch" href="/assets/js/313.79347503.js"><link rel="prefetch" href="/assets/js/314.df279936.js"><link rel="prefetch" href="/assets/js/315.a4ab6047.js"><link rel="prefetch" href="/assets/js/316.04812ac5.js"><link rel="prefetch" href="/assets/js/317.d4641ea0.js"><link rel="prefetch" href="/assets/js/318.f18535d4.js"><link rel="prefetch" href="/assets/js/319.20dfc68f.js"><link rel="prefetch" href="/assets/js/32.0ee96ddb.js"><link rel="prefetch" href="/assets/js/320.c929eba9.js"><link rel="prefetch" href="/assets/js/321.861a5c0a.js"><link rel="prefetch" href="/assets/js/322.f9e4950e.js"><link rel="prefetch" href="/assets/js/323.59cb4207.js"><link rel="prefetch" href="/assets/js/324.2747c5b1.js"><link rel="prefetch" href="/assets/js/325.b5376734.js"><link rel="prefetch" href="/assets/js/326.73ffe0f8.js"><link rel="prefetch" href="/assets/js/327.33f55ebb.js"><link rel="prefetch" href="/assets/js/328.fdd8e3ef.js"><link rel="prefetch" href="/assets/js/329.cf9000ee.js"><link rel="prefetch" href="/assets/js/33.edbffdcb.js"><link rel="prefetch" href="/assets/js/330.e9eb38bf.js"><link rel="prefetch" href="/assets/js/331.bd442f05.js"><link rel="prefetch" href="/assets/js/332.45c23042.js"><link rel="prefetch" href="/assets/js/333.73153fca.js"><link rel="prefetch" href="/assets/js/334.636199e0.js"><link rel="prefetch" href="/assets/js/335.4d0a6ae8.js"><link rel="prefetch" href="/assets/js/336.97a253e7.js"><link rel="prefetch" href="/assets/js/337.4c9b5efc.js"><link rel="prefetch" href="/assets/js/338.33f94fd1.js"><link rel="prefetch" href="/assets/js/34.4e043e27.js"><link rel="prefetch" href="/assets/js/35.6d49f989.js"><link rel="prefetch" href="/assets/js/36.f5960d39.js"><link rel="prefetch" href="/assets/js/37.74a2a80e.js"><link rel="prefetch" href="/assets/js/38.6269f916.js"><link rel="prefetch" href="/assets/js/39.141e11e0.js"><link rel="prefetch" href="/assets/js/4.64911f15.js"><link rel="prefetch" href="/assets/js/40.1bf4483c.js"><link rel="prefetch" href="/assets/js/41.c347bb50.js"><link rel="prefetch" href="/assets/js/42.e47b1df3.js"><link rel="prefetch" href="/assets/js/43.f7cad0d0.js"><link rel="prefetch" href="/assets/js/44.7a3d1f90.js"><link rel="prefetch" href="/assets/js/45.89306311.js"><link rel="prefetch" href="/assets/js/46.dc47b9d0.js"><link rel="prefetch" href="/assets/js/47.8eed0639.js"><link rel="prefetch" href="/assets/js/48.4f7cbfb6.js"><link rel="prefetch" href="/assets/js/49.e233ecee.js"><link rel="prefetch" href="/assets/js/5.9287b9e3.js"><link rel="prefetch" href="/assets/js/50.1e32c9d8.js"><link rel="prefetch" href="/assets/js/51.5e33bddb.js"><link rel="prefetch" href="/assets/js/52.70a3d801.js"><link rel="prefetch" href="/assets/js/53.82526036.js"><link rel="prefetch" href="/assets/js/54.0fa9bdf5.js"><link rel="prefetch" href="/assets/js/55.ebf4e851.js"><link rel="prefetch" href="/assets/js/56.e488aa6a.js"><link rel="prefetch" href="/assets/js/57.87413c7a.js"><link rel="prefetch" href="/assets/js/58.1c4f47bd.js"><link rel="prefetch" href="/assets/js/59.322d86a2.js"><link rel="prefetch" href="/assets/js/6.a8023fc9.js"><link rel="prefetch" href="/assets/js/60.d473b033.js"><link rel="prefetch" href="/assets/js/61.f8f26d39.js"><link rel="prefetch" href="/assets/js/62.5c5ed58e.js"><link rel="prefetch" href="/assets/js/63.e5abb75c.js"><link rel="prefetch" href="/assets/js/64.a65ce6e6.js"><link rel="prefetch" href="/assets/js/65.dbf5f0c6.js"><link rel="prefetch" href="/assets/js/66.7f4486d3.js"><link rel="prefetch" href="/assets/js/67.0bf55b7c.js"><link rel="prefetch" href="/assets/js/68.990bf5e4.js"><link rel="prefetch" href="/assets/js/69.f4b629ef.js"><link rel="prefetch" href="/assets/js/7.2b62e6bd.js"><link rel="prefetch" href="/assets/js/70.c02ca837.js"><link rel="prefetch" href="/assets/js/71.6ee1373d.js"><link rel="prefetch" href="/assets/js/72.ee903926.js"><link rel="prefetch" href="/assets/js/73.58dba419.js"><link rel="prefetch" href="/assets/js/74.a7d42e7d.js"><link rel="prefetch" href="/assets/js/75.4ffbe225.js"><link rel="prefetch" href="/assets/js/76.f2fcbfcd.js"><link rel="prefetch" href="/assets/js/77.d0c3deb7.js"><link rel="prefetch" href="/assets/js/78.0010c461.js"><link rel="prefetch" href="/assets/js/79.6a70a604.js"><link rel="prefetch" href="/assets/js/8.40ca4fd6.js"><link rel="prefetch" href="/assets/js/80.ae573a8e.js"><link rel="prefetch" href="/assets/js/81.eaf44acc.js"><link rel="prefetch" href="/assets/js/82.e6bb0732.js"><link rel="prefetch" href="/assets/js/83.23310e8c.js"><link rel="prefetch" href="/assets/js/84.54ca505b.js"><link rel="prefetch" href="/assets/js/85.9f70bfbc.js"><link rel="prefetch" href="/assets/js/86.74ddf3fb.js"><link rel="prefetch" href="/assets/js/87.60e01ba5.js"><link rel="prefetch" href="/assets/js/88.1226d6c3.js"><link rel="prefetch" href="/assets/js/89.507975f1.js"><link rel="prefetch" href="/assets/js/9.bce4872d.js"><link rel="prefetch" href="/assets/js/90.f306161d.js"><link rel="prefetch" href="/assets/js/91.3fe96e1e.js"><link rel="prefetch" href="/assets/js/92.bd84fdc8.js"><link rel="prefetch" href="/assets/js/93.0c6dbc9b.js"><link rel="prefetch" href="/assets/js/94.1eec16ff.js"><link rel="prefetch" href="/assets/js/95.84199af6.js"><link rel="prefetch" href="/assets/js/96.3a709dfa.js"><link rel="prefetch" href="/assets/js/97.388f4466.js"><link rel="prefetch" href="/assets/js/98.22f33c4e.js"><link rel="prefetch" href="/assets/js/99.3f832234.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6b2f3ec1.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Jast blog" class="logo"> <span class="site-name can-hide">Jast blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><a href="/bigdata/" class="link-title">大数据</a> <span class="title" style="display:none;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/ambari/develop/" class="nav-link">《Ambari自定义开发教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/cdh/" class="nav-link">《CDH教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">《ClickHouse教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hdfs/" class="nav-link">《HDFS教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/dolphinscheduler/" class="nav-link">《DolphinScheduler教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hbase/" class="nav-link">《Hbase教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iceberg/" class="nav-link">《Iceberg教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hive/" class="nav-link">《Hive教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flume/" class="nav-link">《Flume教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">《Kafka教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/impala/" class="nav-link">《Impala教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hue/" class="nav-link">《Hue教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/spark/" class="nav-link">《Spark教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flink/" class="nav-link">《Flink教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/phoenix/" class="nav-link">《Phoenix教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/elasticsearch/" class="nav-link">《ElasticSearch教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kylin/" class="nav-link">《Kylin教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/storm/" class="nav-link">《Storm教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/yarn/" class="nav-link">《Yarn教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/presto/" class="nav-link">《Presto教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/graph/" class="nav-link">《图数据库教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kerberos/" class="nav-link">《Kerberos教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/maxwell/" class="nav-link">《Maxwell教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/minio/" class="nav-link">《MinIO教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/datax/" class="nav-link">《DataX教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/superset/" class="nav-link">《Superset教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iotdb/" class="nav-link">《IOTDB教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/bigdata/other/" class="nav-link">《大数据相关》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><a href="/ai/" class="link-title">人工智能</a> <span class="title" style="display:none;">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/paddlenlp/" class="nav-link">《PaddleNLP教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/yunwei/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/nginx/" class="nav-link">《Nginx教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/java/" class="nav-link">《Java技术文档》</a></li><li class="dropdown-item"><!----> <a href="/note/maven/" class="nav-link">《Maven教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/idea/" class="nav-link">《IDEA使用教程》</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/head.jpeg"> <div class="blogger-info"><h3>Jast-zsh</h3> <span>如果你知道你要去哪里，全世界都会给你让路。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><a href="/bigdata/" class="link-title">大数据</a> <span class="title" style="display:none;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/ambari/develop/" class="nav-link">《Ambari自定义开发教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/cdh/" class="nav-link">《CDH教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">《ClickHouse教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hdfs/" class="nav-link">《HDFS教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/dolphinscheduler/" class="nav-link">《DolphinScheduler教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hbase/" class="nav-link">《Hbase教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iceberg/" class="nav-link">《Iceberg教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hive/" class="nav-link">《Hive教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flume/" class="nav-link">《Flume教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">《Kafka教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/impala/" class="nav-link">《Impala教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hue/" class="nav-link">《Hue教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/spark/" class="nav-link">《Spark教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flink/" class="nav-link">《Flink教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/phoenix/" class="nav-link">《Phoenix教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/elasticsearch/" class="nav-link">《ElasticSearch教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kylin/" class="nav-link">《Kylin教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/storm/" class="nav-link">《Storm教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/yarn/" class="nav-link">《Yarn教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/presto/" class="nav-link">《Presto教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/graph/" class="nav-link">《图数据库教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kerberos/" class="nav-link">《Kerberos教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/maxwell/" class="nav-link">《Maxwell教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/minio/" class="nav-link">《MinIO教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/datax/" class="nav-link">《DataX教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/superset/" class="nav-link">《Superset教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iotdb/" class="nav-link">《IOTDB教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/bigdata/other/" class="nav-link">《大数据相关》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><a href="/ai/" class="link-title">人工智能</a> <span class="title" style="display:none;">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/paddlenlp/" class="nav-link">《PaddleNLP教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/yunwei/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/nginx/" class="nav-link">《Nginx教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/java/" class="nav-link">《Java技术文档》</a></li><li class="dropdown-item"><!----> <a href="/note/maven/" class="nav-link">《Maven教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/idea/" class="nav-link">《IDEA使用教程》</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/pages/6b81b0/" class="sidebar-link">FlinkClient使用Iceberg</a></li><li><a href="/pages/e731cc/" class="sidebar-link">Iceberg基于Hadoop存储数据格式介绍</a></li><li><a href="/pages/1c690d/" class="sidebar-link">Kafka数据写入Iceberg</a></li><li><a href="/pages/f4794d/" class="sidebar-link">Flink代码读写Iceberg</a></li><li><a href="/pages/d3710b/" class="sidebar-link">数据湖Iceberg-简介(1)</a></li><li><a href="/pages/ded150/" class="sidebar-link">数据湖Iceberg-存储结构(2)</a></li><li><a href="/pages/9a96a6/" class="sidebar-link">数据湖Iceberg-Hive集成Iceberg(3)</a></li><li><a href="/pages/592494/" class="sidebar-link">数据湖Iceberg-SparkSQL集成(4)</a></li><li><a href="/pages/12fe6d/" aria-current="page" class="active sidebar-link">数据湖Iceberg-FlinkSQL集成(5)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/12fe6d/#环境准备" class="sidebar-link">环境准备</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#flink与iceberg的版本对应关系如下" class="sidebar-link">Flink与Iceberg的版本对应关系如下</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#jar包下载地址" class="sidebar-link">jar包下载地址</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#jar包上传到flink-lib目录下" class="sidebar-link">jar包上传到Flink lib目录下</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#修改flink-conf-yaml配置" class="sidebar-link">修改flink-conf.yaml配置</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/12fe6d/#创建和使用catalog" class="sidebar-link">创建和使用Catalog</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#创建语法说明" class="sidebar-link">创建语法说明</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#hive-catalog" class="sidebar-link">Hive Catalog</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#hadoop-catalog" class="sidebar-link">Hadoop Catalog</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#配置sql-client初始化文件" class="sidebar-link">配置sql-client初始化文件</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/12fe6d/#ddl语句" class="sidebar-link">DDL语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#创建数据库" class="sidebar-link">创建数据库</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#创建表" class="sidebar-link">创建表</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#创建分区表" class="sidebar-link">创建分区表</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#使用like语法建表" class="sidebar-link">使用LIKE语法建表</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#查看表结构" class="sidebar-link">查看表结构</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#修改表" class="sidebar-link">修改表</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#修改表属性" class="sidebar-link">修改表属性</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#修改表名" class="sidebar-link">修改表名</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#删除表" class="sidebar-link">删除表</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#查询数据" class="sidebar-link">查询数据</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#flink-on-yarn的问题" class="sidebar-link">Flink On Yarn的问题</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#batch模式" class="sidebar-link">Batch模式</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#streaming模式" class="sidebar-link">Streaming模式</a></li><li class="sidebar-sub-header level5"><a href="/pages/12fe6d/#从当前快照读取所有记录-然后从该快照读取增量数据" class="sidebar-link">从当前快照读取所有记录，然后从该快照读取增量数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/12fe6d/#读取指定快照id-不包含-后的增量数据" class="sidebar-link">读取指定快照id（不包含）后的增量数据</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#插入数据" class="sidebar-link">插入数据</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#insert-into" class="sidebar-link">INSERT INTO</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#insert-overwrite" class="sidebar-link">INSERT OVERWRITE</a></li><li class="sidebar-sub-header level4"><a href="/pages/12fe6d/#upsert" class="sidebar-link">UPSERT</a></li><li class="sidebar-sub-header level5"><a href="/pages/12fe6d/#读取kafka流-upsert插入到iceberg表中" class="sidebar-link">读取Kafka流，upsert插入到iceberg表中</a></li><li class="sidebar-sub-header level3"><a href="/pages/12fe6d/#与flink集成的不足" class="sidebar-link">与Flink集成的不足</a></li></ul></li></ul></li><li><a href="/pages/edf0ba/" class="sidebar-link">数据湖Iceberg-FlinkSQL-kafka类型表数据无法成功写入(6)</a></li><li><a href="/pages/571843/" class="sidebar-link">数据湖Iceberg-Flink DataFrame集成(7)</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E3%80%8AIceberg%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0" title="分类" data-v-06225672>《Iceberg教程》笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://datamining.blog.csdn.net/" target="_blank" title="作者" class="beLink" data-v-06225672>Jast-zsh</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-04-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">数据湖Iceberg-FlinkSQL集成(5)<!----></h1>  <div class="theme-vdoing-content content__default"><p>[toc]</p> <p><a href="https://www.hadoop.wiki/pages/d3710b" target="_blank" rel="noopener noreferrer">数据湖Iceberg-简介(1)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.hadoop.wiki/pages/ded150/" target="_blank" rel="noopener noreferrer">数据湖Iceberg-存储结构(2)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.hadoop.wiki/pages/9a96a6/" target="_blank" rel="noopener noreferrer">数据湖Iceberg-Hive集成Iceberg(3)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.hadoop.wiki/pages/592494/" target="_blank" rel="noopener noreferrer">数据湖Iceberg-SparkSQL集成(4)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.hadoop.wiki/pages/12fe6d/" target="_blank" rel="noopener noreferrer">数据湖Iceberg-FlinkSQL集成(5)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.hadoop.wiki/pages/edf0ba/" target="_blank" rel="noopener noreferrer">数据湖Iceberg-FlinkSQL-kafka类型表数据无法成功写入(6)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.hadoop.wiki/pages/571843/" target="_blank" rel="noopener noreferrer">数据湖Iceberg-Flink DataFrame集成(7)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="数据湖iceberg-flinksql集成"><a href="#数据湖iceberg-flinksql集成" class="header-anchor">#</a> 数据湖Iceberg-FlinkSQL集成</h1> <h2 id="环境准备"><a href="#环境准备" class="header-anchor">#</a> 环境准备</h2> <h3 id="flink与iceberg的版本对应关系如下"><a href="#flink与iceberg的版本对应关系如下" class="header-anchor">#</a> <strong>Flink与Iceberg的版本对应关系如下</strong></h3> <table><thead><tr><th>Flink 版本</th> <th>Iceberg 版本</th></tr></thead> <tbody><tr><td>1.11</td> <td>0.9.0 – 0.12.1</td></tr> <tr><td>1.12</td> <td>0.12.0 – 0.13.1</td></tr> <tr><td>1.13</td> <td>0.13.0 – 1.0.0</td></tr> <tr><td>1.14</td> <td>0.13.0 – 1.1.0</td></tr> <tr><td>1.15</td> <td>0.14.0 – 1.1.0</td></tr> <tr><td>1.16</td> <td>1.1.0 – 1.1.0</td></tr></tbody></table> <h3 id="jar包下载地址"><a href="#jar包下载地址" class="header-anchor">#</a> jar包下载地址</h3> <p><a href="https://repo1.maven.org/maven2/org/apache/iceberg/iceberg-flink-runtime-1.14/" target="_blank" rel="noopener noreferrer">https://repo1.maven.org/maven2/org/apache/iceberg/iceberg-flink-runtime-1.14/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>在里面选择自己的版本即可，这里我使用的是flink 1.14.3 iceberg1.1.0版本</p> <p>具体下载地址:<a href="https://repo1.maven.org/maven2/org/apache/iceberg/iceberg-flink-runtime-1.14/1.1.0/iceberg-flink-runtime-1.14-1.1.0.jar" target="_blank" rel="noopener noreferrer">https://repo1.maven.org/maven2/org/apache/iceberg/iceberg-flink-runtime-1.14/1.1.0/iceberg-flink-runtime-1.14-1.1.0.jar<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="jar包上传到flink-lib目录下"><a href="#jar包上传到flink-lib目录下" class="header-anchor">#</a> jar包上传到Flink lib目录下</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@ lib<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/opt/flink/lib
<span class="token punctuation">[</span>root@ lib<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">252612</span>
-rw-r--r-- <span class="token number">1</span> flink flink     <span class="token number">85584</span> Jan <span class="token number">11</span>  <span class="token number">2022</span> flink-csv-1.14.3.jar
-rw-r--r-- <span class="token number">1</span> flink flink <span class="token number">136054094</span> Jan <span class="token number">11</span>  <span class="token number">2022</span> flink-dist_2.12-1.14.3.jar
-rw-r--r-- <span class="token number">1</span> flink flink    <span class="token number">153145</span> Jan <span class="token number">11</span>  <span class="token number">2022</span> flink-json-1.14.3.jar
-rw-rw-r-- <span class="token number">1</span> flink flink  <span class="token number">43317025</span> Jan <span class="token number">13</span> <span class="token number">13</span>:54 flink-shaded-hadoop-2-uber-2.8.3-10.0.jar
-rw-r--r-- <span class="token number">1</span> flink flink   <span class="token number">7709731</span> Aug <span class="token number">22</span>  <span class="token number">2021</span> flink-shaded-zookeeper-3.4.14.jar
-rw-r--r-- <span class="token number">1</span> flink flink  <span class="token number">39633410</span> Jan <span class="token number">11</span>  <span class="token number">2022</span> flink-table_2.12-1.14.3.jar
-rw-r--r-- <span class="token number">1</span> flink flink   <span class="token number">29256108</span> Apr <span class="token number">21</span> 09:21 iceberg-flink-runtime-1.14-1.1.0.jar
-rw-r--r-- <span class="token number">1</span> flink flink    <span class="token number">112758</span> May  <span class="token number">3</span>  <span class="token number">2013</span> javax.ws.rs-api-2.0.jar
-rw-r--r-- <span class="token number">1</span> flink flink    <span class="token number">208006</span> Jan  <span class="token number">9</span>  <span class="token number">2022</span> log4j-1.2-api-2.17.1.jar
-rw-r--r-- <span class="token number">1</span> flink flink    <span class="token number">301872</span> Jan  <span class="token number">9</span>  <span class="token number">2022</span> log4j-api-2.17.1.jar
-rw-r--r-- <span class="token number">1</span> flink flink   <span class="token number">1790452</span> Jan  <span class="token number">9</span>  <span class="token number">2022</span> log4j-core-2.17.1.jar
-rw-r--r-- <span class="token number">1</span> flink flink     <span class="token number">24279</span> Jan  <span class="token number">9</span>  <span class="token number">2022</span> log4j-slf4j-impl-2.17.1.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="修改flink-conf-yaml配置"><a href="#修改flink-conf-yaml配置" class="header-anchor">#</a> 修改flink-conf.yaml配置</h3> <p>修改或添加以下配置</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># 禁用 ClassLoader 检查</span>
<span class="token key atrule">classloader.check-leaked-classloader</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

<span class="token comment"># 每个 TaskManager 上任务槽数量，这里为 4</span>
<span class="token key atrule">taskmanager.numberOfTaskSlots</span><span class="token punctuation">:</span> <span class="token number">4</span>

<span class="token comment"># 状态后端使用 RocksDB</span>
<span class="token key atrule">state.backend</span><span class="token punctuation">:</span> rocksdb

<span class="token comment"># 每隔 30000 毫秒进行一次检查点</span>
<span class="token key atrule">execution.checkpointing.interval</span><span class="token punctuation">:</span> <span class="token number">30000</span>

<span class="token comment"># 指定检查点保存的目录，这里为 HDFS 上的目录</span>
<span class="token key atrule">state.checkpoints.dir</span><span class="token punctuation">:</span> hdfs<span class="token punctuation">:</span>//hadoop1<span class="token punctuation">:</span>8020/ckps

<span class="token comment"># 启用增量式检查点，这将在一定程度上提高性能</span>
<span class="token key atrule">state.backend.incremental</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>启动flink-sql</p> <blockquote><p>注意：</p> <p>刚刚Flink修改完需要重启Flink</p></blockquote> <p>输入 <code>./sql-client.sh embedded</code>或者<code>./sql-client</code></p> <blockquote><p><code>sql-client.sh embedded</code> 是启动 Flink SQL Client 时指定的一种模式，即嵌入式模式。</p> <p>在嵌入式模式下，Flink SQL Client 会自动启动一个 Flink 集群，无需手动启动，直接在命令行中交互式地输入 SQL 命令进行查询和操作。同时，Flink SQL Client 会将所有的数据和表定义存储在本地内存中，这意味着不支持持久化数据和高可用性。</p> <p>相反，如果您使用的是独立模式，Flink SQL Client 会连接到一个已经运行的 Flink 集群。在这种模式下，需要首先手动启动 Flink 集群，并将 Flink SQL Client 配置为连接到该集群。独立模式相对嵌入式模式更加灵活和可扩展，但启动和配置过程可能需要更多的时间和精力。</p> <p>总之，嵌入式模式适用于快速原型设计和小规模数据探索，而独立模式适用于生产环境和大规模数据处理。</p></blockquote> <p><img src="https://s2.loli.net/2023/04/24/vLZ2Mxs1mb6eo9a.png" alt="image-20230421094425043"></p> <h2 id="创建和使用catalog"><a href="#创建和使用catalog" class="header-anchor">#</a> 创建和使用Catalog</h2> <h3 id="创建语法说明"><a href="#创建语法说明" class="header-anchor">#</a> 创建语法说明</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> CATALOG <span class="token operator">&lt;</span>catalog_name<span class="token operator">&gt;</span> <span class="token keyword">WITH</span> <span class="token punctuation">(</span>
  <span class="token string">'type'</span><span class="token operator">=</span><span class="token string">'iceberg'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>&lt;config_key&gt;<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token identifier"><span class="token punctuation">`</span>&lt;config_value&gt;<span class="token punctuation">`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>type: 必须是iceberg。（必须）</li> <li>catalog-type: 内置了hive和hadoop两种catalog，也可以使用catalog-impl来自定义catalog。（可选）</li> <li>catalog-impl: 自定义catalog实现的全限定类名。如果未设置catalog-type，则必须设置。（可选）</li> <li>property-version: 描述属性版本的版本号。此属性可用于向后兼容，以防属性格式更改。当前属性版本为1。（可选）</li> <li>cache-enabled: 是否启用目录缓存，默认值为true。（可选）</li> <li>cache.expiration-interval-ms: 本地缓存catalog条目的时间(以毫秒为单位)；负值，如-1表示没有时间限制，不允许设为0。默认值为-1。（可选）</li></ul> <h3 id="hive-catalog"><a href="#hive-catalog" class="header-anchor">#</a> Hive Catalog</h3> <ul><li>上传hive connector到flink的lib中</li></ul> <p>下载地址:<a href="https://repo1.maven.org/maven2/org/apache/flink/flink-sql-connector-hive-3.1.2_2.12/1.14.3/flink-sql-connector-hive-3.1.2_2.12-1.14.3.jar" target="_blank" rel="noopener noreferrer">https://repo1.maven.org/maven2/org/apache/flink/flink-sql-connector-hive-3.1.2_2.12/1.14.3/flink-sql-connector-hive-3.1.2_2.12-1.14.3.jar<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>重启Flink集群，进入sql-client</li></ul> <blockquote><p>如果不上传jar包重启服务，后续可能会遇到这种错误</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[ERROR] Could not execute SQL statement. Reason:
org.apache.hadoop.hive.metastore.api.MetaException: java.lang.reflect.UndeclaredThrowableException
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></blockquote> <ul><li>创建Hive Catalog</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> CATALOG hive_catalog <span class="token keyword">WITH</span> <span class="token punctuation">(</span>
  <span class="token string">'type'</span><span class="token operator">=</span><span class="token string">'iceberg'</span><span class="token punctuation">,</span>
  <span class="token string">'catalog-type'</span><span class="token operator">=</span><span class="token string">'hive'</span><span class="token punctuation">,</span>
  <span class="token string">'uri'</span><span class="token operator">=</span><span class="token string">'thrift://bigdata-24-195:9083'</span><span class="token punctuation">,</span>
  <span class="token string">'clients'</span><span class="token operator">=</span><span class="token string">'5'</span><span class="token punctuation">,</span>
  <span class="token string">'property-version'</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token string">'warehouse'</span><span class="token operator">=</span><span class="token string">'hdfs://bigdata-24-194:8020/iceberg/iceberg-hive'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>注意：这里指定的warehouse目录hive用户需要有权限访问，否则后续创建库或者表会失败</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>Flink <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> iceberg_db<span class="token punctuation">;</span>
<span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> Could <span class="token operator">not</span> <span class="token keyword">execute</span> <span class="token keyword">SQL</span> statement<span class="token punctuation">.</span> Reason:
org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>metastore<span class="token punctuation">.</span>api<span class="token punctuation">.</span>MetaException: java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>UndeclaredThrowableException
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>详细异常日志可以在hive日志中查看</p></blockquote> <ul><li><p>uri: Hive metastore的thrift uri。(必选)</p></li> <li><p>clients:Hive metastore客户端池大小，默认为2。(可选)</p></li> <li><p>warehouse: 数仓目录。</p></li> <li><p>hive-conf-dir:包含hive-site.xml配置文件的目录路径，hive-site.xml中hive.metastore.warehouse.dir 的值会被warehouse覆盖。</p></li> <li><p>hadoop-conf-dir:包含core-site.xml和hdfs-site.xml配置文件的目录路径。</p></li> <li><p>查看catalogs</p></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>Flink <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">show</span> CATALOGS <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span>    catalog name <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> default_catalog <span class="token operator">|</span>
<span class="token operator">|</span>    hive_catalog <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>进入catalogs</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">use</span> catalog hive_catalog<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="hadoop-catalog"><a href="#hadoop-catalog" class="header-anchor">#</a> Hadoop Catalog</h3> <p>Iceberg还支持HDFS中基于目录的catalog，可以使用'catalog-type'='hadoop'配置。</p> <ul><li>创建catalog</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> CATALOG hadoop_catalog <span class="token keyword">WITH</span> <span class="token punctuation">(</span>
  <span class="token string">'type'</span><span class="token operator">=</span><span class="token string">'iceberg'</span><span class="token punctuation">,</span>
  <span class="token string">'catalog-type'</span><span class="token operator">=</span><span class="token string">'hadoop'</span><span class="token punctuation">,</span>
  <span class="token string">'warehouse'</span><span class="token operator">=</span><span class="token string">'hdfs://bigdata-24-194:8020/iceberg/iceberg-hadoop'</span><span class="token punctuation">,</span>
  <span class="token string">'property-version'</span><span class="token operator">=</span><span class="token string">'1'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> catalog hadoop_catalog<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> iceberg_db<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在目录中可以看到我们创建的库和catalog</p> <p><img src="https://s2.loli.net/2023/04/24/yeog57uONktL9wT.png" alt="image-20230421112548809"></p> <h3 id="配置sql-client初始化文件"><a href="#配置sql-client初始化文件" class="header-anchor">#</a> 配置sql-client初始化文件</h3> <p>配置初始化文件后，后续启动，不用每次重新启动都创建catalog</p> <p>在<code>$FLINK_HOME/conf</code>目录下创建<code>sql-client-init.sql</code>文件</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> CATALOG hadoop_catalog <span class="token keyword">WITH</span> <span class="token punctuation">(</span>
  <span class="token string">'type'</span><span class="token operator">=</span><span class="token string">'iceberg'</span><span class="token punctuation">,</span>
  <span class="token string">'catalog-type'</span><span class="token operator">=</span><span class="token string">'hadoop'</span><span class="token punctuation">,</span>
  <span class="token string">'warehouse'</span><span class="token operator">=</span><span class="token string">'hdfs://bigdata-24-194:8020/iceberg/iceberg-hadoop'</span><span class="token punctuation">,</span>
  <span class="token string">'property-version'</span><span class="token operator">=</span><span class="token string">'1'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> CATALOG hive_catalog <span class="token keyword">WITH</span> <span class="token punctuation">(</span>
  <span class="token string">'type'</span><span class="token operator">=</span><span class="token string">'iceberg'</span><span class="token punctuation">,</span>
  <span class="token string">'catalog-type'</span><span class="token operator">=</span><span class="token string">'hive'</span><span class="token punctuation">,</span>
  <span class="token string">'uri'</span><span class="token operator">=</span><span class="token string">'thrift://bigdata-24-195:9083'</span><span class="token punctuation">,</span>
  <span class="token string">'clients'</span><span class="token operator">=</span><span class="token string">'5'</span><span class="token punctuation">,</span>
  <span class="token string">'property-version'</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">,</span>
  <span class="token string">'warehouse'</span><span class="token operator">=</span><span class="token string">'hdfs://bigdata-24-194:8020/iceberg/iceberg-hive'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">USE</span> CATALOG hive_catalog<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>后续启动sql-client时，加上 -i sql文件路径 即可完成catalog的初始化,并进入<code>hive_catalog</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>bin/sql-client.sh embedded <span class="token parameter variable">-i</span> conf/sql-client-init.sql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="ddl语句"><a href="#ddl语句" class="header-anchor">#</a> DDL语句</h2> <h3 id="创建数据库"><a href="#创建数据库" class="header-anchor">#</a> 创建数据库</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> iceberg_db<span class="token punctuation">;</span>
<span class="token keyword">USE</span> iceberg_db<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="创建表"><a href="#创建表" class="header-anchor">#</a> 创建表</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">COMMENT</span> <span class="token string">'unique id'</span><span class="token punctuation">,</span>
    <span class="token keyword">data</span> STRING
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>建表命令现在支持最常用的flink建表语法，包括:</p> <ul><li>PARTITION BY (column1, column2, ...)：配置分区，apache flink还不支持隐藏分区。</li> <li>COMMENT 'table document'：指定表的备注</li> <li>WITH ('key'='value', ...)：设置表属性
目前，不支持计算列、watermark（支持主键）。</li></ul> <h4 id="创建分区表"><a href="#创建分区表" class="header-anchor">#</a> 创建分区表</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample1<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">COMMENT</span> <span class="token string">'unique id'</span><span class="token punctuation">,</span>
    <span class="token keyword">data</span> STRING
<span class="token punctuation">)</span> PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Apache Iceberg支持隐藏分区，但Apache flink不支持在列上通过函数进行分区，现在无法在flink DDL中支持隐藏分区。</p> <h4 id="使用like语法建表"><a href="#使用like语法建表" class="header-anchor">#</a> 使用LIKE语法建表</h4> <p>LIKE语法用于创建一个与另一个表具有相同schema、分区和属性的表。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample2<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
    id <span class="token keyword">BIGINT</span> <span class="token keyword">COMMENT</span> <span class="token string">'unique id'</span><span class="token punctuation">,</span>
    <span class="token keyword">data</span> STRING
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample_like<span class="token punctuation">`</span></span> <span class="token operator">LIKE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample2<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="查看表结构"><a href="#查看表结构" class="header-anchor">#</a> 查看表结构</h4> <p>默认在FlinkSQL中无法查看到表结构</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>Flink <span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">desc</span> formatted sample_like<span class="token punctuation">;</span>
<span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> Could <span class="token operator">not</span> <span class="token keyword">execute</span> <span class="token keyword">SQL</span> statement<span class="token punctuation">.</span> Reason:
org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">.</span>parser<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>ParseException: Encountered <span class="token string">&quot;sample_like&quot;</span> at line <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">column</span> <span class="token number">16.</span>
Was expecting one <span class="token keyword">of</span>:
    <span class="token operator">&lt;</span>EOF<span class="token operator">&gt;</span> 
    <span class="token string">&quot;.&quot;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>我们可以在hive中查看iceberg的表结构</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token number">0</span>: jdbc:hive2:<span class="token comment">//bigdata-24-194:2181,bigdata-2&gt; desc formatted sample_like;</span>
INFO  : Compiling command<span class="token punctuation">(</span>queryId<span class="token operator">=</span>hive_20230421141659_e372d739<span class="token operator">-</span><span class="token number">42</span>e8<span class="token operator">-</span><span class="token number">4</span>cac<span class="token operator">-</span><span class="token number">97</span>a2<span class="token operator">-</span><span class="token number">64</span>c10d12c5da<span class="token punctuation">)</span>: <span class="token keyword">desc</span> formatted sample_like
INFO  : Semantic Analysis Completed <span class="token punctuation">(</span>retrial <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
INFO  : <span class="token keyword">Returning</span> Hive <span class="token keyword">schema</span>: <span class="token keyword">Schema</span><span class="token punctuation">(</span>fieldSchemas:<span class="token punctuation">[</span>FieldSchema<span class="token punctuation">(</span>name:col_name<span class="token punctuation">,</span> <span class="token keyword">type</span>:string<span class="token punctuation">,</span> <span class="token keyword">comment</span>:<span class="token keyword">from</span> deserializer<span class="token punctuation">)</span><span class="token punctuation">,</span> FieldSchema<span class="token punctuation">(</span>name:data_type<span class="token punctuation">,</span> <span class="token keyword">type</span>:string<span class="token punctuation">,</span> <span class="token keyword">comment</span>:<span class="token keyword">from</span> deserializer<span class="token punctuation">)</span><span class="token punctuation">,</span> FieldSchema<span class="token punctuation">(</span>name:<span class="token keyword">comment</span><span class="token punctuation">,</span> <span class="token keyword">type</span>:string<span class="token punctuation">,</span> <span class="token keyword">comment</span>:<span class="token keyword">from</span> deserializer<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> properties:<span class="token boolean">null</span><span class="token punctuation">)</span>
INFO  : Completed compiling command<span class="token punctuation">(</span>queryId<span class="token operator">=</span>hive_20230421141659_e372d739<span class="token operator">-</span><span class="token number">42</span>e8<span class="token operator">-</span><span class="token number">4</span>cac<span class="token operator">-</span><span class="token number">97</span>a2<span class="token operator">-</span><span class="token number">64</span>c10d12c5da<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Time</span> taken: <span class="token number">0.077</span> seconds
INFO  : Executing command<span class="token punctuation">(</span>queryId<span class="token operator">=</span>hive_20230421141659_e372d739<span class="token operator">-</span><span class="token number">42</span>e8<span class="token operator">-</span><span class="token number">4</span>cac<span class="token operator">-</span><span class="token number">97</span>a2<span class="token operator">-</span><span class="token number">64</span>c10d12c5da<span class="token punctuation">)</span>: <span class="token keyword">desc</span> formatted sample_like
INFO  : <span class="token keyword">Starting</span> task <span class="token punctuation">[</span>Stage<span class="token operator">-</span><span class="token number">0</span>:DDL<span class="token punctuation">]</span> <span class="token operator">in</span> <span class="token keyword">serial</span> <span class="token keyword">mode</span>
INFO  : Completed executing command<span class="token punctuation">(</span>queryId<span class="token operator">=</span>hive_20230421141659_e372d739<span class="token operator">-</span><span class="token number">42</span>e8<span class="token operator">-</span><span class="token number">4</span>cac<span class="token operator">-</span><span class="token number">97</span>a2<span class="token operator">-</span><span class="token number">64</span>c10d12c5da<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Time</span> taken: <span class="token number">0.108</span> seconds
INFO  : OK
<span class="token operator">+</span><span class="token comment">-------------------------------+----------------------------------------------------+----------------------------------------------------+</span>
<span class="token operator">|</span>           col_name            <span class="token operator">|</span>                     data_type                      <span class="token operator">|</span>                      <span class="token keyword">comment</span>                       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+----------------------------------------------------+----------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token comment"># col_name                    | data_type                                          | comment                                            |</span>
<span class="token operator">|</span> id                            <span class="token operator">|</span> <span class="token keyword">bigint</span>                                             <span class="token operator">|</span>                                                    <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">data</span>                          <span class="token operator">|</span> string                                             <span class="token operator">|</span>                                                    <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment"># Detailed Table Information  | NULL                                               | NULL                                               |</span>
<span class="token operator">|</span> <span class="token keyword">Database</span>:                     <span class="token operator">|</span> iceberg_db                                         <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> OwnerType:                    <span class="token operator">|</span> <span class="token keyword">USER</span>                                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Owner:                        <span class="token operator">|</span> hdfs                                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> CreateTime:                   <span class="token operator">|</span> Fri Apr <span class="token number">22</span> <span class="token number">14</span>:<span class="token number">16</span>:<span class="token number">17</span> CST <span class="token number">2023</span>                       <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> LastAccessTime:               <span class="token operator">|</span> Sun <span class="token keyword">Dec</span> <span class="token number">14</span> <span class="token number">04</span>:<span class="token number">03</span>:<span class="token number">18</span> CST <span class="token number">1969</span>                       <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Retention:                    <span class="token operator">|</span> <span class="token number">2147483647</span>                                         <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Location:                     <span class="token operator">|</span> hdfs:<span class="token comment">//bigdata-24-194:8020/iceberg/iceberg-hive/iceberg_db.db/sample_like | NULL                                               |</span>
<span class="token operator">|</span> <span class="token keyword">Table</span> <span class="token keyword">Type</span>:                   <span class="token operator">|</span> EXTERNAL_TABLE                                     <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">Table</span> Parameters:             <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> EXTERNAL                                           <span class="token operator">|</span> <span class="token boolean">TRUE</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> <span class="token keyword">current</span><span class="token operator">-</span><span class="token keyword">schema</span>                                     <span class="token operator">|</span> {\&quot;<span class="token keyword">type</span>\&quot;:\&quot;struct\&quot;<span class="token punctuation">,</span>\&quot;<span class="token keyword">schema</span><span class="token operator">-</span>id\&quot;:<span class="token number">0</span><span class="token punctuation">,</span>\&quot;<span class="token keyword">fields</span>\&quot;:<span class="token punctuation">[</span>{\&quot;id\&quot;:<span class="token number">1</span><span class="token punctuation">,</span>\&quot;name\&quot;:\&quot;id\&quot;<span class="token punctuation">,</span>\&quot;required\&quot;:<span class="token boolean">false</span><span class="token punctuation">,</span>\&quot;<span class="token keyword">type</span>\&quot;:\&quot;long\&quot;}<span class="token punctuation">,</span>{\&quot;id\&quot;:<span class="token number">2</span><span class="token punctuation">,</span>\&quot;name\&quot;:\&quot;<span class="token keyword">data</span>\&quot;<span class="token punctuation">,</span>\&quot;required\&quot;:<span class="token boolean">false</span><span class="token punctuation">,</span>\&quot;<span class="token keyword">type</span>\&quot;:\&quot;string\&quot;}<span class="token punctuation">]</span>} <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> metadata_location                                  <span class="token operator">|</span> hdfs:<span class="token comment">//bigdata-24-194:8020/iceberg/iceberg-hive/iceberg_db.db/sample_like/metadata/00000-0750a26c-8b26-4417-9f27-7786a5775026.metadata.json |</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> numFiles                                           <span class="token operator">|</span> <span class="token number">1</span>                                                  <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> <span class="token keyword">snapshot</span><span class="token operator">-</span>count                                     <span class="token operator">|</span> <span class="token number">0</span>                                                  <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> table_type                                         <span class="token operator">|</span> ICEBERG                                            <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> totalSize                                          <span class="token operator">|</span> <span class="token number">1225</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> transient_lastDdlTime                              <span class="token operator">|</span> <span class="token number">1682057777</span>                                         <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> uuid                                               <span class="token operator">|</span> <span class="token number">4</span>e0be931<span class="token operator">-</span>e962<span class="token operator">-</span><span class="token number">4</span>a94<span class="token operator">-</span>a176<span class="token operator">-</span><span class="token number">3969012647</span>c1               <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token comment"># Storage Information         | NULL                                               | NULL                                               |</span>
<span class="token operator">|</span> SerDe Library:                <span class="token operator">|</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>serde2<span class="token punctuation">.</span>lazy<span class="token punctuation">.</span>LazySimpleSerDe <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> InputFormat:                  <span class="token operator">|</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>FileInputFormat           <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> OutputFormat:                 <span class="token operator">|</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapred<span class="token punctuation">.</span>FileOutputFormat          <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Compressed:                   <span class="token operator">|</span> <span class="token keyword">No</span>                                                 <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Num Buckets:                  <span class="token operator">|</span> <span class="token number">0</span>                                                  <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Bucket <span class="token keyword">Columns</span>:               <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                                 <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">|</span> Sort <span class="token keyword">Columns</span>:                 <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                                 <span class="token operator">|</span> <span class="token boolean">NULL</span>                                               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+----------------------------------------------------+----------------------------------------------------+</span>
<span class="token number">32</span> <span class="token keyword">rows</span> selected <span class="token punctuation">(</span><span class="token number">0.289</span> seconds<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h3 id="修改表"><a href="#修改表" class="header-anchor">#</a> 修改表</h3> <p>Flink SQL 目前只支持修改表属性和表名，其他的暂不支持，需要使用API才可以修改</p> <h4 id="修改表属性"><a href="#修改表属性" class="header-anchor">#</a> 修改表属性</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span> <span class="token keyword">SET</span> <span class="token punctuation">(</span><span class="token string">'write.format.default'</span><span class="token operator">=</span><span class="token string">'avro'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="修改表名"><a href="#修改表名" class="header-anchor">#</a> 修改表名</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span> <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>new_sample<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="删除表"><a href="#删除表" class="header-anchor">#</a> 删除表</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>不会删除具体数据，HDFS中文件还继续存在</p></blockquote> <h3 id="查询数据"><a href="#查询数据" class="header-anchor">#</a> 查询数据</h3> <h4 id="flink-on-yarn的问题"><a href="#flink-on-yarn的问题" class="header-anchor">#</a> Flink On Yarn的问题</h4> <p>这里遇到个问题，先在这直接说了，刚刚只是操作元数据所以没遇到这个问题，在插入和查询都会遇到这个问题</p> <p>我使用的是Ambari集成的Flink，运行模式为<code>Flink on Yarn</code>，直接用查询、插入语句去操作q数据会提示连接拒绝。</p> <p>这里几个问题点需要注意：</p> <ul><li>1.当我们使用<code>Flink on Yarn</code>模式提交时需要指定<code>-s yarn-session</code>去运行,如下</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>bin<span class="token operator">/</span><span class="token keyword">sql</span><span class="token operator">-</span>client<span class="token punctuation">.</span>sh <span class="token operator">-</span>s yarn<span class="token operator">-</span><span class="token keyword">session</span>  <span class="token operator">-</span>i conf<span class="token operator">/</span><span class="token keyword">sql</span><span class="token operator">-</span>client<span class="token operator">-</span>init<span class="token punctuation">.</span><span class="token keyword">sql</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>指定 <code>-s yarn-session</code> 后，Flink会在当前服务器<code>/tmp/.yarn-properties-flink</code>文件找到运行的yarn-session任务，去提交。</p> <p>内容如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># cat /tmp/.yarn-properties-flink   </span>
<span class="token comment">#Generated YARN properties file</span>
<span class="token comment">#Fri Apr 21 11:11:44 CST 2023</span>
<span class="token assign-left variable">dynamicPropertiesString</span><span class="token operator">=</span>
<span class="token assign-left variable">applicationID</span><span class="token operator">=</span>application_1675237371712_0532
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></blockquote> <ul><li>2.Ambari 默认Flink on Yarn 提交是使用的Flink用户，我们提交任务是使用HDFS用户，还是会导致提交失败</li></ul> <p>解决方法：kill之前使用flink用户提交的任务，使用HDFS启动Flink on Yarn任务</p> <blockquote><p>这里偷懒了，直接手动kill，手动启动了，有时间可以改下Ambari启动Flink方法，这样才一劳永逸</p></blockquote> <p>Flink on yarn 启动命令如下</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CONF_DIR</span><span class="token operator">=</span>/etc/hadoop/conf<span class="token punctuation">;</span> <span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CLASSPATH</span><span class="token operator">=</span>/usr/hdp/3.1.5.0-152/hadoop/conf:/usr/hdp/3.1.5.0-152/hadoop/lib/*:/usr/hdp/3.1.5.0-152/hadoop/.//*:/usr/hdp/3.1.5.0-152/hadoop-hdfs/./:/usr/hdp/3.1.5.0-152/hadoop-hdfs/lib/*:/usr/hdp/3.1.5.0-152/hadoop-hdfs/.//*:/usr/hdp/3.1.5.0-152/hadoop-mapreduce/lib/*:/usr/hdp/3.1.5.0-152/hadoop-mapreduce/.//*:/usr/hdp/3.1.5.0-152/hadoop-yarn/./:/usr/hdp/3.1.5.0-152/hadoop-yarn/lib/*:/usr/hdp/3.1.5.0-152/hadoop-yarn/.//*:/usr/hdp/3.1.5.0-152/tez/*:/usr/hdp/3.1.5.0-152/tez/lib/*:/usr/hdp/3.1.5.0-152/tez/conf:/usr/hdp/3.1.5.0-152/tez/conf_llap:/usr/hdp/3.1.5.0-152/tez/doc:/usr/hdp/3.1.5.0-152/tez/hadoop-shim-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/hadoop-shim-2.8-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib:/usr/hdp/3.1.5.0-152/tez/man:/usr/hdp/3.1.5.0-152/tez/tez-api-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-common-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-dag-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-examples-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-history-parser-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-javadoc-tools-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-job-analyzer-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-mapreduce-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-protobuf-history-plugin-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-runtime-internals-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-runtime-library-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-tests-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-yarn-timeline-cache-plugin-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-yarn-timeline-history-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-yarn-timeline-history-with-acls-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/tez-yarn-timeline-history-with-fs-0.9.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/ui:/usr/hdp/3.1.5.0-152/tez/lib/async-http-client-1.9.40.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-cli-1.2.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-codec-1.4.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-collections-3.2.2.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-collections4-4.1.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-io-2.4.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-lang-2.6.jar:/usr/hdp/3.1.5.0-152/tez/lib/commons-math3-3.1.1.jar:/usr/hdp/3.1.5.0-152/tez/lib/gcs-connector-hadoop3-1.9.17.3.1.5.0-152-shaded.jar:/usr/hdp/3.1.5.0-152/tez/lib/guava-28.0-jre.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-aws-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-azure-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-azure-datalake-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-hdfs-client-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-mapreduce-client-common-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-mapreduce-client-core-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/hadoop-yarn-server-timeline-pluginstorage-3.1.1.3.1.5.0-152.jar:/usr/hdp/3.1.5.0-152/tez/lib/jersey-client-1.19.jar:/usr/hdp/3.1.5.0-152/tez/lib/jersey-json-1.19.jar:/usr/hdp/3.1.5.0-152/tez/lib/jettison-1.3.4.jar:/usr/hdp/3.1.5.0-152/tez/lib/jetty-server-9.3.24.v20180605.jar:/usr/hdp/3.1.5.0-152/tez/lib/jetty-util-9.3.24.v20180605.jar:/usr/hdp/3.1.5.0-152/tez/lib/jsr305-3.0.0.jar:/usr/hdp/3.1.5.0-152/tez/lib/metrics-core-3.1.0.jar:/usr/hdp/3.1.5.0-152/tez/lib/protobuf-java-2.5.0.jar:/usr/hdp/3.1.5.0-152/tez/lib/RoaringBitmap-0.4.9.jar:/usr/hdp/3.1.5.0-152/tez/lib/servlet-api-2.5.jar:/usr/hdp/3.1.5.0-152/tez/lib/slf4j-api-1.7.10.jar:/usr/hdp/3.1.5.0-152/tez/lib/tez.tar.gz<span class="token punctuation">;</span> 

/opt/flink/bin/yarn-session.sh <span class="token parameter variable">-d</span> <span class="token parameter variable">-nm</span> flinkapp-from-ambari <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token parameter variable">-s</span> <span class="token number">1</span> <span class="token parameter variable">-jm</span> <span class="token number">768</span> <span class="token parameter variable">-tm</span> <span class="token number">1024</span> <span class="token parameter variable">-qu</span> default <span class="token operator">&gt;&gt;</span> /var/log/flink/flink-setup.log <span class="token operator">&amp;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="batch模式"><a href="#batch模式" class="header-anchor">#</a> Batch模式</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> execution<span class="token punctuation">.</span>runtime<span class="token operator">-</span><span class="token keyword">mode</span> <span class="token operator">=</span> batch<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sample<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="streaming模式"><a href="#streaming模式" class="header-anchor">#</a> Streaming模式</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 设置 Flink 的运行模式为流式计算</span>
<span class="token keyword">SET</span> execution<span class="token punctuation">.</span>runtime<span class="token operator">-</span><span class="token keyword">mode</span> <span class="token operator">=</span> streaming<span class="token punctuation">;</span>

<span class="token comment">-- 启用动态表选项</span>
<span class="token keyword">SET</span> <span class="token keyword">table</span><span class="token punctuation">.</span>dynamic<span class="token operator">-</span><span class="token keyword">table</span><span class="token operator">-</span>options<span class="token punctuation">.</span>enabled<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">-- 设置 Flink SQL 执行结果的输出格式为 Tableau</span>
<span class="token keyword">SET</span> <span class="token keyword">sql</span><span class="token operator">-</span>client<span class="token punctuation">.</span>execution<span class="token punctuation">.</span>result<span class="token operator">-</span><span class="token keyword">mode</span><span class="token operator">=</span>tableau<span class="token punctuation">;</span>

<span class="token comment">-- 查询 Hive Catalog 中的 Iceberg 表 sample 中的所有数据</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> hive_catalog<span class="token punctuation">.</span>iceberg_db<span class="token punctuation">.</span>sample<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p><code>SET table.dynamic-table-options.enabled=true;</code></p> <p>从 1.11 开始，用户可以通过动态参数的形式灵活地设置表的属性参数，覆盖或者追加原表的 WITH (...) 语句内定义的 table options。</p> <p>基本语法为：</p> <p>table_path /*+ OPTIONS(key=val [, key=val]*) */
动态参数的使用没有语境限制，只要是引用表的地方都可以追加定义。在指定的表后面追加的动态参数会自动追加到原表定义中</p></blockquote> <h5 id="从当前快照读取所有记录-然后从该快照读取增量数据"><a href="#从当前快照读取所有记录-然后从该快照读取增量数据" class="header-anchor">#</a> 从当前快照读取所有记录，然后从该快照读取增量数据</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sample5 <span class="token comment">/*+ OPTIONS('streaming'='true', 'monitor-interval'='1s')*/</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回格式(会根据新增数据持续滚动)</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>Flink SQL<span class="token operator">&gt;</span> SELECT * FROM hive_catalog.iceberg_db.sample /*+ OPTIONS<span class="token punctuation">(</span><span class="token string">'streaming'</span><span class="token operator">=</span><span class="token string">'true'</span>, <span class="token string">'monitor-interval'</span><span class="token operator">=</span><span class="token string">'1s'</span><span class="token punctuation">)</span>*/ <span class="token punctuation">;</span>
<span class="token number">2023</span>-04-21 <span class="token number">15</span>:43:33,819 INFO  org.apache.hadoop.yarn.client.RMProxy                        <span class="token punctuation">[</span><span class="token punctuation">]</span> - Connecting to ResourceManager at bigdata-24-194/172.16.24.194:8050
<span class="token number">2023</span>-04-21 <span class="token number">15</span>:43:33,821 INFO  org.apache.flink.yarn.YarnClusterDescriptor                  <span class="token punctuation">[</span><span class="token punctuation">]</span> - No path <span class="token keyword">for</span> the flink jar passed. Using the location of class org.apache.flink.yarn.YarnClusterDescriptor to <span class="token function">locate</span> the jar
<span class="token number">2023</span>-04-21 <span class="token number">15</span>:43:33,822 WARN  org.apache.flink.yarn.YarnClusterDescriptor                  <span class="token punctuation">[</span><span class="token punctuation">]</span> - Neither the HADOOP_CONF_DIR nor the YARN_CONF_DIR environment variable is set.The Flink YARN Client needs one of these to be <span class="token builtin class-name">set</span> to properly load the Hadoop configuration <span class="token keyword">for</span> accessing YARN.
<span class="token number">2023</span>-04-21 <span class="token number">15</span>:43:33,830 INFO  org.apache.flink.yarn.YarnClusterDescriptor                  <span class="token punctuation">[</span><span class="token punctuation">]</span> - Found Web Interface bigdata-24-196:6588 of application <span class="token string">'application_1675237371712_0532'</span><span class="token builtin class-name">.</span>
+----+----------------------+--------------------------------+
<span class="token operator">|</span> <span class="token function">op</span> <span class="token operator">|</span>                   <span class="token function">id</span> <span class="token operator">|</span>                           data <span class="token operator">|</span>
+----+----------------------+--------------------------------+
<span class="token operator">|</span> +I <span class="token operator">|</span>                   <span class="token number">34</span> <span class="token operator">|</span>                          aeefb <span class="token operator">|</span>
<span class="token operator">|</span> +I <span class="token operator">|</span>                   <span class="token number">34</span> <span class="token operator">|</span>                             ae <span class="token operator">|</span>
<span class="token operator">|</span> +I <span class="token operator">|</span>                    <span class="token number">1</span> <span class="token operator">|</span>                              a <span class="token operator">|</span>
<span class="token operator">|</span> +I <span class="token operator">|</span>                    <span class="token number">1</span> <span class="token operator">|</span>                              a <span class="token operator">|</span>
<span class="token operator">|</span> +I <span class="token operator">|</span>                   <span class="token number">34</span> <span class="token operator">|</span>                            aee <span class="token operator">|</span>
<span class="token operator">|</span> +I <span class="token operator">|</span>                   <span class="token number">34</span> <span class="token operator">|</span>                    aeeefdsfafb <span class="token operator">|</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="读取指定快照id-不包含-后的增量数据"><a href="#读取指定快照id-不包含-后的增量数据" class="header-anchor">#</a> 读取指定快照id（不包含）后的增量数据</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sample <span class="token comment">/*+ OPTIONS('streaming'='true', 'monitor-interval'='1s', 'start-snapshot-id'='3821550127947089987')*/</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>monitor-interval: 连续监控新提交数据文件的时间间隔（默认为10s）。</p></li> <li><p>start-snapshot-id: 流作业开始的快照id。</p></li></ul> <p>注意：如果是无界数据流式upsert进iceberg表（读kafka，upsert进iceberg表），那么再去流读iceberg表会存在读不出数据的问题。如果无界数据流式append进iceberg表（读kafka，append进iceberg表），那么流读该iceberg表可以正常看到结果。</p> <h3 id="插入数据"><a href="#插入数据" class="header-anchor">#</a> 插入数据</h3> <h4 id="insert-into"><a href="#insert-into" class="header-anchor">#</a> INSERT INTO</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span> <span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> <span class="token keyword">data</span> <span class="token keyword">from</span> sample2<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="insert-overwrite"><a href="#insert-overwrite" class="header-anchor">#</a> INSERT OVERWRITE</h4> <p>仅支持Flink的Batch模式</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> execution<span class="token punctuation">.</span>runtime<span class="token operator">-</span><span class="token keyword">mode</span> <span class="token operator">=</span> batch<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> OVERWRITE sample <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> OVERWRITE <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>default<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample<span class="token punctuation">`</span></span> <span class="token keyword">PARTITION</span><span class="token punctuation">(</span><span class="token keyword">data</span><span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">SELECT</span> <span class="token number">6</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="upsert"><a href="#upsert" class="header-anchor">#</a> UPSERT</h4> <p>当将数据写入<code>v2</code>表格式时，Iceberg支持基于主键的UPSERT。有两种方法可以启用upsert。</p> <p><strong>建表时指定</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample5<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>  <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">COMMENT</span> <span class="token string">'unique id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data<span class="token punctuation">`</span></span> STRING <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token operator">NOT</span> ENFORCED
<span class="token punctuation">)</span> <span class="token keyword">with</span> <span class="token punctuation">(</span>
<span class="token string">'format-version'</span><span class="token operator">=</span><span class="token string">'2'</span><span class="token punctuation">,</span> 
<span class="token string">'write.upsert.enabled'</span><span class="token operator">=</span><span class="token string">'true'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>插入时指定</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample5<span class="token punctuation">`</span></span> <span class="token comment">/*+ OPTIONS('upsert-enabled'='true') */</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>+----+-------------+--------------------------------+
| op |          id |                           data |
+----+-------------+--------------------------------+
| +I |           1 |                              a |
| +I |           2 |                              b |
| +I |           3 |                              c |
+----+-------------+--------------------------------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>插入</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>hive_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample5<span class="token punctuation">`</span></span> <span class="token comment">/*+ OPTIONS('upsert-enabled'='true') */</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">----+-------------+--------------------------------+</span>
<span class="token operator">|</span> op <span class="token operator">|</span>          id <span class="token operator">|</span>                           <span class="token keyword">data</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------------+--------------------------------+</span>
<span class="token operator">|</span> <span class="token operator">+</span>I <span class="token operator">|</span>           <span class="token number">1</span> <span class="token operator">|</span>                            abc <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">+</span>I <span class="token operator">|</span>           <span class="token number">2</span> <span class="token operator">|</span>                              b <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">+</span>I <span class="token operator">|</span>           <span class="token number">3</span> <span class="token operator">|</span>                              c <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------------+--------------------------------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>插入的表，format-version需要为2。</p> <p>OVERWRITE和UPSERT不能同时设置。在UPSERT模式下，如果对表进行分区，则分区字段必须也是主键。</p> <h5 id="读取kafka流-upsert插入到iceberg表中"><a href="#读取kafka流-upsert插入到iceberg表中" class="header-anchor">#</a> 读取Kafka流，upsert插入到iceberg表中</h5> <p>下载：<a href="https://repo1.maven.org/maven2/org/apache/flink/flink-sql-connector-kafka_2.12/1.14.3/flink-sql-connector-kafka_2.12-1.14.3.jar" target="_blank" rel="noopener noreferrer">https://repo1.maven.org/maven2/org/apache/flink/flink-sql-connector-kafka_2.12/1.14.3/flink-sql-connector-kafka_2.12-1.14.3.jar<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>将jar包放到<code>$FLINK_HOME/lib</code>目录下，重启Flink On Yarn</p> <p>这里先说一个大坑，Iceberg现阶段的一个Bug</p> <p>Kafka表必须要在<code>default_catalog.default_database</code>下，即<code>catalog</code>名为<code>default_catalog</code>，数据库(命名空间)为<code>default_database</code>下,否则kafka类型的表读取不到数据。</p> <p>如果都在我们自己创建的catalog下创建，则执行<code>INSERT INTO hadoop_catalog.iceberg_db.sample6 SELECT * FROM default_catalog.default_database.kafka1;</code>后,在Flink任务中看不到一个持续执行的Flink Job，而正常执行该命令Flink会执行一个持续执行的任务，去消费kafka数据写入Iceberg，正常情况如下图：</p> <p><img src="https://s2.loli.net/2023/04/24/wLyJ9QSNtBi7gUr.png" alt="image-20230421171018370"></p> <p>所以这里我们kafka表在<code>default_catalog.default_database</code>下，写入数据的表在我们自己创建的<code>hadoop_catalog.iceberg_db</code>下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> default_catalog<span class="token punctuation">.</span>default_database<span class="token punctuation">.</span>kafka1<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  <span class="token keyword">data</span> string
<span class="token punctuation">)</span> <span class="token keyword">with</span> <span class="token punctuation">(</span>
  <span class="token string">'connector'</span> <span class="token operator">=</span> <span class="token string">'kafka'</span>
  <span class="token punctuation">,</span><span class="token string">'topic'</span> <span class="token operator">=</span> <span class="token string">'ttt'</span>
  <span class="token punctuation">,</span><span class="token string">'properties.zookeeper.connect'</span> <span class="token operator">=</span> <span class="token string">'172.16.24.194:2181'</span>
  <span class="token punctuation">,</span><span class="token string">'properties.bootstrap.servers'</span> <span class="token operator">=</span> <span class="token string">'172.16.24.194:9092'</span>
  <span class="token punctuation">,</span><span class="token string">'format'</span> <span class="token operator">=</span> <span class="token string">'json'</span>
  <span class="token punctuation">,</span><span class="token string">'properties.group.id'</span><span class="token operator">=</span><span class="token string">'iceberg1'</span>
  <span class="token punctuation">,</span><span class="token string">'scan.startup.mode'</span><span class="token operator">=</span><span class="token string">'earliest-offset'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>hadoop_catalog<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>iceberg_db<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>sample6<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>  <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">COMMENT</span> <span class="token string">'unique id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data<span class="token punctuation">`</span></span> STRING <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token operator">NOT</span> ENFORCED
<span class="token punctuation">)</span> <span class="token keyword">with</span> <span class="token punctuation">(</span>
<span class="token string">'format-version'</span><span class="token operator">=</span><span class="token string">'2'</span><span class="token punctuation">,</span> 
<span class="token string">'write.upsert.enabled'</span><span class="token operator">=</span><span class="token string">'true'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> hadoop_catalog<span class="token punctuation">.</span>iceberg_db<span class="token punctuation">.</span>sample6 <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> default_catalog<span class="token punctuation">.</span>default_database<span class="token punctuation">.</span>kafka1<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>此时我们往Kafka发送数据：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;llalalala&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">1123</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;asdfasfds&quot;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>查看表中数据可以看到写入成功</p> <p><code>select * from hadoop_catalog.iceberg_db.sample6;</code></p> <p><img src="https://s2.loli.net/2023/04/24/EIMZBJhVtnx4fWi.png" alt="image-20230421171149990"></p> <p>再次发送数据</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;JastData&quot;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看表中数据,发现修改成功</p> <p><img src="https://s2.loli.net/2023/04/24/iCSMOdzF9Q8xtHb.png" alt="image-20230421171457655"></p> <h3 id="与flink集成的不足"><a href="#与flink集成的不足" class="header-anchor">#</a> 与Flink集成的不足</h3> <table><thead><tr><th>支持的特性</th> <th>Flink</th> <th>备注</th></tr></thead> <tbody><tr><td>SQL create catalog</td> <td>√</td> <td></td></tr> <tr><td>SQL create database</td> <td>√</td> <td></td></tr> <tr><td>SQL create table</td> <td>√</td> <td></td></tr> <tr><td>SQL create table like</td> <td>√</td> <td></td></tr> <tr><td>SQL alter table</td> <td>√</td> <td>只支持修改表属性，不支持更改列和分区</td></tr> <tr><td>SQL drop_table</td> <td>√</td> <td></td></tr> <tr><td>SQL select</td> <td>√</td> <td>支持流式和批处理模式</td></tr> <tr><td>SQL insert into</td> <td>√</td> <td>支持流式和批处理模式</td></tr> <tr><td>SQL insert overwrite</td> <td>√</td> <td></td></tr> <tr><td>DataStream read</td> <td>√</td> <td></td></tr> <tr><td>DataStream append</td> <td>√</td> <td></td></tr> <tr><td>DataStream overwrite</td> <td>√</td> <td></td></tr> <tr><td>Metadata tables</td> <td></td> <td>支持Java API，不支持Flink SQL</td></tr> <tr><td>Rewrite files action</td> <td>√</td> <td></td></tr></tbody></table> <ul><li>不支持创建隐藏分区的Iceberg表。</li> <li>不支持创建带有计算列的Iceberg表。</li> <li>不支持创建带watermark的Iceberg表。</li> <li>不支持添加列，删除列，重命名列，更改列。</li> <li>Iceberg目前不支持Flink SQL 查询表的元数据信息，需要使用Java API 实现。</li></ul></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/04/26, 17:38:02</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/592494/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">数据湖Iceberg-SparkSQL集成(4)</div></a> <a href="/pages/edf0ba/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">数据湖Iceberg-FlinkSQL-kafka类型表数据无法成功写入(6)</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/592494/" class="prev">数据湖Iceberg-SparkSQL集成(4)</a></span> <span class="next"><a href="/pages/edf0ba/">数据湖Iceberg-FlinkSQL-kafka类型表数据无法成功写入(6)</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/072cb2/"><div>
            TODO-Clickhouse-Explain查看执行计划
            <!----></div></a> <span class="date">07-02</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f4e4dc/"><div>
            Ambari自定义服务开发-metainfo详细介绍
            <!----></div></a> <span class="date">07-01</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/4983ce/"><div>
            IoTDB服务安装教程-单机版
            <!----></div></a> <span class="date">07-01</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:745925668@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://datamining.blog.csdn.net/" title="CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2016-2025
    <span><a href="https://datamining.blog.csdn.net/">Jast-zsh</a> | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.a5c64990.js" defer></script><script src="/assets/js/2.9cc65402.js" defer></script><script src="/assets/js/250.26ffc44a.js" defer></script>
  </body>
</html>
