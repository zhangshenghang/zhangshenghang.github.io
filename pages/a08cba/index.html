<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kylin | Jast blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="后端技术博客,专注大数据、java后端、运维学习与总结。Hadoop、Hbase、Spark、Flink等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.6b2f3ec1.css" as="style"><link rel="preload" href="/assets/js/app.a5c64990.js" as="script"><link rel="preload" href="/assets/js/2.9cc65402.js" as="script"><link rel="preload" href="/assets/js/270.8151a5d3.js" as="script"><link rel="prefetch" href="/assets/js/10.ba6c1d32.js"><link rel="prefetch" href="/assets/js/100.ccd1a39e.js"><link rel="prefetch" href="/assets/js/101.91cade52.js"><link rel="prefetch" href="/assets/js/102.027c71bd.js"><link rel="prefetch" href="/assets/js/103.de30883d.js"><link rel="prefetch" href="/assets/js/104.da277c7f.js"><link rel="prefetch" href="/assets/js/105.3bf9d637.js"><link rel="prefetch" href="/assets/js/106.a9e6dde2.js"><link rel="prefetch" href="/assets/js/107.860f85f9.js"><link rel="prefetch" href="/assets/js/108.4db25d5c.js"><link rel="prefetch" href="/assets/js/109.25820bdd.js"><link rel="prefetch" href="/assets/js/11.f1952de8.js"><link rel="prefetch" href="/assets/js/110.b15ac071.js"><link rel="prefetch" href="/assets/js/111.2de3d63d.js"><link rel="prefetch" href="/assets/js/112.0d5386a4.js"><link rel="prefetch" href="/assets/js/113.0039984c.js"><link rel="prefetch" href="/assets/js/114.dbfd963d.js"><link rel="prefetch" href="/assets/js/115.1dcd21d8.js"><link rel="prefetch" href="/assets/js/116.48600243.js"><link rel="prefetch" href="/assets/js/117.bbcc1071.js"><link rel="prefetch" href="/assets/js/118.d7cd7dc2.js"><link rel="prefetch" href="/assets/js/119.7b7e1b39.js"><link rel="prefetch" href="/assets/js/12.83759251.js"><link rel="prefetch" href="/assets/js/120.330446cb.js"><link rel="prefetch" href="/assets/js/121.fd2c8119.js"><link rel="prefetch" href="/assets/js/122.ec0a20e0.js"><link rel="prefetch" href="/assets/js/123.256a201a.js"><link rel="prefetch" href="/assets/js/124.e46e6a5a.js"><link rel="prefetch" href="/assets/js/125.93869b30.js"><link rel="prefetch" href="/assets/js/126.6e6b45bb.js"><link rel="prefetch" href="/assets/js/127.7b7d0615.js"><link rel="prefetch" href="/assets/js/128.75398be2.js"><link rel="prefetch" href="/assets/js/129.1410d7a1.js"><link rel="prefetch" href="/assets/js/13.bd1c4176.js"><link rel="prefetch" href="/assets/js/130.bfe1cad6.js"><link rel="prefetch" href="/assets/js/131.286e4fb2.js"><link rel="prefetch" href="/assets/js/132.298f0154.js"><link rel="prefetch" href="/assets/js/133.25e9e0fd.js"><link rel="prefetch" href="/assets/js/134.a156117e.js"><link rel="prefetch" href="/assets/js/135.b5580f83.js"><link rel="prefetch" href="/assets/js/136.8446e66a.js"><link rel="prefetch" href="/assets/js/137.4291a0c3.js"><link rel="prefetch" href="/assets/js/138.03e36af0.js"><link rel="prefetch" href="/assets/js/139.753d5e11.js"><link rel="prefetch" href="/assets/js/14.c30cabe4.js"><link rel="prefetch" href="/assets/js/140.b136f09c.js"><link rel="prefetch" href="/assets/js/141.6e321584.js"><link rel="prefetch" href="/assets/js/142.19594f5a.js"><link rel="prefetch" href="/assets/js/143.83b5a670.js"><link rel="prefetch" href="/assets/js/144.143de838.js"><link rel="prefetch" href="/assets/js/145.ead82905.js"><link rel="prefetch" href="/assets/js/146.f037d4ec.js"><link rel="prefetch" href="/assets/js/147.2416d84a.js"><link rel="prefetch" href="/assets/js/148.c672f1e5.js"><link rel="prefetch" href="/assets/js/149.caf20103.js"><link rel="prefetch" href="/assets/js/15.a36cf9fa.js"><link rel="prefetch" href="/assets/js/150.43e61e26.js"><link rel="prefetch" href="/assets/js/151.d3d8d0ca.js"><link rel="prefetch" href="/assets/js/152.4ebef6e9.js"><link rel="prefetch" href="/assets/js/153.3c49a9bd.js"><link rel="prefetch" href="/assets/js/154.6d6660a6.js"><link rel="prefetch" href="/assets/js/155.e80efaba.js"><link rel="prefetch" href="/assets/js/156.1a2c1468.js"><link rel="prefetch" href="/assets/js/157.65dab597.js"><link rel="prefetch" href="/assets/js/158.5342d014.js"><link rel="prefetch" href="/assets/js/159.a1c44f33.js"><link rel="prefetch" href="/assets/js/16.01d2a439.js"><link rel="prefetch" href="/assets/js/160.f6de5687.js"><link rel="prefetch" href="/assets/js/161.4a33f4f3.js"><link rel="prefetch" href="/assets/js/162.293b5c45.js"><link rel="prefetch" href="/assets/js/163.94f8c46f.js"><link rel="prefetch" href="/assets/js/164.e9874af4.js"><link rel="prefetch" href="/assets/js/165.c40136e3.js"><link rel="prefetch" href="/assets/js/166.b9514f6f.js"><link rel="prefetch" href="/assets/js/167.b55df3a5.js"><link rel="prefetch" href="/assets/js/168.bfd7b561.js"><link rel="prefetch" href="/assets/js/169.ec8ee5ab.js"><link rel="prefetch" href="/assets/js/17.4a34d519.js"><link rel="prefetch" href="/assets/js/170.4e8ebcdb.js"><link rel="prefetch" href="/assets/js/171.046b515a.js"><link rel="prefetch" href="/assets/js/172.0bfdc048.js"><link rel="prefetch" href="/assets/js/173.b1065684.js"><link rel="prefetch" href="/assets/js/174.a26151c8.js"><link rel="prefetch" href="/assets/js/175.af67d813.js"><link rel="prefetch" href="/assets/js/176.8351882c.js"><link rel="prefetch" href="/assets/js/177.a5985895.js"><link rel="prefetch" href="/assets/js/178.3803a24d.js"><link rel="prefetch" href="/assets/js/179.943ff67a.js"><link rel="prefetch" href="/assets/js/18.40ac91d6.js"><link rel="prefetch" href="/assets/js/180.88c378a7.js"><link rel="prefetch" href="/assets/js/181.55d56274.js"><link rel="prefetch" href="/assets/js/182.2a01d579.js"><link rel="prefetch" href="/assets/js/183.4f593acd.js"><link rel="prefetch" href="/assets/js/184.a476b544.js"><link rel="prefetch" href="/assets/js/185.02a334a8.js"><link rel="prefetch" href="/assets/js/186.e13edcb1.js"><link rel="prefetch" href="/assets/js/187.522769b5.js"><link rel="prefetch" href="/assets/js/188.c7145e3e.js"><link rel="prefetch" href="/assets/js/189.19159109.js"><link rel="prefetch" href="/assets/js/19.c6a1d5d4.js"><link rel="prefetch" href="/assets/js/190.7eeef6ca.js"><link rel="prefetch" href="/assets/js/191.d891e4cd.js"><link rel="prefetch" href="/assets/js/192.d57db752.js"><link rel="prefetch" href="/assets/js/193.51d140b9.js"><link rel="prefetch" href="/assets/js/194.719c07fb.js"><link rel="prefetch" href="/assets/js/195.d1f4ad39.js"><link rel="prefetch" href="/assets/js/196.89045dfe.js"><link rel="prefetch" href="/assets/js/197.8b582e17.js"><link rel="prefetch" href="/assets/js/198.dd108c0b.js"><link rel="prefetch" href="/assets/js/199.6dcb685e.js"><link rel="prefetch" href="/assets/js/20.2c61c41b.js"><link rel="prefetch" href="/assets/js/200.980a6e3a.js"><link rel="prefetch" href="/assets/js/201.0022dd0a.js"><link rel="prefetch" href="/assets/js/202.b1771899.js"><link rel="prefetch" href="/assets/js/203.5b8c52fb.js"><link rel="prefetch" href="/assets/js/204.1de31510.js"><link rel="prefetch" href="/assets/js/205.e4c193e9.js"><link rel="prefetch" href="/assets/js/206.c43d57fd.js"><link rel="prefetch" href="/assets/js/207.a7696d68.js"><link rel="prefetch" href="/assets/js/208.5b51bd38.js"><link rel="prefetch" href="/assets/js/209.f2c6e228.js"><link rel="prefetch" href="/assets/js/21.9630f7d2.js"><link rel="prefetch" href="/assets/js/210.d499c1e8.js"><link rel="prefetch" href="/assets/js/211.7caf7044.js"><link rel="prefetch" href="/assets/js/212.eb88150d.js"><link rel="prefetch" href="/assets/js/213.7a66a771.js"><link rel="prefetch" href="/assets/js/214.650eca57.js"><link rel="prefetch" href="/assets/js/215.d58c9428.js"><link rel="prefetch" href="/assets/js/216.17c5fbbb.js"><link rel="prefetch" href="/assets/js/217.cc6016b1.js"><link rel="prefetch" href="/assets/js/218.0f2ad43c.js"><link rel="prefetch" href="/assets/js/219.0cc56748.js"><link rel="prefetch" href="/assets/js/22.ae388eb6.js"><link rel="prefetch" href="/assets/js/220.c6da1ce9.js"><link rel="prefetch" href="/assets/js/221.c2499e5c.js"><link rel="prefetch" href="/assets/js/222.b87b5047.js"><link rel="prefetch" href="/assets/js/223.14221086.js"><link rel="prefetch" href="/assets/js/224.48415224.js"><link rel="prefetch" href="/assets/js/225.3323e2fd.js"><link rel="prefetch" href="/assets/js/226.97115136.js"><link rel="prefetch" href="/assets/js/227.51ac123d.js"><link rel="prefetch" href="/assets/js/228.ac7adb8a.js"><link rel="prefetch" href="/assets/js/229.4423a81d.js"><link rel="prefetch" href="/assets/js/23.1b7a265e.js"><link rel="prefetch" href="/assets/js/230.93f5e7f6.js"><link rel="prefetch" href="/assets/js/231.5c829d72.js"><link rel="prefetch" href="/assets/js/232.b497791c.js"><link rel="prefetch" href="/assets/js/233.0759dd52.js"><link rel="prefetch" href="/assets/js/234.5c77c942.js"><link rel="prefetch" href="/assets/js/235.62c61b2a.js"><link rel="prefetch" href="/assets/js/236.d6e69fa9.js"><link rel="prefetch" href="/assets/js/237.0392f6c6.js"><link rel="prefetch" href="/assets/js/238.46dc8425.js"><link rel="prefetch" href="/assets/js/239.6f9df60c.js"><link rel="prefetch" href="/assets/js/24.32543ee9.js"><link rel="prefetch" href="/assets/js/240.bae013f7.js"><link rel="prefetch" href="/assets/js/241.c81b66a5.js"><link rel="prefetch" href="/assets/js/242.9296a5c8.js"><link rel="prefetch" href="/assets/js/243.4b16b49b.js"><link rel="prefetch" href="/assets/js/244.f9ee3d4b.js"><link rel="prefetch" href="/assets/js/245.a1a4b62f.js"><link rel="prefetch" href="/assets/js/246.3c7d7878.js"><link rel="prefetch" href="/assets/js/247.03056af4.js"><link rel="prefetch" href="/assets/js/248.cd672886.js"><link rel="prefetch" href="/assets/js/249.4c6c1707.js"><link rel="prefetch" href="/assets/js/25.bd2e359f.js"><link rel="prefetch" href="/assets/js/250.26ffc44a.js"><link rel="prefetch" href="/assets/js/251.85db4e67.js"><link rel="prefetch" href="/assets/js/252.d4febe54.js"><link rel="prefetch" href="/assets/js/253.df2ea5e2.js"><link rel="prefetch" href="/assets/js/254.b8d0d20e.js"><link rel="prefetch" href="/assets/js/255.49c4ec7d.js"><link rel="prefetch" href="/assets/js/256.98014536.js"><link rel="prefetch" href="/assets/js/257.25c9f009.js"><link rel="prefetch" href="/assets/js/258.1ae5e480.js"><link rel="prefetch" href="/assets/js/259.7333eaaf.js"><link rel="prefetch" href="/assets/js/26.dc9e3004.js"><link rel="prefetch" href="/assets/js/260.8edc3b07.js"><link rel="prefetch" href="/assets/js/261.e6ee2a4e.js"><link rel="prefetch" href="/assets/js/262.f248c8c3.js"><link rel="prefetch" href="/assets/js/263.82be0c8f.js"><link rel="prefetch" href="/assets/js/264.55691777.js"><link rel="prefetch" href="/assets/js/265.e346b753.js"><link rel="prefetch" href="/assets/js/266.92dc4b9b.js"><link rel="prefetch" href="/assets/js/267.c32ec0a7.js"><link rel="prefetch" href="/assets/js/268.0b55a11d.js"><link rel="prefetch" href="/assets/js/269.cc1d3112.js"><link rel="prefetch" href="/assets/js/27.f6948f93.js"><link rel="prefetch" href="/assets/js/271.7a93b23b.js"><link rel="prefetch" href="/assets/js/272.473c500f.js"><link rel="prefetch" href="/assets/js/273.b9a56533.js"><link rel="prefetch" href="/assets/js/274.e7b60a0c.js"><link rel="prefetch" href="/assets/js/275.2adf8ff0.js"><link rel="prefetch" href="/assets/js/276.9777514a.js"><link rel="prefetch" href="/assets/js/277.c511d92a.js"><link rel="prefetch" href="/assets/js/278.abac46d2.js"><link rel="prefetch" href="/assets/js/279.5f806255.js"><link rel="prefetch" href="/assets/js/28.564c26dd.js"><link rel="prefetch" href="/assets/js/280.b4fa1858.js"><link rel="prefetch" href="/assets/js/281.5c28de7b.js"><link rel="prefetch" href="/assets/js/282.716ae2bd.js"><link rel="prefetch" href="/assets/js/283.39be7d8b.js"><link rel="prefetch" href="/assets/js/284.abc5f110.js"><link rel="prefetch" href="/assets/js/285.65637f3b.js"><link rel="prefetch" href="/assets/js/286.e004360d.js"><link rel="prefetch" href="/assets/js/287.d33c8cd1.js"><link rel="prefetch" href="/assets/js/288.ba9e1859.js"><link rel="prefetch" href="/assets/js/289.f8794ca0.js"><link rel="prefetch" href="/assets/js/29.7aa96265.js"><link rel="prefetch" href="/assets/js/290.eaebdbe2.js"><link rel="prefetch" href="/assets/js/291.bafcfffb.js"><link rel="prefetch" href="/assets/js/292.2a76dceb.js"><link rel="prefetch" href="/assets/js/293.f0ad6ee5.js"><link rel="prefetch" href="/assets/js/294.e6cd28e7.js"><link rel="prefetch" href="/assets/js/295.75c0c32e.js"><link rel="prefetch" href="/assets/js/296.1ba987c7.js"><link rel="prefetch" href="/assets/js/297.df4e6a7c.js"><link rel="prefetch" href="/assets/js/298.aa1d1380.js"><link rel="prefetch" href="/assets/js/299.dfe05cd0.js"><link rel="prefetch" href="/assets/js/3.cce5b785.js"><link rel="prefetch" href="/assets/js/30.c13ddbd0.js"><link rel="prefetch" href="/assets/js/300.19933949.js"><link rel="prefetch" href="/assets/js/301.9fa4f769.js"><link rel="prefetch" href="/assets/js/302.48bb0bca.js"><link rel="prefetch" href="/assets/js/303.60801364.js"><link rel="prefetch" href="/assets/js/304.0ec54d13.js"><link rel="prefetch" href="/assets/js/305.22aeb531.js"><link rel="prefetch" href="/assets/js/306.35173816.js"><link rel="prefetch" href="/assets/js/307.6f9f609e.js"><link rel="prefetch" href="/assets/js/308.69064216.js"><link rel="prefetch" href="/assets/js/309.185a8a53.js"><link rel="prefetch" href="/assets/js/31.e36024e9.js"><link rel="prefetch" href="/assets/js/310.39eacd5b.js"><link rel="prefetch" href="/assets/js/311.94730eab.js"><link rel="prefetch" href="/assets/js/312.372b86fb.js"><link rel="prefetch" href="/assets/js/313.79347503.js"><link rel="prefetch" href="/assets/js/314.df279936.js"><link rel="prefetch" href="/assets/js/315.a4ab6047.js"><link rel="prefetch" href="/assets/js/316.04812ac5.js"><link rel="prefetch" href="/assets/js/317.d4641ea0.js"><link rel="prefetch" href="/assets/js/318.f18535d4.js"><link rel="prefetch" href="/assets/js/319.20dfc68f.js"><link rel="prefetch" href="/assets/js/32.0ee96ddb.js"><link rel="prefetch" href="/assets/js/320.c929eba9.js"><link rel="prefetch" href="/assets/js/321.861a5c0a.js"><link rel="prefetch" href="/assets/js/322.f9e4950e.js"><link rel="prefetch" href="/assets/js/323.59cb4207.js"><link rel="prefetch" href="/assets/js/324.2747c5b1.js"><link rel="prefetch" href="/assets/js/325.b5376734.js"><link rel="prefetch" href="/assets/js/326.73ffe0f8.js"><link rel="prefetch" href="/assets/js/327.33f55ebb.js"><link rel="prefetch" href="/assets/js/328.fdd8e3ef.js"><link rel="prefetch" href="/assets/js/329.cf9000ee.js"><link rel="prefetch" href="/assets/js/33.edbffdcb.js"><link rel="prefetch" href="/assets/js/330.e9eb38bf.js"><link rel="prefetch" href="/assets/js/331.bd442f05.js"><link rel="prefetch" href="/assets/js/332.45c23042.js"><link rel="prefetch" href="/assets/js/333.73153fca.js"><link rel="prefetch" href="/assets/js/334.636199e0.js"><link rel="prefetch" href="/assets/js/335.4d0a6ae8.js"><link rel="prefetch" href="/assets/js/336.97a253e7.js"><link rel="prefetch" href="/assets/js/337.4c9b5efc.js"><link rel="prefetch" href="/assets/js/338.33f94fd1.js"><link rel="prefetch" href="/assets/js/34.4e043e27.js"><link rel="prefetch" href="/assets/js/35.6d49f989.js"><link rel="prefetch" href="/assets/js/36.f5960d39.js"><link rel="prefetch" href="/assets/js/37.74a2a80e.js"><link rel="prefetch" href="/assets/js/38.6269f916.js"><link rel="prefetch" href="/assets/js/39.141e11e0.js"><link rel="prefetch" href="/assets/js/4.64911f15.js"><link rel="prefetch" href="/assets/js/40.1bf4483c.js"><link rel="prefetch" href="/assets/js/41.c347bb50.js"><link rel="prefetch" href="/assets/js/42.e47b1df3.js"><link rel="prefetch" href="/assets/js/43.f7cad0d0.js"><link rel="prefetch" href="/assets/js/44.7a3d1f90.js"><link rel="prefetch" href="/assets/js/45.89306311.js"><link rel="prefetch" href="/assets/js/46.dc47b9d0.js"><link rel="prefetch" href="/assets/js/47.8eed0639.js"><link rel="prefetch" href="/assets/js/48.4f7cbfb6.js"><link rel="prefetch" href="/assets/js/49.e233ecee.js"><link rel="prefetch" href="/assets/js/5.9287b9e3.js"><link rel="prefetch" href="/assets/js/50.1e32c9d8.js"><link rel="prefetch" href="/assets/js/51.5e33bddb.js"><link rel="prefetch" href="/assets/js/52.70a3d801.js"><link rel="prefetch" href="/assets/js/53.82526036.js"><link rel="prefetch" href="/assets/js/54.0fa9bdf5.js"><link rel="prefetch" href="/assets/js/55.ebf4e851.js"><link rel="prefetch" href="/assets/js/56.e488aa6a.js"><link rel="prefetch" href="/assets/js/57.87413c7a.js"><link rel="prefetch" href="/assets/js/58.1c4f47bd.js"><link rel="prefetch" href="/assets/js/59.322d86a2.js"><link rel="prefetch" href="/assets/js/6.a8023fc9.js"><link rel="prefetch" href="/assets/js/60.d473b033.js"><link rel="prefetch" href="/assets/js/61.f8f26d39.js"><link rel="prefetch" href="/assets/js/62.5c5ed58e.js"><link rel="prefetch" href="/assets/js/63.e5abb75c.js"><link rel="prefetch" href="/assets/js/64.a65ce6e6.js"><link rel="prefetch" href="/assets/js/65.dbf5f0c6.js"><link rel="prefetch" href="/assets/js/66.7f4486d3.js"><link rel="prefetch" href="/assets/js/67.0bf55b7c.js"><link rel="prefetch" href="/assets/js/68.990bf5e4.js"><link rel="prefetch" href="/assets/js/69.f4b629ef.js"><link rel="prefetch" href="/assets/js/7.2b62e6bd.js"><link rel="prefetch" href="/assets/js/70.c02ca837.js"><link rel="prefetch" href="/assets/js/71.6ee1373d.js"><link rel="prefetch" href="/assets/js/72.ee903926.js"><link rel="prefetch" href="/assets/js/73.58dba419.js"><link rel="prefetch" href="/assets/js/74.a7d42e7d.js"><link rel="prefetch" href="/assets/js/75.4ffbe225.js"><link rel="prefetch" href="/assets/js/76.f2fcbfcd.js"><link rel="prefetch" href="/assets/js/77.d0c3deb7.js"><link rel="prefetch" href="/assets/js/78.0010c461.js"><link rel="prefetch" href="/assets/js/79.6a70a604.js"><link rel="prefetch" href="/assets/js/8.40ca4fd6.js"><link rel="prefetch" href="/assets/js/80.ae573a8e.js"><link rel="prefetch" href="/assets/js/81.eaf44acc.js"><link rel="prefetch" href="/assets/js/82.e6bb0732.js"><link rel="prefetch" href="/assets/js/83.23310e8c.js"><link rel="prefetch" href="/assets/js/84.54ca505b.js"><link rel="prefetch" href="/assets/js/85.9f70bfbc.js"><link rel="prefetch" href="/assets/js/86.74ddf3fb.js"><link rel="prefetch" href="/assets/js/87.60e01ba5.js"><link rel="prefetch" href="/assets/js/88.1226d6c3.js"><link rel="prefetch" href="/assets/js/89.507975f1.js"><link rel="prefetch" href="/assets/js/9.bce4872d.js"><link rel="prefetch" href="/assets/js/90.f306161d.js"><link rel="prefetch" href="/assets/js/91.3fe96e1e.js"><link rel="prefetch" href="/assets/js/92.bd84fdc8.js"><link rel="prefetch" href="/assets/js/93.0c6dbc9b.js"><link rel="prefetch" href="/assets/js/94.1eec16ff.js"><link rel="prefetch" href="/assets/js/95.84199af6.js"><link rel="prefetch" href="/assets/js/96.3a709dfa.js"><link rel="prefetch" href="/assets/js/97.388f4466.js"><link rel="prefetch" href="/assets/js/98.22f33c4e.js"><link rel="prefetch" href="/assets/js/99.3f832234.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6b2f3ec1.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu only-sidebarItem"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Jast blog" class="logo"> <span class="site-name can-hide">Jast blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><a href="/bigdata/" class="link-title">大数据</a> <span class="title" style="display:none;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/ambari/develop/" class="nav-link">《Ambari自定义开发教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/cdh/" class="nav-link">《CDH教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">《ClickHouse教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hdfs/" class="nav-link">《HDFS教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/dolphinscheduler/" class="nav-link">《DolphinScheduler教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hbase/" class="nav-link">《Hbase教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iceberg/" class="nav-link">《Iceberg教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hive/" class="nav-link">《Hive教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flume/" class="nav-link">《Flume教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">《Kafka教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/impala/" class="nav-link">《Impala教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hue/" class="nav-link">《Hue教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/spark/" class="nav-link">《Spark教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flink/" class="nav-link">《Flink教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/phoenix/" class="nav-link">《Phoenix教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/elasticsearch/" class="nav-link">《ElasticSearch教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kylin/" class="nav-link">《Kylin教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/storm/" class="nav-link">《Storm教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/yarn/" class="nav-link">《Yarn教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/presto/" class="nav-link">《Presto教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/graph/" class="nav-link">《图数据库教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kerberos/" class="nav-link">《Kerberos教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/maxwell/" class="nav-link">《Maxwell教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/minio/" class="nav-link">《MinIO教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/datax/" class="nav-link">《DataX教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/superset/" class="nav-link">《Superset教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iotdb/" class="nav-link">《IOTDB教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/bigdata/other/" class="nav-link">《大数据相关》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><a href="/ai/" class="link-title">人工智能</a> <span class="title" style="display:none;">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/paddlenlp/" class="nav-link">《PaddleNLP教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/yunwei/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/nginx/" class="nav-link">《Nginx教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/java/" class="nav-link">《Java技术文档》</a></li><li class="dropdown-item"><!----> <a href="/note/maven/" class="nav-link">《Maven教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/idea/" class="nav-link">《IDEA使用教程》</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/head.jpeg"> <div class="blogger-info"><h3>Jast-zsh</h3> <span>如果你知道你要去哪里，全世界都会给你让路。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><a href="/bigdata/" class="link-title">大数据</a> <span class="title" style="display:none;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/ambari/develop/" class="nav-link">《Ambari自定义开发教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/cdh/" class="nav-link">《CDH教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/clickhouse/" class="nav-link">《ClickHouse教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hdfs/" class="nav-link">《HDFS教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/dolphinscheduler/" class="nav-link">《DolphinScheduler教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hbase/" class="nav-link">《Hbase教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iceberg/" class="nav-link">《Iceberg教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hive/" class="nav-link">《Hive教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flume/" class="nav-link">《Flume教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kafka/" class="nav-link">《Kafka教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/impala/" class="nav-link">《Impala教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/hue/" class="nav-link">《Hue教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/spark/" class="nav-link">《Spark教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/flink/" class="nav-link">《Flink教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/phoenix/" class="nav-link">《Phoenix教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/elasticsearch/" class="nav-link">《ElasticSearch教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kylin/" class="nav-link">《Kylin教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/storm/" class="nav-link">《Storm教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/yarn/" class="nav-link">《Yarn教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/presto/" class="nav-link">《Presto教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/graph/" class="nav-link">《图数据库教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/kerberos/" class="nav-link">《Kerberos教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/maxwell/" class="nav-link">《Maxwell教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/minio/" class="nav-link">《MinIO教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/datax/" class="nav-link">《DataX教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/superset/" class="nav-link">《Superset教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/iotdb/" class="nav-link">《IOTDB教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/bigdata/other/" class="nav-link">《大数据相关》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="人工智能" class="dropdown-title"><a href="/ai/" class="link-title">人工智能</a> <span class="title" style="display:none;">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/paddlenlp/" class="nav-link">《PaddleNLP教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/yunwei/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/nginx/" class="nav-link">《Nginx教程》笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/java/" class="nav-link">《Java技术文档》</a></li><li class="dropdown-item"><!----> <a href="/note/maven/" class="nav-link">《Maven教程》笔记</a></li><li class="dropdown-item"><!----> <a href="/note/idea/" class="nav-link">《IDEA使用教程》</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/pages/a08cba/" aria-current="page" class="active sidebar-link">Kylin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#文章链接" class="sidebar-link">文章链接</a></li><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#一、概述" class="sidebar-link">一、概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#_1-1-kylin定义" class="sidebar-link">1.1 Kylin定义</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#_1-2-kylin架构" class="sidebar-link">1.2 Kylin架构</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#_1-3-kylin特点" class="sidebar-link">1.3 Kylin特点</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#_1-4-apache-kylin4-概述" class="sidebar-link">1.4 Apache Kylin4 概述</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#为什么选择-parquet-替换-hbase" class="sidebar-link">为什么选择 Parquet 替换 HBase?</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#预计算结果在-kylin4-0-中如何存储" class="sidebar-link">预计算结果在 Kylin4.0 中如何存储?</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#kylin-4-0-的构建引擎" class="sidebar-link">Kylin 4.0 的构建引擎</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#kylin-4-0-的查询引擎" class="sidebar-link">Kylin 4.0 的查询引擎</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#kylin-4-0-与-kylin-3-1-功能对比" class="sidebar-link">Kylin 4.0 与 Kylin 3.1 功能对比</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#kylin-4-0-性能表现" class="sidebar-link">Kylin 4.0 性能表现</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#如何升级" class="sidebar-link">如何升级</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#kylin-4-0-查询和构建调优" class="sidebar-link">Kylin 4.0 查询和构建调优</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#kylin-4-0-用户案例" class="sidebar-link">Kylin 4.0 用户案例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#二、kylin环境搭建-4-x" class="sidebar-link">二、Kylin环境搭建（4.x）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#软件要求" class="sidebar-link">软件要求</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#硬件要求" class="sidebar-link">硬件要求</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#hadoop-环境" class="sidebar-link">Hadoop 环境</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#kylin-安装" class="sidebar-link">Kylin 安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#提前准备" class="sidebar-link">提前准备</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#web页面介绍" class="sidebar-link">Web页面介绍</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#支持的浏览器" class="sidebar-link">支持的浏览器</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#登录系统" class="sidebar-link">登录系统</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#创建工程" class="sidebar-link">创建工程</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#选择数据源" class="sidebar-link">选择数据源</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#创建model" class="sidebar-link">创建Model</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#创建cube" class="sidebar-link">创建Cube</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#cube构建与监控" class="sidebar-link">Cube构建与监控</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#web-ui查询sql" class="sidebar-link">WEB UI查询SQL</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#三、ssb数据实际测试" class="sidebar-link">三、SSB数据实际测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#生成sbb基准测试数据" class="sidebar-link">生成SBB基准测试数据</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#mysql查询、hive查询、kylin查询对比" class="sidebar-link">Mysql查询、Hive查询、Kylin查询对比</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#四、kylin使用注意事项" class="sidebar-link">四、Kylin使用注意事项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#只能按照构建model的连接条件写sql查询" class="sidebar-link">只能按照构建Model的连接条件写SQL查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#只能按照构建-cube-时选择的维度字段分组统计" class="sidebar-link">只能按照构建 Cube 时选择的维度字段分组统计</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#只能统计构建-cube-时选择的度量值字段" class="sidebar-link">只能统计构建 Cube 时选择的度量值字段</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#五、kylin每日自动构建cube" class="sidebar-link">五、Kylin每日自动构建Cube</a></li><li class="sidebar-sub-header level2"><a href="/pages/a08cba/#六、bi工具集成" class="sidebar-link">六、BI工具集成</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#jdbc" class="sidebar-link">JDBC</a></li><li class="sidebar-sub-header level3"><a href="/pages/a08cba/#zepplin" class="sidebar-link">Zepplin</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#安装与启动" class="sidebar-link">安装与启动</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#访问" class="sidebar-link">访问</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#配置kylin" class="sidebar-link">配置Kylin</a></li><li class="sidebar-sub-header level4"><a href="/pages/a08cba/#使用zepplin查询kylin" class="sidebar-link">使用Zepplin查询Kylin</a></li></ul></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E3%80%8AKylin%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0" title="分类" data-v-06225672>《Kylin教程》笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://datamining.blog.csdn.net/" target="_blank" title="作者" class="beLink" data-v-06225672>Jast-zsh</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-03-03</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Kylin<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="apache-kylin-使用手册"><a href="#apache-kylin-使用手册" class="header-anchor">#</a> Apache Kylin 使用手册</h1> <p>[toc]</p> <h2 id="文章链接"><a href="#文章链接" class="header-anchor">#</a> 文章链接</h2> <p><a href="https://blog.csdn.net/zhangshenghang/article/details/123330462" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/zhangshenghang/article/details/123330462<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="一、概述"><a href="#一、概述" class="header-anchor">#</a> 一、概述</h2> <h3 id="_1-1-kylin定义"><a href="#_1-1-kylin定义" class="header-anchor">#</a> 1.1 Kylin定义</h3> <p>​		Apache Kylin™是一个开源的、分布式的分析型数据仓库，提供Hadoop/Spark 之上的 SQL 查询接口及多维分析（OLAP）能力以支持超大规模数据，最初由 eBay 开发并贡献至开源社区。它能在亚秒内查询巨大的表。</p> <h3 id="_1-2-kylin架构"><a href="#_1-2-kylin架构" class="header-anchor">#</a> 1.2 Kylin架构</h3> <p><img src="Kylin.assets/image-20220305101436545.png" alt="image-20220305101436545"></p> <ol><li><p>REST Service</p> <p>​		REST Server 是一套面向应用程序开发的入口点，旨在实现针对 Kylin 平台的应用开发</p> <p>工作。 此类应用程序可以提供查询、获取结果、触发 cube 构建任务、获取元数据以及获取</p> <p>用户权限等等。另外可以通过 Restful 接口实现 SQL 查询。</p></li> <li><p>查询引擎（Query Engine）</p> <p>​		当 cube 准备就绪后，查询引擎就能够获取并解析用户查询。它随后会与系统中的其它</p> <p>组件进行交互，从而向用户返回对应的结果。</p></li> <li><p>路由器（Routing）</p> <p>​		在最初设计时曾考虑过将 Kylin 不能执行的查询引导去 Hive 中继续执行，但在实践后</p> <p>发现 Hive 与 Kylin 的速度差异过大，导致用户无法对查询的速度有一致的期望，很可能大</p> <p>多数查询几秒内就返回结果了，而有些查询则要等几分钟到几十分钟，因此体验非常糟糕。</p> <p>最后这个路由功能在发行版中默认关闭。</p></li> <li><p>元数据管理工具（Metadata）</p> <p>​		Kylin 是一款元数据驱动型应用程序。元数据管理工具是一大关键性组件，用于对保存</p> <p>在 Kylin 当中的所有元数据进行管理，其中包括最为重要的 cube 元数据。其它全部组件的</p> <p>正常运作都需以元数据管理工具为基础。 Kylin 的元数据存储在 hbase （3.x版本）中。</p></li> <li><p>任务引擎（Cube Build Engine）</p> <p>​		这套引擎的设计目的在于处理所有离线任务，其中包括 shell 脚本、Java API 以及 Map</p> <p>Reduce 任务等等。任务引擎对 Kylin 当中的全部任务加以管理与协调，从而确保每一项任务</p> <p>都能得到切实执行并解决其间出现的故障。</p></li></ol> <h3 id="_1-3-kylin特点"><a href="#_1-3-kylin特点" class="header-anchor">#</a> 1.3 Kylin特点</h3> <p>​		Kylin 的主要特点包括支持 SQL 接口、支持超大规模数据集、亚秒级响应、可伸缩性、</p> <p>高吞吐率、BI 工具集成等。</p> <ol><li><p><font>标准 SQL 接口</font>：Kylin 是以标准的 SQL 作为对外服务的接口。</p></li> <li><p><font>支持超大数据集</font>：Kylin 对于大数据的支撑能力可能是目前所有技术中最为领先的。</p> <p>早在 2015 年 eBay 的生产环境中就能支持百亿记录的秒级查询，之后在移动的应用场景中</p> <p>又有了千亿记录秒级查询的案例。</p></li> <li><p><font>亚秒级响应</font>：Kylin 拥有优异的查询相应速度，这点得益于预计算，很多复杂的计算，</p> <p>比如连接、聚合，在离线的预计算过程中就已经完成，这大大降低了查询时刻所需的计算量，</p> <p>提高了响应速度。</p></li> <li><p><font>可伸缩性和高吞吐率</font>：单节点 Kylin 可实现每秒 70 个查询，还可以搭建 Kylin 的集</p> <p>群。</p></li> <li><p><font>BI 工具集成</font>:</p> <p>Kylin 可以与现有的 BI 工具集成，具体包括如下内容。</p> <p>ODBC：与 Tableau、Excel、PowerBI 等工具集成</p> <p>JDBC：与 Saiku、BIRT 等 Java 工具集成</p> <p>RestAPI：与 JavaScript、Web 网页集成</p> <p>Kylin 开发团队还贡献了 <strong>Zepplin</strong> 的插件，也可以使用 Zepplin 来访问 Kylin 服务。</p></li></ol> <h3 id="_1-4-apache-kylin4-概述"><a href="#_1-4-apache-kylin4-概述" class="header-anchor">#</a> 1.4 Apache Kylin4 概述</h3> <p>​		Apache Kylin™是一个开源的、分布式的分析型数据仓库，提供 Hadoop 之上的 SQL 查询接口及多维分析（OLAP）能力以支持超大规模数据，最初由eBay Inc.开发并贡献至开源社区。</p> <p>​		Apache Kylin4.0 是 Apache Kylin3.x 之后一次重大的版本更新，它采用了全新的 <strong>Spark 构建引擎和 Parquet 作为存储</strong>，同时使用 Spark 作为查询引擎。</p> <p>为了方便用户对 Kylin4.x 有更全面更深层的了解，本篇文档会着重从 Kylin4.x 与之前版本有何异同的角度对 Kylin4.x 做全面概述。文章分为以下几个部分：</p> <ul><li>为什么选择 Parquet 替换 HBase</li> <li>预计算结果在 Kylin4.0 中如何存储</li> <li>Kylin 4.0 的构建引擎</li> <li>Kylin 4.0 的查询引擎</li> <li>Kylin4.0 与 Kylin3.1 功能对比</li> <li>Kylin 4.0 性能表现</li> <li>Kylin 4.0 查询和构建调优</li> <li>Kylin 4.0 用户案例</li></ul> <h4 id="为什么选择-parquet-替换-hbase"><a href="#为什么选择-parquet-替换-hbase" class="header-anchor">#</a> 为什么选择 Parquet 替换 HBase?</h4> <p>​	在 3.x 以及之前的版本中，kylin 一直使用 HBase 作为存储引擎来保存 cube 构建后产生的预计算结果。HBase 作为 HDFS 之上面向列族的数据库，查询表现已经算是比较优秀，但是它仍然存在以下几个缺点：</p> <ol><li><p>HBase 不是真正的列式存储；</p> <blockquote><p>HBase表数据模型比较特别，也可以简单理解为有行和列的二维表，只是它的列称为“列族”，列族下面又可以在数据写入时指定很多的子列。另外，HBase物理存储上是将整个列族数据存储在一起的。所以，如果HBase中的一张表只有一个列族的话，等于是这个列族包含了这张表的所有列，也就是将表正行的数据连续存储在了一起，就等于是行式存储了。再比如，一张表有多个列族，并且每个列族下仅有一列（虽然HBase不建议这么做），也就是将表的列数据连续存储在了一起，就等于是列式存储了。</p></blockquote></li> <li><p>HBase 没有二级索引，Rowkey 是它唯一的索引；</p></li> <li><p>HBase 没有对存储的数据进行编码，kylin 必须自己进行对数据编码的过程；</p></li> <li><p>HBase 不适合云上部署和自动伸缩；</p></li> <li><p>HBase 不同版本之间的 API 版本不同，存在兼容性问题（比如，0.98，1.0，1.1，2.0）；</p></li> <li><p>HBase 存在不同的供应商版本，他们之间有兼容性问题。</p></li></ol> <p>​</p> <p>针对以上问题，社区提出了对使用 Apache Parquet + Spark 来代替 HBase 的提议，理由如下：</p> <ol><li>Parquet 是一种开源并且已经成熟稳定的列式存储格式；</li> <li>Parquet 对云更加友好，可以兼容各种文件系统，包括 HDFS、S3、Azure Blob store、Ali OSS 等</li> <li>Parquet 可以很好地与 Hadoop、Hive、Spark、Impala 等集成；</li> <li>Parquet 支持自定义索引。</li></ol> <h4 id="预计算结果在-kylin4-0-中如何存储"><a href="#预计算结果在-kylin4-0-中如何存储" class="header-anchor">#</a> 预计算结果在 Kylin4.0 中如何存储?</h4> <p>​		在 Kylin4.x 中，预计算结果以 Parquet 格式存储在文件系统中，文件存储结构对于 I/O 优化很重要，提前对存储目录结构进行设计，就能够在查询时通过目录或者文件名过滤数据文件，避免不必要的扫描。</p> <p>Kylin4 对 cube 进行构建得到的预计算结果的 Parquet 文件在文件系统中存储的目录结构如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- cube_name
- SegmentA
- Cuboid-111
- part-0000-XXX.snappy.parquet
- part-0001-XXX.snappy.parquet
- …
- Cuboid-222
- part-0000-XXX.snappy.parquet
- part-0001-XXX.snappy.parquet
- …
- SegmentB
- Cuboid-111
- part-0000-XXX.snappy.parquet
- part-0001-XXX.snappy.parquet
- …
- Cuboid-222
- part-0000-XXX.snappy.parquet
- part-0001-XXX.snappy.parquet
- …
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>可以看出，与 HBase 相比，采用 Parquet 存储可以很方便地增删 cuboid 而不影响其他数据。利用这种特点，Kylin4 中实现了支持用户手动增删 cuboid 的功能，请参考：<a href="https://cwiki.apache.org/confluence/display/KYLIN/How+to+update+cuboid+list+for+a+cube" target="_blank" rel="noopener noreferrer">How to update cuboid list for a cube<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="kylin-4-0-的构建引擎"><a href="#kylin-4-0-的构建引擎" class="header-anchor">#</a> Kylin 4.0 的构建引擎</h4> <p>在 Kylin4 中，Spark Engine 是唯一的构建引擎，与之前版本中的构建引擎相比，存在如下特点：</p> <ol><li>Kylin4 的构建简化了很多步骤。比如在 Cube Build Job 中， kylin4 只需要资源探测和 cubing 两个步骤，就可以完成构建；</li> <li>由于 Parquet 会对存储的数据进行编码，所以在 kylin4 中不再需要维度字典和对维度列编码的过程；</li> <li>Kylin4 对全局字典做了全新的实现，更多细节请参考：<a href="https://cwiki.apache.org/confluence/display/KYLIN/Global+Dictionary+on+Spark+CN" target="_blank" rel="noopener noreferrer">Kylin4 全局字典<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ；</li> <li>Kylin4 会根据集群资源、构建任务情况等对 Spark 进行自动调参；</li> <li>Kylin4 提高了构建速度。</li></ol> <p>用户可以通过 <code>kylin.build.spark-conf</code> 开头的配置项手动修改构建相关的 Spark 配置，经过用户手动修改的 Spark 配置项不会再参与自动调参。</p> <h4 id="kylin-4-0-的查询引擎"><a href="#kylin-4-0-的查询引擎" class="header-anchor">#</a> Kylin 4.0 的查询引擎</h4> <p>Kylin4 的查询引擎 <code>Sparder(SparderContext)</code> 是由 spark application 后端实现的新型分布式查询引擎，相比于原来的查询引擎，Sparder 的优势体现在以下几点：
- 分布式的查询引擎，有效避免单点故障；
- 与构建所使用的计算引擎统一为 Spark；
- 对于复杂查询的性能有很大提高；
- 可以从 Spark 的新功能及其生态中获益。</p> <p>在 Kylin4 中，Sparder 是作为一个 long-running 的 spark application 存在的。 Sparder 会根据 <code>kylin.query.spark-conf</code> 开头的配置项中配置的 Spark 参数来获取 Yarn 资源，如果配置的资源参数过大，可能会影响构建任务甚至无法成功启动 Sparder，如果 Sparder 没有成功启动，则所有查询任务都会失败，用户可以在 kylin WebUI 的 System 页面中检查 Sparder 状态。</p> <p>默认情况下，用于查询的 spark 参数会设置的比较小，在生产环境中，大家可以适当把这些参数调大一些，以提升查询性能。
<code>kylin.query.auto-sparder-context</code> 参数用于控制是否在启动 kylin 的同时启动 Sparder，默认值为 false，即默认情况下会在执行第一条 SQL 的时候才启动 Sparder，由于这个原因，执行第一条 SQL 的时候的会花费较长时间。
如果你不希望第一条 SQL 的查询速度低于预期，可以设置 <code>kylin.query.auto-sparder-context</code> 为 <code>true</code>，此时 Sparder 会随 Kylin 一起启动。</p> <h4 id="kylin-4-0-与-kylin-3-1-功能对比"><a href="#kylin-4-0-与-kylin-3-1-功能对比" class="header-anchor">#</a> Kylin 4.0 与 Kylin 3.1 功能对比</h4> <table><thead><tr><th style="text-align:center;">Feature</th> <th style="text-align:left;">Kylin 3.1.0</th> <th style="text-align:left;">Kylin 4.0</th></tr></thead> <tbody><tr><td style="text-align:center;">Storage</td> <td style="text-align:left;">HBase</td> <td style="text-align:left;">Parquet</td></tr> <tr><td style="text-align:center;">BuildEngine</td> <td style="text-align:left;">MapReduce/Spark/Flink</td> <td style="text-align:left;">New Spark Engine</td></tr> <tr><td style="text-align:center;">Metastore</td> <td style="text-align:left;">HBase(Default)/Mysql</td> <td style="text-align:left;">Mysql(Default)</td></tr> <tr><td style="text-align:center;">DataSource</td> <td style="text-align:left;">Kafka/Hive/JDBC</td> <td style="text-align:left;">Hive/CSV</td></tr> <tr><td style="text-align:center;">Global Dictionary</td> <td style="text-align:left;">Two implementation</td> <td style="text-align:left;">New implementation</td></tr> <tr><td style="text-align:center;">Cube Optimization Tool</td> <td style="text-align:left;">Cube Planner</td> <td style="text-align:left;">Cube Planner phase1 and Optimize cube manually</td></tr> <tr><td style="text-align:center;">Self-monitoring</td> <td style="text-align:left;">System cube and Dashboard</td> <td style="text-align:left;">System cube and Dashboard</td></tr> <tr><td style="text-align:center;">PushDown Engine</td> <td style="text-align:left;">Hive/JDBC</td> <td style="text-align:left;">Spark SQL</td></tr> <tr><td style="text-align:center;">Hadoop platform</td> <td style="text-align:left;">HDP2/HDP3/CDH5/CDH6/EMR5</td> <td style="text-align:left;">HDP2/CDH5/CDH6/EMR5/EMR6/HDI</td></tr> <tr><td style="text-align:center;">Deployment mode</td> <td style="text-align:left;">Single node/Cluster/Read and write separation</td> <td style="text-align:left;">Single node/Cluster/Read and write separation</td></tr></tbody></table> <h4 id="kylin-4-0-性能表现"><a href="#kylin-4-0-性能表现" class="header-anchor">#</a> Kylin 4.0 性能表现</h4> <p>为了测试 Kylin4.0 的性能，我们分别在 SSB 数据集和 TPC-H 数据集上做了 benchmark，与 Kylin3.1.0 进行对比。测试环境为 4 个节点的 CDH 集群，所使用的 yarn 队列分配了 400G 内存和 128 cpu cores。</p> <blockquote><p><strong>SSB</strong>（Star Schema Benchmark）是麻省州立大学波士顿校区的研究人员定义的基于现实商业应用的数据模型，用来评价决策支持技术方面应用的性能。</p></blockquote> <blockquote><p><strong>TPC-H</strong>是由TPC(Transaction Processing Performance Council)事务处理性能委员会公布的一套针对数据库决策支持能力的测试基准，通过模拟数据库中与业务相关的复杂查询考察数据库的综合处理能力，获取数据库操作的响应时间。</p> <p>TPCH基准模型中定义了一个数据库模型，容量可以在1GB~10000GB的8个级别中进行选择。数据库模型包括CUSTOMER、LINEITEM、NATION、ORDERS、PART、PARTSUPP、REGION和SUPPLIER 共8张数据表，以及22条SQL查询语句，涉及内容广泛丰富，可以较完整地测试数据库的运算性能。</p> <p>TPCH的SQL中不乏一些多层嵌套的复杂查询，执行性能较差。对于这些查询，如果能采用更合理的存储方案，设计低复杂度算法并配合并行等手段，将获得更优的性能。但遗憾的是，由于理论体系的限制，很多想法无法用SQL实现，而SQL程序员也因此不关注这些性能优化方法，经常只能忍受数据库的低速运算。</p> <p>TPC-H 下载：https://github.com/gregrahn/</p></blockquote> <p>性能测试对比结果如下：
<strong>Comparison of build duration and result size（SSB）</strong></p> <p><img src="Kylin.assets/image-20220305104450037.png" alt="image-20220305104450037"></p> <p><img src="Kylin.assets/image-20220305104511887.png" alt="image-20220305104511887"></p> <p>测试结果可以体现以下两点：</p> <ul><li>kylin4 的构建速度与 kylin3.1.0 的 Spark Engine 相比有明显提升；</li> <li>Kylin4 构建后得到的预计算结果 Parquet 文件大小与 HBase 相比有明显减小；</li></ul> <p><strong>Comparison of query response(SSB and TPC-H)</strong></p> <p><img src="Kylin.assets/image-20220305105210120.png" alt="image-20220305105210120"></p> <p><img src="Kylin.assets/image-20220305105321954.png" alt="image-20220305105321954"></p> <p>​		从查询结果对比中可以看出，对于<strong>简单查询</strong>，kylin3 与 Kylin4 不相上下，kylin4 略有不足；而对于<strong>复杂查询</strong>，kylin4 则体现出了明显的优势，查询速度比 kylin3 快很多。
​		并且，Kylin4 中的<strong>简单查询</strong>的性能还存在很大的优化空间。在有赞使用 Kylin4 的实践中，对于<strong>简单查询</strong>的性能可以优化到 1 秒以内。</p> <h4 id="如何升级"><a href="#如何升级" class="header-anchor">#</a> 如何升级</h4> <p>请参考文档：<a href="https://cwiki.apache.org/confluence/display/KYLIN/How+to+migrate+metadata+to+Kylin+4" target="_blank" rel="noopener noreferrer">How to migrate metadata to Kylin4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="kylin-4-0-查询和构建调优"><a href="#kylin-4-0-查询和构建调优" class="header-anchor">#</a> Kylin 4.0 查询和构建调优</h4> <p>对于 Kylin4 的调优，请参考：<a href="https://kylin.apache.org/docs/howto/howto_optimize_build_and_query.html" target="_blank" rel="noopener noreferrer">How to improve cube building and query performance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="kylin-4-0-用户案例"><a href="#kylin-4-0-用户案例" class="header-anchor">#</a> Kylin 4.0 用户案例</h4> <p><a href="https://kylin.apache.org/blog/2021/06/17/Why-did-Youzan-choose-Kylin4" target="_blank" rel="noopener noreferrer">Why did Youzan choose Kylin4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>参考链接：
<a href="https://cwiki.apache.org/confluence/display/KYLIN/KIP-1%3A+Parquet+storage" target="_blank" rel="noopener noreferrer">Kylin Improvement Proposal 1: Parquet Storage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="二、kylin环境搭建-4-x"><a href="#二、kylin环境搭建-4-x" class="header-anchor">#</a> 二、Kylin环境搭建（4.x）</h2> <h3 id="软件要求"><a href="#软件要求" class="header-anchor">#</a> 软件要求</h3> <ul><li>Hadoop: cdh5.x, cdh6.x, hdp2.x, EMR5.x, EMR6.x, HDI4.x</li> <li>Hive: 0.13 - 1.2.1+</li> <li>Spark: 2.4.7/3.1.1</li> <li>Mysql: 5.1.17 及以上</li> <li>JDK: 1.8+</li> <li>OS: Linux only, CentOS 6.5+ or Ubuntu 16.0.4+</li></ul> <p>在 Hortonworks HDP2.4, Cloudera CDH 5.7 and 6.3.2, AWS EMR 5.31 and 6.0, Azure HDInsight 4.0 上测试通过。</p> <p>我们建议您使用集成的 sandbox 来试用 Kylin 或进行开发，比如 <a href="http://hortonworks.com/products/hortonworks-sandbox/" target="_blank" rel="noopener noreferrer">HDP sandbox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，且要保证其有至少 10 GB 内存。在配置沙箱时，我们推荐您使用 Bridged Adapter 模型替代 NAT 模型。</p> <h3 id="硬件要求"><a href="#硬件要求" class="header-anchor">#</a> 硬件要求</h3> <p>​	运行 Kylin 的服务器的最低配置为 4 core CPU，16 GB 内存和 100 GB 磁盘。 对于高负载的场景，建议使用 24 core CPU，64 GB 内存或更高的配置。</p> <h3 id="hadoop-环境"><a href="#hadoop-环境" class="header-anchor">#</a> Hadoop 环境</h3> <p>​		Kylin 依赖于 Hadoop 集群处理大量的数据集。您需要准备一个配置好 <code>HDFS, YARN, Hive, Zookeeper, Spark</code>以及你可能需要的其他服务的 Hadoop 集群供 Kylin 运行。</p> <p>​		Kylin <strong>可以在 Hadoop 集群的任意节点上启动</strong>。方便起见，您可以在 master 节点上运行 Kylin。但为了更好的稳定性，我们<strong>建议您将 Kylin 部署在一个干净的 Hadoop client 节点</strong>上，该节点上 Hive，HDFS 等命令行已安装好且 client 配置（如 <code>core-site.xml</code>，<code>hive-site.xml</code>及其他）也已经合理的配置且其可以自动和其它节点同步。</p> <p>​	运行 Kylin 的 Linux 账户要有访问 Hadoop 集群的权限，包括创建/写入 HDFS 文件夹，Hive 表的权限。</p> <h3 id="kylin-安装"><a href="#kylin-安装" class="header-anchor">#</a> Kylin 安装</h3> <div class="language- extra-class"><pre><code>	安装 Kylin 前需先部署好 Hadoop、Hive、Zookeeper、Hbase、Spark，并且需要在/etc/profile
</code></pre></div><p>中配置以下环境变量 HADOOP_HOME，HIVE_HOME，HBASE_HOME，SPARK_HOME 记</p> <p>得 source 使其生效。</p> <p><strong>在我们需要安装的服务器执行以下操作：</strong></p> <ol><li><p>从 <a href="https://kylin.apache.org/download/" target="_blank" rel="noopener noreferrer">Apache Kylin下载网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 下载一个 Apache Kylin 4.0 的二进制文件。可通过如下命令行下载得到：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /usr/local/
<span class="token function">wget</span> --no-check-certificate https://dlcdn.apache.org/kylin/apache-kylin-4.0.1/apache-kylin-4.0.1-bin-spark2.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>解压 tar 包，配置环境变量 <code>$KYLIN_HOME</code> 指向 Kylin 文件夹。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apache-kylin-4.0.1-bin-spark2.tar.gz 
<span class="token function">mv</span> apache-kylin-4.0.1-bin-spark2 kylin
<span class="token builtin class-name">cd</span> kylin
<span class="token builtin class-name">export</span> <span class="token assign-left variable">KYLIN_HOME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>使用脚本下载spark</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">$KYLIN_HOME</span>/bin/download-spark.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>download-spark.sh 脚本只能下载 spark2.4.7, 如果您使用的 kylin 二进制包以 spark3 为后缀，您需要从<a href="https://spark.apache.org/" target="_blank" rel="noopener noreferrer">Spark 官方网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载 spark3.1.1 的二进制包。</p> <p>建议将 spark 二进制包解压后放置在 ${KYLIN_HOME} 目录下，并重命名为 spark，以避免兼容性问题。详情请查看：<a href="https://cwiki.apache.org/confluence/display/KYLIN/KIP+10+refactor+hive+and+hadoop+dependency" target="_blank" rel="noopener noreferrer">Refactor hive and hadoop dependency<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>如果您自定义配置了 ${SPARK_HOME} 指向环境中的 spark2.4.7/spark3.1.1，请保证环境中的 spark 是可以正常提交以及执行任务的。</p></li> <li><p>配置 Mysql 元数据</p> <p>创建数据库：kylin</p> <p>Kylin 4.0 使用 Mysql 作为元数据存储，需要在 kylin.properties 中做如下配置：</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">kylin.metadata.url</span><span class="token punctuation">=</span><span class="token value attr-value">kylin_metadata@jdbc,driverClassName=com.mysql.jdbc.Driver,url=jdbc:mysql://192.168.60.10:3306/kylin,username=root,password=123456</span>
<span class="token key attr-name">kylin.env.zookeeper-connect-string</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.60.13</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>你需要修改其中的 Mysql 用户名和密码，以及存储元数据的 database 和 table。并将 mysql jdbc connector <code>mysql-connector-java-5.1.49.jar</code>放在 <code>$KYLIN_HOME/ext</code> 目录下，没有该目录时请自行创建。
请参考 <a href="https://kylin.apache.org/cn/docs/tutorial/mysql_metastore.html" target="_blank" rel="noopener noreferrer">配置 Mysql 为 Metastore<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 了解 Mysql 作为 Metastore 的详细配置。</p></li> <li><p>CDH6.x环境配置</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 下载需要的jar包</span>
<span class="token function">wget</span> https://cwiki.apache.org/confluence/download/attachments/173081375/hive-exec-1.21.2.3.1.0.0-78.jar?api<span class="token operator">=</span>v2
<span class="token function">wget</span> https://repo1.maven.org/maven2/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar
<span class="token function">wget</span> https://repo1.maven.org/maven2/commons-configuration/commons-configuration/1.10/commons-configuration-1.10.jar

<span class="token comment"># 进入Kylin目录</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$KYLIN_HOME</span>

<span class="token comment"># 将准备的jar包放进目录bin/hadoop3_jars/cdh6下</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> bin/hadoop3_jars/cdh6
<span class="token function">mv</span> hive-exec-1.21.2.3.1.0.0-78.jar stax2-api-3.1.4.jar commons-configuration-1.10.jar kylin/bin/hadoop3_jars/cdh6/

<span class="token comment"># 将Mysql JDBC 驱动放入指定目录 ext 下</span>
<span class="token function">mkdir</span> <span class="token variable">$KYLIN_HOME</span>/ext
<span class="token function">mv</span> mysql-connector-java-5.7.33.jar <span class="token variable">$KYLIN_HOME</span>/ext

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li><p>检查运行环境</p> <p>Kylin 运行在 Hadoop 集群上，对各个组件的版本、访问权限及 CLASSPATH 等都有一定的要求，为了避免遇到各种环境问题，您可以运行 <code>$KYLIN_HOME/bin/check-env.sh</code> 脚本来进行环境检测，如果您的环境存在任何的问题，脚本将打印出详细报错信息。如果没有报错信息，代表您的环境适合 Kylin 运行。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 切换到HDFS用户执行检查</span>
<span class="token punctuation">[</span>hdfs@r-wb-15 bin<span class="token punctuation">]</span>$ ./check-env.sh 
Retrieving hadoop conf dir<span class="token punctuation">..</span>.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
KYLIN_HOME is <span class="token builtin class-name">set</span> to /home/kylin
Checking hive
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
Checking hadoop shell
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
Checking hdfs working <span class="token function">dir</span>
WARNING: log4j.properties is not found. HADOOP_CONF_DIR may be incomplete.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
WARNING: log4j.properties is not found. HADOOP_CONF_DIR may be incomplete.
WARNING: log4j.properties is not found. HADOOP_CONF_DIR may be incomplete.
Checking environment finished successfully. To check again, run <span class="token string">'bin/check-env.sh'</span> manually.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>启动Kylin</p> <p>运行 <code>$KYLIN_HOME/bin/kylin.sh start</code> 脚本来启动 Kylin，界面输出如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>hdfs@r-wb-15 kylin<span class="token punctuation">]</span>$ bin/kylin.sh start
Retrieving hadoop conf dir<span class="token punctuation">..</span>.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
KYLIN_HOME is <span class="token builtin class-name">set</span> to /home/kylin
Checking hive
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
Checking hadoop shell
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
Checking hdfs working <span class="token function">dir</span>
WARNING: log4j.properties is not found. HADOOP_CONF_DIR may be incomplete.
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token punctuation">[</span>PASS<span class="token punctuation">]</span>
WARNING: log4j.properties is not found. HADOOP_CONF_DIR may be incomplete.
WARNING: log4j.properties is not found. HADOOP_CONF_DIR may be incomplete.

Checking environment finished successfully. To check again, run <span class="token string">'bin/check-env.sh'</span> manually.
Retrieving hadoop conf dir<span class="token punctuation">..</span>.
Retrieving Spark dependency<span class="token punctuation">..</span>.
Start replace hadoop jars under /home/kylin/spark/jars.
Find platform specific jars:/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop/client/hadoop-annotations-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop/client/hadoop-auth-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop/client/hadoop-common-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop/hadoop-annotations-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop/hadoop-common-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop/hadoop-auth-3.0.0-cdh6.3.2.jar /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-client.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-httpfs.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-native-client.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-native-client-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-httpfs-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-hdfs/hadoop-hdfs-client-3.0.0-cdh6.3.2.jar /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/hadoop-mapreduce-client-app-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/hadoop-mapreduce-client-core-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/hadoop-mapreduce-client-jobclient-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/hadoop-mapreduce-client-shuffle-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/hadoop-mapreduce-client-common-3.0.0-cdh6.3.2.jar /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-yarn/hadoop-yarn-common-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-yarn/hadoop-yarn-api-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-yarn/hadoop-yarn-server-web-proxy-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-yarn/hadoop-yarn-client-3.0.0-cdh6.3.2.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/hadoop-yarn/hadoop-yarn-server-common-3.0.0-cdh6.3.2.jar /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/htrace-core4-4.2.0-incubating.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/htrace-core4-4.1.0-incubating.jar /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/woodstox-core-5.0.3.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/woodstox-core-5.1.0.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/commons-configuration2-2.1.1.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/woodstox-core-asl-4.4.1.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/re2j-1.1.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/commons-configuration2-2.1.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/stax2-api-3.1.4.jar
/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/jars/re2j-1.0.jar  , will replace with these jars under /home/kylin/spark/jars.
Copy jars from /home/kylin/bin/hadoop3_jars/cdh6
Done hadoop jars replacement under /home/kylin/spark/jars.
<span class="token punctuation">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span class="token punctuation">)</span>
Start to check whether we need to migrate acl tables
Not HBase metadata. Skip check.

A new Kylin instance is started by hdfs. To stop it, run <span class="token string">'kylin.sh stop'</span>
Check the log at /home/kylin/logs/kylin.log
Web UI is at http://r-wb-15:7070/kylin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p>启动成功可以访问页面：http://r-wb-15:7070/kylin</p> <p>默认账号密码（注意大小写区分）：ADMIN/KYLIN</p> <p>访问页面提示以下页面，说明启动成功。</p> <p><img src="Kylin.assets/image-20220305153701929.png" alt="image-20220305153701929"></p></li> <li><p>Kylin目录结构·</p> <ul><li><code>bin</code>: shell 脚本，用于启动／停止 Kylin，备份／恢复 Kylin 元数据，以及一些检查端口、获取 Hive/HBase 依赖的方法等；</li> <li><code>conf</code>: Hadoop 任务的 XML 配置文件，这些文件的作用可参考<a href="https://kylin.apache.org/docs/install/configuration.html" target="_blank" rel="noopener noreferrer">配置页面<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>lib</code>: 供外面应用使用的 jar 文件，例如 Hadoop 任务 jar.</li> <li><code>meta_backups</code>: 执行 <code>bin/metastore.sh backup</code> 后的默认的备份目录;</li> <li><code>sample_cube</code> 用于创建样例 Cube 和表的文件。</li> <li><code>spark</code>: 使用kylin脚本下载得到的 spark。</li> <li><code>tomcat</code>: 自带的 tomcat，用于启动 Kylin 服务。</li> <li><code>tool</code>: 用于执行一些命令行的jar文件。</li></ul></li> <li><p>使用 Kylin</p> <p>Kylin 启动后您可以通过浏览器 <code>http://&lt;hostname&gt;:7070/kylin</code> 进行访问。
其中 <code>&lt;hostname&gt;</code> 为具体的机器名、IP 地址或域名，默认端口为 7070。
初始用户名和密码是 <code>ADMIN/KYLIN</code>。
服务器启动后，您可以通过查看 <code>$KYLIN_HOME/logs/kylin.log</code> 获得运行时日志。</p></li> <li><p>停止 Kylin</p> <p>运行 <code>$KYLIN_HOME/bin/kylin.sh stop</code> 脚本来停止 Kylin，界面输出如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Retrieving hadoop conf dir...
KYLIN_HOME is set to /usr/local/apache-kylin-4.0.0-bin
Stopping Kylin: 25964
Stopping in progress. Will check after 2 secs again...
Kylin with pid 25964 has been stopped.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>您可以运行 <code>ps -ef | grep kylin</code> 来查看 Kylin 进程是否已停止。</p></li> <li><p>HDFS 目录结构</p> <p>​		Kylin 会在 HDFS 上生成文件，默认根目录是 “/kylin/”, 然后会使用 Kylin 集群的元数据表名作为第二层目录名，默认为 “kylin_metadata” (可以在<code>conf/kylin.properties</code>中定制).</p> <p>通常, <code>/kylin/kylin_metadata</code> 目录下按照不同的 project 存放数据，比如 learn_kylin 项目的数据目录为 <code>/kylin/kylin_metadata/learn_kylin</code>, 该目录下通常包括以下子目录：
1.<code>job_tmp</code>: 存放执行任务过程中生成的临时文件。
2.<code>parquet</code>: 存放各个 cube 的 cuboid 文件。
3.<code>table_snapshot</code>: 存放维度表快照。</p> <div class="language- extra-class"><pre><code>## 三、使用教程
</code></pre></div></li></ol> <h3 id="提前准备"><a href="#提前准备" class="header-anchor">#</a> 提前准备</h3> <p>将数据写入<code>Hive</code>表中，供测试使用</p> <ul><li>创建hive表</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> site_base_hive
<span class="token punctuation">(</span>
  id string<span class="token punctuation">,</span>
  site_code string<span class="token punctuation">,</span>
  site_name string<span class="token punctuation">,</span>
  audit_code string<span class="token punctuation">,</span>
  culture_code string<span class="token punctuation">,</span>
  licence_code string<span class="token punctuation">,</span>
  webopen_date string<span class="token punctuation">,</span>
  licence_date string<span class="token punctuation">,</span>
  fire_code string<span class="token punctuation">,</span>
  business_status <span class="token keyword">int</span><span class="token punctuation">,</span>
  stop_business_date string<span class="token punctuation">,</span>
  licence_status <span class="token keyword">int</span><span class="token punctuation">,</span>
  install_status <span class="token keyword">int</span><span class="token punctuation">,</span>
  area_code string<span class="token punctuation">,</span>
  police_station string<span class="token punctuation">,</span>
  address string<span class="token punctuation">,</span>
  class_level string<span class="token punctuation">,</span>
  access_operator string<span class="token punctuation">,</span>
  legal_person string<span class="token punctuation">,</span>
  legal_phone string<span class="token punctuation">,</span>
  principal string<span class="token punctuation">,</span>
  principal_phone string<span class="token punctuation">,</span>
  webmaster string<span class="token punctuation">,</span>
  webmaster_phone string<span class="token punctuation">,</span>
  audit_vendor string<span class="token punctuation">,</span>
  charge_system string<span class="token punctuation">,</span>
  charge_sys_version string<span class="token punctuation">,</span>
  longitude <span class="token keyword">float</span><span class="token punctuation">,</span>
  latitude <span class="token keyword">float</span><span class="token punctuation">,</span>
  altitude <span class="token keyword">float</span><span class="token punctuation">,</span>
  safety_num string<span class="token punctuation">,</span>
  ba_terminal_num <span class="token keyword">int</span><span class="token punctuation">,</span>
  area_size <span class="token keyword">float</span><span class="token punctuation">,</span>
  is_chain <span class="token keyword">int</span><span class="token punctuation">,</span>
  del_flag string<span class="token punctuation">,</span>
  creator_by string<span class="token punctuation">,</span>
  create_time string<span class="token punctuation">,</span>
  updator_by string<span class="token punctuation">,</span>
  update_time string<span class="token punctuation">,</span>
  site_name_qp string<span class="token punctuation">,</span>
  site_name_jp string<span class="token punctuation">,</span>
  legal_person_qp string<span class="token punctuation">,</span>
  legal_person_jp string
<span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> offline_hive
<span class="token punctuation">(</span>
id string<span class="token punctuation">,</span>
  checkin_code string<span class="token punctuation">,</span>
  checkin_type <span class="token keyword">int</span><span class="token punctuation">,</span>
  site_code string<span class="token punctuation">,</span>
  culture_code string<span class="token punctuation">,</span>
  site_name string<span class="token punctuation">,</span>
  area_code string<span class="token punctuation">,</span>
  area string<span class="token punctuation">,</span>
  credential_type string<span class="token punctuation">,</span>
  certificate_code string<span class="token punctuation">,</span>
  nation string<span class="token punctuation">,</span>
  name string<span class="token punctuation">,</span>
  sexcode string<span class="token punctuation">,</span>
  birthday string<span class="token punctuation">,</span>
  issuing_authority string<span class="token punctuation">,</span>
  certificate_valid string<span class="token punctuation">,</span>
  often_address string<span class="token punctuation">,</span>
  face_status string<span class="token punctuation">,</span>
  face_audit_result <span class="token keyword">int</span><span class="token punctuation">,</span>
  session_id string<span class="token punctuation">,</span>
  terminalid string<span class="token punctuation">,</span>
  terminalip string<span class="token punctuation">,</span>
  terminalname string<span class="token punctuation">,</span>
  onlinetime <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  offlinetime <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  mac_address string<span class="token punctuation">,</span>
  scene_photo string<span class="token punctuation">,</span>
  similarity <span class="token keyword">DECIMAL</span><span class="token punctuation">,</span>
  head_photo string<span class="token punctuation">,</span>
  is_upload <span class="token keyword">int</span><span class="token punctuation">,</span>
  card_type <span class="token keyword">int</span><span class="token punctuation">,</span>
  card_no string<span class="token punctuation">,</span>
  illegal_group_id string<span class="token punctuation">,</span>
  insert_time string<span class="token punctuation">,</span>
  update_time string<span class="token punctuation">,</span>
  data_source string
<span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><ul><li>从mysql导入数据到Hive</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>sqoop import \
--connect jdbc:mysql://192.168.60.10:3306/test_data \
--username root \
--password 123456 \
--table site_base \
--delete-target-dir \
--hive-import \
--hive-database test_data \
--hive-table site_base_hive \
--hive-overwrite \
--fields-terminated-by &quot;\t&quot; \
--as-parquetfile \
# parquet模式下当mysql字段类型与hive字段类型不相同时，需要手动指定导入的类型，否则会报错
--map-column-java webopen_date=String,licence_date=String,stop_business_date=String,create_time=String,update_time=String \
--map-column-hive webopen_date=String,licence_date=String,stop_business_date=String,create_time=String,update_time=String \
-m 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>sqoop import \
--connect jdbc:mysql://192.168.60.10:3306/test_data \
--username root \
--password 123456 \
--table offline \
--delete-target-dir \
--hive-import \
--hive-database test_data \
--hive-table offline_hive \
--hive-overwrite \
--fields-terminated-by &quot;\t&quot; \
--as-parquetfile \
--map-column-java insert_time=String,update_time=String \
--map-column-hive insert_time=String,update_time=String \
-m 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="web页面介绍"><a href="#web页面介绍" class="header-anchor">#</a> Web页面介绍</h3> <h4 id="支持的浏览器"><a href="#支持的浏览器" class="header-anchor">#</a> 支持的浏览器</h4> <p><strong>Windows</strong>: Google Chrome, FireFox</p> <p><strong>Mac</strong>: Google Chrome, FireFox, Safari</p> <h4 id="登录系统"><a href="#登录系统" class="header-anchor">#</a> 登录系统</h4> <p><img src="Kylin.assets/image-20220306122309990.png" alt="image-20220306122309990"></p> <h4 id="创建工程"><a href="#创建工程" class="header-anchor">#</a> 创建工程</h4> <ol><li><p>点击加号</p> <p><img src="Kylin.assets/image-20220306122354142.png" alt="image-20220306122354142"></p></li> <li><p>输入项目名称、项目描述，点击Submit提交</p> <p><img src="Kylin.assets/image-20220306122516833.png" alt="image-20220306122516833"></p></li> <li><p>创建成功</p></li></ol> <p><img src="Kylin.assets/image-20220306122631570.png" alt="image-20220306122631570"></p> <h4 id="选择数据源"><a href="#选择数据源" class="header-anchor">#</a> 选择数据源</h4> <p>​		虽然 Kylin 使用 SQL 作为查询接口并利用 Hive 元数据，Kylin 不会让用户查询所有的 hive 表，因为到目前为止它是一个预构建 OLAP(MOLAP) 系统。为了使表在 Kylin 中可用，使用 “Sync” 方法能够方便地从 Hive 中同步表。</p> <ol><li><p>选择加载数据源方式</p> <p><img src="Kylin.assets/image-20220306123010309.png" alt="image-20220306123010309"></p></li> <li><p>选择需要加载的表，点击<code>Sync</code><img src="Kylin.assets/image-20220306123331212.png" alt="image-20220306123331212"></p></li> <li><p>查看同步的数据源</p> <p><img src="Kylin.assets/image-20220306123457462.png" alt="image-20220306123457462"></p> <h4 id="创建model"><a href="#创建model" class="header-anchor">#</a> 创建Model</h4> <p>​		创建 cube 前，需定义一个数据模型。数据模型定义了一个星型（star schema）或雪花（snowflake schema）模型。一个模型可以被多个 cube 使用。</p></li> <li><p>点击顶部的 <code>Model</code> ，然后点击 <code>Models</code> 标签。点击 <code>+New</code> 按钮，在下拉框中选择 <code>New Model</code>。</p> <p><img src="Kylin.assets/image-20220306123632972.png" alt="image-20220306123632972"></p></li> <li><p>输入 model 的名字和可选的描述，点击<code>Next</code></p> <p><img src="Kylin.assets/image-20220306123728513.png" alt="image-20220306123728513"></p></li> <li><p>在 <code>Fact Table</code> 中，为模型选择事实表。</p> <p><img src="Kylin.assets/image-20220306123821978.png" alt="image-20220306123821978"></p></li> <li><p>【可选】点击 <code>Add Lookup Table</code> 按钮添加一个 lookup 表。选择表名和关联类型（内连接或左连接）</p> <p><img src="Kylin.assets/image-20220306124041026.png" alt="image-20220306124041026"></p> <p><img src="Kylin.assets/image-20220306124059331.png" alt="image-20220306124059331"></p></li> <li><p>点击 <code>New Join Condition</code> 按钮，左边选择事实表的外键，右边选择 lookup 表的主键。如果有多于一个 join 列重复执行。</p> <p><img src="Kylin.assets/image-20220306124133133.png" alt="image-20220306124133133"></p> <p><img src="Kylin.assets/image-20220306124233926.png" alt="image-20220306124233926"></p></li> <li><p>点击 “OK”，重复2，3步来添加更多的 lookup 表。完成后，点击 “Next”。</p> <p><img src="Kylin.assets/image-20220306124309612.png" alt="image-20220306124309612"></p> <p><img src="Kylin.assets/image-20220306124400237.png" alt="image-20220306124400237"></p></li> <li><p><code>Dimensions</code> 页面允许选择在子 cube 中用作维度的列(统计分析温度字段)，然后点击 <code>Columns</code> 列，在下拉框中选择需要的列。</p> <p><img src="Kylin.assets/image-20220306124924020.png" alt="image-20220306124924020"></p></li> <li><p>点击 “Next” 到达 “Measures” 页面，选择作为 measure 的列，其只能从事实表中选择。</p> <p>这里我没有选择，我只想统计数量，没有求和等其他操作</p> <p><img src="Kylin.assets/image-20220306125019251.png" alt="image-20220306125019251"></p></li> <li><p>点击 “Next” 到达 “Settings” 页面，如果事实表中的数据每日增长，选择 <code>Partition Date Column</code> 中相应的 日期列以及日期格式，否则就将其留白。</p></li> <li><p>【可选】选择是否需要 “time of the day” 列，默认情况下为 <code>No</code>。如果选择 <code>Yes</code>, 选择 <code>Partition Time Column</code> 中相应的 time 列以及 time 格式</p> <p><img src="Kylin.assets/image-20220306125257490.png" alt="image-20220306125257490"></p></li> <li><p>【可选】如果在从 hive 抽取数据时候想做一些筛选，可以在 <code>Filter</code> 中输入筛选条件。</p> <p><img src="Kylin.assets/image-20220306125318853.png" alt="image-20220306125318853"></p></li> <li><p>点击 <code>Save</code> 然后选择 <code>Yes</code> 来保存 data model。创建完成，data model 就会列在左边 <code>Models</code> 列表中。</p> <p><img src="Kylin.assets/image-20220306125347848.png" alt="image-20220306125347848"></p></li> <li><p>创建完成可以看到Models</p> <p><img src="Kylin.assets/image-20220306125438733.png" alt="image-20220306125438733"></p></li></ol> <h4 id="创建cube"><a href="#创建cube" class="header-anchor">#</a> 创建Cube</h4> <p>创建完 data model，可以开始创建 cube。</p> <ol><li><p>点击顶部 <code>Model</code>，然后点击 <code>Models</code> 标签。点击 <code>+New</code> 按钮，在下拉框中选择 <code>New Cube</code>。</p> <p><img src="Kylin.assets/image-20220306130114478.png" alt="image-20220306130114478"></p></li> <li><p>填写<strong>Cube 信息</strong>，选择 data model，输入 cube 名字；点击 <code>Next</code> 进行下一步</p> <p>cube 名字可以使用字母，数字和下划线（空格不允许）。<code>Notification Email List</code> 是运用来通知job执行成功或失败情况的邮箱列表。<code>Notification Events</code> 是触发事件的状态。</p> <p><img src="Kylin.assets/image-20220306130310919.png" alt="image-20220306130310919"></p></li> <li><p>添加维度</p> <blockquote><p>1.添加真正的维度字段(将来会影响 Cuboid 的个数,并且只能从 model 维度字段里面选择)</p> <p>2.后续统计条件字段只能从维度设置字段进行查询</p></blockquote> <p>点击<code>Add Dimension</code></p> <p><img src="Kylin.assets/image-20220306130403988.png" alt="image-20220306130403988"></p> <p>在弹窗中显示的事实表和 lookup 表里勾选输入需要的列。Lookup 表的列有2个选项：“Normal” 和 “Derived”（默认）。“Normal” 添加一个普通独立的维度列，“Derived” 添加一个 derived 维度，derived 维度不会计算入 cube，将由事实表的外键推算出。（推荐使用<code>Normal</code>）</p> <p><img src="Kylin.assets/image-20220306130604350.png" alt="image-20220306130604350"></p> <p><img src="Kylin.assets/image-20220306130611246.png" alt="image-20220306130611246"></p> <p><img src="Kylin.assets/image-20220306130704628.png" alt="image-20220306130704628"></p></li> <li><p>添加<code>度量</code>值</p> <p>点击 <code>+Measure</code> 按钮添加一个新的度量。</p> <p>​	<img src="Kylin.assets/image-20220306130757322.png" alt="image-20220306130757322"></p> <p>根据它的表达式共有7种不同类型的度量：<code>SUM</code>、<code>MAX</code>、<code>MIN</code>、<code>COUNT</code>、<code>COUNT_DISTINCT</code> <code>TOP_N</code> 和 <code>PERCENTILE</code>。请合理选择 <code>COUNT_DISTINCT</code> 和 <code>TOP_N</code> 返回类型，它与 cube 的大小相关。</p> <p><img src="Kylin.assets/image-20220306130838746.png" alt="image-20220306130838746"></p> <p>这里度量值默认有一个count(*)，其他的可自行选择。注意：这里的度量值只能从创建模型选择的字段中进行选择。</p></li> <li><p>更新配置</p> <p>这一步骤是为增量构建 cube 而设计的。</p> <p><code>Auto Merge Thresholds</code>: 自动合并小的 segments 到中等甚至更大的 segment。如果不想自动合并，删除默认2个选项。</p> <p><code>Volatile Range</code>: 默认为0，会自动合并所有可能的 cube segments，或者用 ‘Auto Merge’ 将不会合并最新的 [Volatile Range] 天的 cube segments。</p> <p><code>Retention Threshold</code>: 只会保存 cube 过去几天的 segment，旧的 segment 将会自动从头部删除；0表示不启用这个功能。</p> <p><code>Partition Start Date</code>: cube 的开始日期.</p> <p><img src="Kylin.assets/image-20220306131134379.png" alt="image-20220306131134379"></p></li> <li><p><strong>高级设置</strong></p> <p><code>Aggregation Groups</code>: Cube 中的维度可以划分到多个聚合组中。默认 kylin 会把所有维度放在一个聚合组，当维度较多时，产生的组合数可能是巨大的，会造成 Cube 爆炸；如果你很好的了解你的查询模式，那么你可以创建多个聚合组。在每个聚合组内，使用 “Mandatory Dimensions”, “Hierarchy Dimensions” 和 “Joint Dimensions” 来进一步优化维度组合。</p> <p><code>Mandatory Dimensions</code>: 必要维度，用于总是出现的维度。例如，如果你的查询中总是会带有 “ORDER_DATE” 做为 group by 或 过滤条件, 那么它可以被声明为必要维度。这样一来，所有不含此维度的 cuboid 就可以被跳过计算。</p> <p><code>Hierarchy Dimensions</code>: 层级维度，例如 “国家” -&gt; “省” -&gt; “市” 是一个层级；不符合此层级关系的 cuboid 可以被跳过计算，例如 [“省”], [“市”]. 定义层级维度时，将父级别维度放在子维度的左边。</p> <p><code>Joint Dimensions</code>:联合维度，有些维度往往一起出现，或者它们的基数非常接近（有1:1映射关系）。例如 “user_id” 和 “email”。把多个维度定义为组合关系后，所有不符合此关系的 cuboids 会被跳过计算。</p> <p>关于更多维度优化，请阅读这个博客: <a href="https://kylin.apache.org/blog/2016/02/18/new-aggregation-group/" target="_blank" rel="noopener noreferrer">新的聚合组<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>Rowkeys</code>: 是由维度编码值组成。</p> <p>你可以拖拽维度列去调整其在 rowkey 中位置; 位于rowkey前面的列，将可以用来大幅缩小查询的范围。通常建议将 mandantory 维度放在开头, 然后是在过滤 ( where 条件)中起到很大作用的维度；如果多个列都会被用于过滤，将高基数的维度（如 user_id）放在低基数的维度（如 age）的前面。</p> <p>此外，你还可以在这里指定使用某一列作为 shardBy 列，kylin4.0 会根据 shardBy 列对存储文件进行分片，分片能够使查询引擎跳过不必要的文件，提高查询性能，最好选择高基列并且会在多个 cuboid 中出现的列作为 shardBy 列。</p> <p><code>Mandatory Cuboids</code>: 维度组合白名单。确保你想要构建的 cuboid 能被构建。</p> <p><code>Cube Engine</code>: cube 构建引擎。Spark构建。</p> <p>这里我们使用默认。</p></li> <li><p>重写配置</p> <p>​		Kylin 允许在 Cube 级别覆盖部分 kylin.properties 中的配置，你可以在这里定义覆盖的属性。如果你没有要配置的，点击 <code>Next</code> 按钮。</p> <p><img src="Kylin.assets/image-20220306131336347.png" alt="image-20220306131336347"></p></li> <li><p><strong>概览 &amp; 保存</strong></p> <p>你可以概览你的 cube 并返回之前的步骤进行修改。点击 <code>Save</code> 按钮完成 cube 创建。</p> <p><img src="Kylin.assets/image-20220306131407732.png" alt="image-20220306131407732"></p></li> <li><p>可以返回查看Cube信息</p> <p><img src="Kylin.assets/image-20220306131510308.png" alt="image-20220306131510308"></p> <p><img src="Kylin.assets/image-20220306131616945.png" alt="image-20220306131616945"></p></li></ol> <h4 id="cube构建与监控"><a href="#cube构建与监控" class="header-anchor">#</a> Cube构建与监控</h4> <ol><li><p>在 <code>Models</code> 页面中，点击 cube 栏右侧的 <code>Action</code> 下拉按钮并选择 <code>Build</code> 操作。</p> <p><img src="Kylin.assets/image-20220306131725222.png" alt="image-20220306131725222"></p></li> <li><p>选择后会出现一个弹出窗口，点击 <code>Start Date</code> 或者 <code>End Date</code> 输入框选择这个增量 cube 构建的起始日期。</p> <blockquote><p>上面如果没有选择分区表的话，这里不会提示选择日期</p></blockquote> <p><img src="Kylin.assets/image-20220306131804632.png" alt="image-20220306131804632"></p></li> <li><p>点击 <code>Submit</code> 提交请求。成功之后，你将会在 <code>Monitor</code> 页面看到新建的 job和进度。</p> <p>新建的 job 是 “pending” 状态；一会儿，它就会开始运行并且你可以通过刷新 web 页面或者点击刷新按钮来查看进度。</p> <p><img src="Kylin.assets/image-20220306131904972.png" alt="image-20220306131904972"></p></li> <li><p>等待 job 完成。期间如要放弃这个 job ，点击 <code>Actions</code> -&gt; <code>Discard</code> 按钮。</p> <p><img src="Kylin.assets/image-20220306132010029.png" alt="image-20220306132010029"></p></li> <li><p>查看<code>Build</code>进度</p> <p><img src="Kylin.assets/image-20220306132137138.png" alt="image-20220306132137138"></p> <p><img src="Kylin.assets/image-20220306132203851.png" alt="image-20220306132203851"></p></li> <li><p>计算中查看日志，点击<code>Job</code></p> <p><img src="Kylin.assets/image-20220306132254183.png" alt="image-20220306132254183"></p> <p>弹出<code>Spark UI</code>新页面，可以看到计算步骤</p> <p><img src="Kylin.assets/image-20220306132320629.png" alt="image-20220306132320629"></p></li> <li><p>等到 job 100%完成，cube 的状态就会变为 “Ready”, 意味着它已经准备好进行 SQL 查询。在 <code>Model</code> 页，找到 cube，然后点击 cube 名展开消息，在 “Storage” 标签下，列出 cube segments。每一个 segment 都有 start/end 时间；Parquet 文件相关的信息也会列出。</p> <p><img src="Kylin.assets/image-20220306133347969.png" alt="image-20220306133347969"></p> <p><img src="Kylin.assets/image-20220306133420664.png" alt="image-20220306133420664"></p> <p><img src="Kylin.assets/image-20220307110449824.png" alt="image-20220307110449824"></p></li></ol> <h4 id="web-ui查询sql"><a href="#web-ui查询sql" class="header-anchor">#</a> WEB UI查询SQL</h4> <p>进入<code>Insight</code>输入需要执行的统计SQL，进行查询。</p> <blockquote><p>这里查询用的字段就是我们之前设置的维度字段，如果使用不设置在维度中的字段，会提示报错，找不到该字段</p> <p><img src="Kylin.assets/image-20220306135459654.png" alt="image-20220306135459654"></p></blockquote> <p><img src="Kylin.assets/image-20220306135103412.png" alt="image-20220306135103412"></p> <h2 id="三、ssb数据实际测试"><a href="#三、ssb数据实际测试" class="header-anchor">#</a> 三、SSB数据实际测试</h2> <h4 id="生成sbb基准测试数据"><a href="#生成sbb基准测试数据" class="header-anchor">#</a> 生成SBB基准测试数据</h4> <ul><li><p>SSB基准测试包括</p> <p>1个事实表：lineorder
4个维度表：customer，part，dwdate，supplier
13条标准SQL查询测试语句：统计查询、多表关联、sum、复杂条件、group by、order by等组合方式。</p></li></ul> <p>下载SSB数据生成工具：<a href="http://www.itpub.net/forum.php?mod=attachment&amp;aid=NzA1NTM0fDFiOGIzOWZifDE0NDc0ODQ2MzZ8MHww" target="_blank" rel="noopener noreferrer">http://www.itpub.net/forum.php?mod=attachment&amp;aid=NzA1NTM0fDFiOGIzOWZifDE0NDc0ODQ2MzZ8MHww<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>环境需要gcc</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> gcc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <ol><li><p>将工具上传到Linux服务器并解压</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@r-wb-15 ~<span class="token punctuation">]</span><span class="token comment"># ll</span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">102995</span> <span class="token number">3</span>月   <span class="token number">6</span> <span class="token number">14</span>:17 dbgen.zip
<span class="token punctuation">[</span>root@r-wb-15 ~<span class="token punctuation">]</span><span class="token comment"># unzip dbgen.zip </span>
<span class="token punctuation">[</span>root@r-wb-15 ~<span class="token punctuation">]</span><span class="token comment"># cd dbgen</span>
<span class="token punctuation">[</span>root@r-wb-15 dbgen<span class="token punctuation">]</span><span class="token comment"># make</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>查看生成的<code>dbgen</code>是否可用</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@r-wb-15 dbgen<span class="token punctuation">]</span><span class="token comment"># ./dbgen -h</span>
SSBM <span class="token punctuation">(</span>Star Schema Benchmark<span class="token punctuation">)</span> Population Generator <span class="token punctuation">(</span>Version <span class="token number">1.0</span>.0<span class="token punctuation">)</span>
Copyright Transaction Processing Performance Council <span class="token number">1994</span> - <span class="token number">2000</span>
USAGE:
dbgen <span class="token punctuation">[</span>-<span class="token punctuation">{</span>vfFD<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-O <span class="token punctuation">{</span>fhmsv<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-T <span class="token punctuation">{</span>pcsdla<span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span>-s <span class="token operator">&lt;</span>scale<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-C <span class="token operator">&lt;</span>procs<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>-S <span class="token operator">&lt;</span>step<span class="token operator">&gt;</span><span class="token punctuation">]</span>
dbgen <span class="token punctuation">[</span>-v<span class="token punctuation">]</span> <span class="token punctuation">[</span>-O <span class="token punctuation">{</span>dfhmr<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-s <span class="token operator">&lt;</span>scale<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-U <span class="token operator">&lt;</span>updates<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-r <span class="token operator">&lt;</span>percent<span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>生成数据文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 利用dbgen生成示例数据，-T指定表，-s指定数据放大系数
./dbgen -s 8 -T c									# CUSTOMER表
./dbgen -s 24 -T p									# PART表
./dbgen -s 8 -T s									# SUPPLIER表
./dbgen -s 1 -T d									# DATE_DIM表
./dbgen -s 2 -T l									# LINEORDER表
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>创建表结构</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> CUSTOMER <span class="token punctuation">(</span> C_CUSTKEY     <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                            C_NAME        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            C_ADDRESS     <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            C_CITY        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            C_NATION      <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            C_REGION      <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            C_PHONE       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            C_MKTSEGMENT  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> DATES <span class="token punctuation">(</span> D_DATEKEY          <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_DATE             <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         D_DAYOFWEEK        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         D_MONTH            <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         D_YEAR             <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         D_YEARMONTHNUM     <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_YEARMONTH        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         D_DAYNUMINWEEK     <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_DAYNUMINMONTH    <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_DAYNUMINYEAR     <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_MONTHNUMINYEAR   <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_WEEKNUMINYEAR    <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_SELLINGSEASON    <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         D_LASTDAYINWEEKFL  <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_LASTDAYINMONTHFL <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_HOLIDAYFL        <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         D_WEEKDAYFL        <span class="token keyword">INTEGER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                         
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> PART  <span class="token punctuation">(</span> P_PARTKEY     <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                         P_NAME        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_MFGR        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_CATEGORY    <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_BRAND       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_COLOR       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_TYPE        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_SIZE        <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                         P_CONTAINER   <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> SUPPLIER <span class="token punctuation">(</span> S_SUPPKEY     <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                            S_NAME        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            S_ADDRESS     <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            S_CITY        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            S_NATION      <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            S_REGION      <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                            S_PHONE       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> LINEORDER <span class="token punctuation">(</span> LO_ORDERKEY       <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                             LO_LINENUMBER     <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                             LO_CUSTKEY        <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                             LO_PARTKEY        <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                             LO_SUPPKEY        <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                             LO_ORDERDATE      <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                             LO_ORDERPRIOTITY  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                             LO_SHIPPRIOTITY   <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
                             LO_QUANTITY       <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                             LO_EXTENDEDPRICE  <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                             LO_ORDTOTALPRICE  <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                             LO_DISCOUNT       <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                              LO_REVENUE        <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                              LO_SUPPLYCOST     <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                              LO_TAX            <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
                              LO_COMMITDATE     <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
                              LO_SHIPMODE       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div></li> <li><p>导入数据</p> <p>导入之前生成的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token keyword">off</span><span class="token punctuation">;</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">infile</span> <span class="token string">'/opt/customer.tbl'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> CUSTOMER <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|
'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">infile</span> <span class="token string">'/opt/lineorder.tbl'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> LINEORDER <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|
'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">infile</span> <span class="token string">'/opt/supplier.tbl'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> SUPPLIER <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|
'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">infile</span> <span class="token string">'/opt/part.tbl'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> PART <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|
'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>

<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">infile</span> <span class="token string">'/opt/date.tbl'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> DATES <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|'</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'|
'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li> <li><p>Hive创建相对应的表</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> CUSTOMER <span class="token punctuation">(</span>
  C_CUSTKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  C_NAME string<span class="token punctuation">,</span>
  C_ADDRESS string<span class="token punctuation">,</span>
  C_CITY string<span class="token punctuation">,</span>
  C_NATION string<span class="token punctuation">,</span>
  C_REGION string<span class="token punctuation">,</span>
  C_PHONE string<span class="token punctuation">,</span>
  C_MKTSEGMENT string
<span class="token punctuation">)</span> <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> DATES <span class="token punctuation">(</span>
  D_DATEKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_DATE string<span class="token punctuation">,</span>
  D_DAYOFWEEK string<span class="token punctuation">,</span>
  D_MONTH string<span class="token punctuation">,</span>
  D_YEAR <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_YEARMONTHNUM <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_YEARMONTH string<span class="token punctuation">,</span>
  D_DAYNUMINWEEK <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_DAYNUMINMONTH <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_DAYNUMINYEAR <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_MONTHNUMINYEAR <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_WEEKNUMINYEAR <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_SELLINGSEASON string<span class="token punctuation">,</span>
  D_LASTDAYINWEEKFL <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_LASTDAYINMONTHFL <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_HOLIDAYFL <span class="token keyword">int</span><span class="token punctuation">,</span>
  D_WEEKDAYFL <span class="token keyword">int</span>
<span class="token punctuation">)</span> <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> LINEORDER <span class="token punctuation">(</span>
  LO_ORDERKEY <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_LINENUMBER <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_CUSTKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  LO_PARTKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  LO_SUPPKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  LO_ORDERDATE <span class="token keyword">int</span><span class="token punctuation">,</span>
  LO_ORDERPRIOTITY string<span class="token punctuation">,</span>
  LO_SHIPPRIOTITY <span class="token keyword">int</span><span class="token punctuation">,</span>
  LO_QUANTITY <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_EXTENDEDPRICE <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_ORDTOTALPRICE <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_DISCOUNT <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_REVENUE <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_SUPPLYCOST <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_TAX <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  LO_COMMITDATE <span class="token keyword">int</span><span class="token punctuation">,</span>
  LO_SHIPMODE string
<span class="token punctuation">)</span> <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> PART <span class="token punctuation">(</span>
  P_PARTKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  P_NAME string<span class="token punctuation">,</span>
  P_MFGR string<span class="token punctuation">,</span>
  P_CATEGORY string<span class="token punctuation">,</span>
  P_BRAND string<span class="token punctuation">,</span>
  P_COLOR string<span class="token punctuation">,</span>
  P_TYPE string<span class="token punctuation">,</span>
  P_SIZE <span class="token keyword">int</span><span class="token punctuation">,</span>
  P_CONTAINER string
<span class="token punctuation">)</span> <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">create</span> EXTERNAL <span class="token keyword">TABLE</span> SUPPLIER <span class="token punctuation">(</span>
  S_SUPPKEY <span class="token keyword">int</span><span class="token punctuation">,</span>
  S_NAME string<span class="token punctuation">,</span>
  S_ADDRESS string<span class="token punctuation">,</span>
  S_CITY string<span class="token punctuation">,</span>
  S_NATION string<span class="token punctuation">,</span>
  S_REGION string<span class="token punctuation">,</span>
  S_PHONE string
<span class="token punctuation">)</span> <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\t'</span>
    <span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
    STORED <span class="token keyword">AS</span> parquet TBLPROPERTIES<span class="token punctuation">(</span><span class="token string">'parquet.compression'</span><span class="token operator">=</span><span class="token string">'SNAPPY'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div></li> <li><p><code>Sqoop</code> 同步 <code>Mysql</code>数据到<code>Hive</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>sqoop <span class="token function">import</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--connect</span> jdbc:mysql://192.168.60.10:3306/test_data <span class="token punctuation">\</span>
<span class="token parameter variable">--username</span> root <span class="token punctuation">\</span>
<span class="token parameter variable">--password</span> <span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--table</span> SUPPLIER <span class="token punctuation">\</span>
--delete-target-dir <span class="token punctuation">\</span>
--hive-import <span class="token punctuation">\</span>
--hive-database test_data <span class="token punctuation">\</span>
--hive-table SUPPLIER <span class="token punctuation">\</span>
--hive-overwrite <span class="token punctuation">\</span>
--fields-terminated-by <span class="token string">&quot;<span class="token entity" title="\t">\t</span>&quot;</span> <span class="token punctuation">\</span>
--as-parquetfile <span class="token punctuation">\</span>
<span class="token parameter variable">-m</span> <span class="token number">1</span>

sqoop <span class="token function">import</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--connect</span> jdbc:mysql://192.168.60.10:3306/test_data <span class="token punctuation">\</span>
<span class="token parameter variable">--username</span> root <span class="token punctuation">\</span>
<span class="token parameter variable">--password</span> <span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--table</span> CUSTOMER <span class="token punctuation">\</span>
--delete-target-dir <span class="token punctuation">\</span>
--hive-import <span class="token punctuation">\</span>
--hive-database test_data <span class="token punctuation">\</span>
--hive-table CUSTOMER <span class="token punctuation">\</span>
--hive-overwrite <span class="token punctuation">\</span>
--fields-terminated-by <span class="token string">&quot;<span class="token entity" title="\t">\t</span>&quot;</span> <span class="token punctuation">\</span>
--as-parquetfile <span class="token punctuation">\</span>
<span class="token parameter variable">-m</span> <span class="token number">1</span>

sqoop <span class="token function">import</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--connect</span> jdbc:mysql://192.168.60.10:3306/test_data <span class="token punctuation">\</span>
<span class="token parameter variable">--username</span> root <span class="token punctuation">\</span>
<span class="token parameter variable">--password</span> <span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--table</span> DATES <span class="token punctuation">\</span>
--delete-target-dir <span class="token punctuation">\</span>
--hive-import <span class="token punctuation">\</span>
--hive-database test_data <span class="token punctuation">\</span>
--hive-table DATES <span class="token punctuation">\</span>
--hive-overwrite <span class="token punctuation">\</span>
--fields-terminated-by <span class="token string">&quot;<span class="token entity" title="\t">\t</span>&quot;</span> <span class="token punctuation">\</span>
--as-parquetfile <span class="token punctuation">\</span>
<span class="token parameter variable">-m</span> <span class="token number">1</span>

sqoop <span class="token function">import</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--connect</span> jdbc:mysql://192.168.60.10:3306/test_data <span class="token punctuation">\</span>
<span class="token parameter variable">--username</span> root <span class="token punctuation">\</span>
<span class="token parameter variable">--password</span> <span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--table</span> LINEORDER <span class="token punctuation">\</span>
--delete-target-dir <span class="token punctuation">\</span>
--hive-import <span class="token punctuation">\</span>
--hive-database test_data <span class="token punctuation">\</span>
--hive-table LINEORDER <span class="token punctuation">\</span>
--hive-overwrite <span class="token punctuation">\</span>
--fields-terminated-by <span class="token string">&quot;<span class="token entity" title="\t">\t</span>&quot;</span> <span class="token punctuation">\</span>
--as-parquetfile <span class="token punctuation">\</span>
<span class="token parameter variable">-m</span> <span class="token number">1</span>

sqoop <span class="token function">import</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--connect</span> jdbc:mysql://192.168.60.10:3306/test_data <span class="token punctuation">\</span>
<span class="token parameter variable">--username</span> root <span class="token punctuation">\</span>
<span class="token parameter variable">--password</span> <span class="token number">123456</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--table</span> PART <span class="token punctuation">\</span>
--delete-target-dir <span class="token punctuation">\</span>
--hive-import <span class="token punctuation">\</span>
--hive-database test_data <span class="token punctuation">\</span>
--hive-table PART <span class="token punctuation">\</span>
--hive-overwrite <span class="token punctuation">\</span>
--fields-terminated-by <span class="token string">&quot;<span class="token entity" title="\t">\t</span>&quot;</span> <span class="token punctuation">\</span>
--as-parquetfile <span class="token punctuation">\</span>
<span class="token parameter variable">-m</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div></li> <li><p>标准测试SQL</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>PROMPT Q1<span class="token punctuation">.</span><span class="token number">1</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_EXTENDEDPRICE<span class="token operator">*</span>LO_DISCOUNT<span class="token punctuation">)</span> <span class="token keyword">AS</span>
REVENUE
<span class="token keyword">FROM</span>  LINEORDER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> D_YEAR <span class="token operator">=</span> <span class="token number">1993</span>
<span class="token operator">AND</span> LO_DISCOUNT <span class="token operator">BETWEEN</span> <span class="token number">1</span> <span class="token operator">AND</span> <span class="token number">3</span>
<span class="token operator">AND</span> LO_QUANTITY <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">;</span>


PROMPT Q1<span class="token punctuation">.</span><span class="token number">2</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_EXTENDEDPRICE<span class="token operator">*</span>LO_DISCOUNT<span class="token punctuation">)</span> <span class="token keyword">AS</span>
REVENUE
<span class="token keyword">FROM</span>  LINEORDER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> D_YEARMONTH <span class="token operator">=</span> <span class="token string">'Jan1994'</span>
<span class="token operator">AND</span> LO_DISCOUNT <span class="token operator">BETWEEN</span> <span class="token number">4</span> <span class="token operator">AND</span> <span class="token number">6</span>
<span class="token operator">AND</span> LO_QUANTITY <span class="token operator">BETWEEN</span>  <span class="token number">26</span> <span class="token operator">AND</span> <span class="token number">35</span><span class="token punctuation">;</span>


PROMPT Q1<span class="token punctuation">.</span><span class="token number">3</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_EXTENDEDPRICE<span class="token operator">*</span>LO_DISCOUNT<span class="token punctuation">)</span> <span class="token keyword">AS</span>
REVENUE
<span class="token keyword">FROM</span>  LINEORDER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> D_WEEKNUMINYEAR <span class="token operator">=</span> <span class="token number">6</span>
<span class="token operator">AND</span> D_YEAR <span class="token operator">=</span> <span class="token number">1994</span>
<span class="token operator">AND</span> LO_DISCOUNT <span class="token operator">BETWEEN</span>  <span class="token number">5</span> <span class="token operator">AND</span> <span class="token number">7</span>
<span class="token operator">AND</span> LO_QUANTITY <span class="token operator">BETWEEN</span>  <span class="token number">26</span> <span class="token operator">AND</span> <span class="token number">35</span><span class="token punctuation">;</span>


PROMPT Q2<span class="token punctuation">.</span><span class="token number">1</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span><span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">FROM</span> LINEORDER<span class="token punctuation">,</span> DATES<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> SUPPLIER
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> P_CATEGORY <span class="token operator">=</span> <span class="token string">'MFGR#12'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">;</span>


PROMPT Q2<span class="token punctuation">.</span><span class="token number">2</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span><span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">FROM</span> LINEORDER<span class="token punctuation">,</span> DATES<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> SUPPLIER
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> P_BRAND <span class="token operator">BETWEEN</span>  <span class="token string">'MFGR#2221'</span>
<span class="token operator">AND</span> <span class="token string">'MFGR#2228'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'ASIA'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">;</span>


PROMPT Q2<span class="token punctuation">.</span><span class="token number">3</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span><span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">FROM</span> LINEORDER<span class="token punctuation">,</span> DATES<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> SUPPLIER
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> P_BRAND<span class="token operator">=</span> <span class="token string">'MFGR#2239'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'EUROPE'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">;</span>


PROMPT Q3<span class="token punctuation">.</span><span class="token number">1</span>
<span class="token keyword">SELECT</span> C_NATION<span class="token punctuation">,</span> S_NATION<span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span>  <span class="token keyword">AS</span>  REVENUE
<span class="token keyword">FROM</span> CUSTOMER<span class="token punctuation">,</span> LINEORDER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> C_REGION <span class="token operator">=</span> <span class="token string">'ASIA'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'ASIA'</span>
<span class="token operator">AND</span> D_YEAR <span class="token operator">&gt;=</span> <span class="token number">1992</span> <span class="token operator">AND</span> D_YEAR <span class="token operator">&lt;=</span> <span class="token number">1997</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> C_NATION<span class="token punctuation">,</span> S_NATION<span class="token punctuation">,</span> D_YEAR
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR <span class="token keyword">ASC</span><span class="token punctuation">,</span>  REVENUE <span class="token keyword">DESC</span><span class="token punctuation">;</span>


PROMPT Q3<span class="token punctuation">.</span><span class="token number">2</span>
<span class="token keyword">SELECT</span> C_CITY<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span>
<span class="token keyword">AS</span>  REVENUE
<span class="token keyword">FROM</span> CUSTOMER<span class="token punctuation">,</span> LINEORDER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> C_NATION <span class="token operator">=</span> <span class="token string">'UNITED STATES'</span>
<span class="token operator">AND</span> S_NATION <span class="token operator">=</span> <span class="token string">'UNITED STATES'</span>
<span class="token operator">AND</span> D_YEAR <span class="token operator">&gt;=</span> <span class="token number">1992</span> <span class="token operator">AND</span> D_YEAR <span class="token operator">&lt;=</span> <span class="token number">1997</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> C_CITY<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> D_YEAR
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR <span class="token keyword">ASC</span><span class="token punctuation">,</span>  REVENUE <span class="token keyword">DESC</span><span class="token punctuation">;</span>


PROMPT Q3<span class="token punctuation">.</span><span class="token number">3</span>
<span class="token keyword">SELECT</span> C_CITY<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span>
<span class="token keyword">AS</span>  REVENUE
<span class="token keyword">FROM</span> CUSTOMER<span class="token punctuation">,</span> LINEORDER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span>  <span class="token punctuation">(</span>C_CITY<span class="token operator">=</span><span class="token string">'UNITED KI1'</span>
<span class="token operator">OR</span> C_CITY<span class="token operator">=</span><span class="token string">'UNITED KI5'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span>S_CITY<span class="token operator">=</span><span class="token string">'UNITED KI1'</span>
<span class="token operator">OR</span> S_CITY<span class="token operator">=</span><span class="token string">'UNITED KI5'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> D_YEAR <span class="token operator">&gt;=</span> <span class="token number">1992</span> <span class="token operator">AND</span> D_YEAR <span class="token operator">&lt;=</span> <span class="token number">1997</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> C_CITY<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> D_YEAR
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR <span class="token keyword">ASC</span><span class="token punctuation">,</span>  REVENUE <span class="token keyword">DESC</span><span class="token punctuation">;</span>


PROMPT Q3<span class="token punctuation">.</span><span class="token number">4</span>
<span class="token keyword">SELECT</span> C_CITY<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span>
<span class="token keyword">AS</span>  REVENUE
<span class="token keyword">FROM</span> CUSTOMER<span class="token punctuation">,</span> LINEORDER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> DATES
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span>  <span class="token punctuation">(</span>C_CITY<span class="token operator">=</span><span class="token string">'UNITED KI1'</span>
<span class="token operator">OR</span> C_CITY<span class="token operator">=</span><span class="token string">'UNITED KI5'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span>S_CITY<span class="token operator">=</span><span class="token string">'UNITED KI1'</span>
<span class="token operator">OR</span> S_CITY<span class="token operator">=</span><span class="token string">'UNITED KI5'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> D_YEARMONTH <span class="token operator">=</span> <span class="token string">'Dec1997'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> C_CITY<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> D_YEAR
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR <span class="token keyword">ASC</span><span class="token punctuation">,</span>  REVENUE <span class="token keyword">DESC</span><span class="token punctuation">;</span>


PROMPT Q4<span class="token punctuation">.</span><span class="token number">1</span>
<span class="token keyword">SELECT</span> D_YEAR<span class="token punctuation">,</span> C_NATION<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE <span class="token operator">-</span> LO_SUPPLYCOST<span class="token punctuation">)</span> <span class="token keyword">AS</span> PROFIT
<span class="token keyword">FROM</span> DATES<span class="token punctuation">,</span> CUSTOMER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> LINEORDER
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> C_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span>P_MFGR <span class="token operator">=</span> <span class="token string">'MFGR#1'</span>
<span class="token operator">OR</span> P_MFGR <span class="token operator">=</span> <span class="token string">'MFGR#2'</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> C_NATION
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> C_NATION<span class="token punctuation">;</span>


PROMPT Q4<span class="token punctuation">.</span><span class="token number">2</span>
<span class="token keyword">SELECT</span> D_YEAR<span class="token punctuation">,</span> S_NATION<span class="token punctuation">,</span> P_CATEGORY<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE <span class="token operator">-</span> LO_SUPPLYCOST<span class="token punctuation">)</span> <span class="token keyword">AS</span> PROFIT
<span class="token keyword">FROM</span> DATES<span class="token punctuation">,</span> CUSTOMER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> LINEORDER
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> C_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span>D_YEAR <span class="token operator">=</span> <span class="token number">1997</span> <span class="token operator">OR</span> D_YEAR <span class="token operator">=</span> <span class="token number">1998</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span>P_MFGR <span class="token operator">=</span> <span class="token string">'MFGR#1'</span>
<span class="token operator">OR</span> P_MFGR <span class="token operator">=</span> <span class="token string">'MFGR#2'</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> S_NATION<span class="token punctuation">,</span> P_CATEGORY
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> S_NATION<span class="token punctuation">,</span> P_CATEGORY<span class="token punctuation">;</span>


PROMPT Q4<span class="token punctuation">.</span><span class="token number">3</span>
<span class="token keyword">SELECT</span> D_YEAR<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE <span class="token operator">-</span> LO_SUPPLYCOST<span class="token punctuation">)</span> <span class="token keyword">AS</span> PROFIT
<span class="token keyword">FROM</span> DATES<span class="token punctuation">,</span> CUSTOMER<span class="token punctuation">,</span> SUPPLIER<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> LINEORDER
<span class="token keyword">WHERE</span>  LO_CUSTKEY <span class="token operator">=</span> C_CUSTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> S_NATION <span class="token operator">=</span> <span class="token string">'UNITED STATES'</span>
<span class="token operator">AND</span> <span class="token punctuation">(</span>D_YEAR <span class="token operator">=</span> <span class="token number">1997</span> <span class="token operator">OR</span> D_YEAR <span class="token operator">=</span> <span class="token number">1998</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> P_CATEGORY <span class="token operator">=</span> <span class="token string">'MFGR#14'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> S_CITY<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br></div></div></li> <li><p>这里我们先用这个sql做测试</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span><span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">FROM</span> LINEORDER<span class="token punctuation">,</span> DATES<span class="token punctuation">,</span> PART<span class="token punctuation">,</span> SUPPLIER
<span class="token keyword">WHERE</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token operator">AND</span> LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token operator">AND</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token operator">AND</span> P_CATEGORY <span class="token operator">=</span> <span class="token string">'MFGR#12'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">;</span>

Kylin不支持笛卡尔积查询，我们转换为<span class="token keyword">JOIN</span>查询
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>LO_REVENUE<span class="token punctuation">)</span> <span class="token keyword">AS</span> SUM1<span class="token punctuation">,</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">FROM</span> LINEORDER 
<span class="token keyword">JOIN</span> DATES <span class="token keyword">ON</span>  LO_ORDERDATE <span class="token operator">=</span> D_DATEKEY
<span class="token keyword">JOIN</span> PART <span class="token keyword">ON</span>  LO_PARTKEY <span class="token operator">=</span> P_PARTKEY
<span class="token keyword">JOIN</span> SUPPLIER <span class="token keyword">ON</span> LO_SUPPKEY <span class="token operator">=</span> S_SUPPKEY
<span class="token keyword">WHERE</span>  
P_CATEGORY <span class="token operator">=</span> <span class="token string">'MFGR#12'</span>
<span class="token operator">AND</span> S_REGION <span class="token operator">=</span> <span class="token string">'AMERICA'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> D_YEAR<span class="token punctuation">,</span> P_BRAND<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><blockquote><p>Kylin不支持笛卡尔积查询，查询报错如下</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>Cartesian Join is not supported. <span class="token keyword">while</span> executing SQL: <span class="token string">&quot;select * from (SELECT SUM(LO_REVENUE), D_YEAR, P_BRAND FROM LINEORDER, DATES, PART, SUPPLIER WHERE LO_ORDERDATE = D_DATEKEY AND LO_PARTKEY = P_PARTKEY AND LO_SUPPKEY = S_SUPPKEY AND P_CATEGORY = 'MFGR#12' AND S_REGION = 'AMERICA' GROUP BY D_YEAR, P_BRAND ORDER BY D_YEAR, P_BRAND) limit 50000&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote></li> <li><p>Kylin创建Model</p> <p><img src="Kylin.assets/image-20220306153715066.png" alt="image-20220306153715066"></p> <p><img src="Kylin.assets/image-20220306153855808.png" alt="image-20220306153855808"></p> <p><img src="Kylin.assets/image-20220306153920744.png" alt="image-20220306153920744"></p></li> <li><p>创建CUBE</p> <p><img src="Kylin.assets/image-20220306154001772.png" alt="image-20220306154001772"></p> <p><img src="Kylin.assets/image-20220306154027967.png" alt="image-20220306154027967"></p> <p><img src="Kylin.assets/image-20220306154039330.png" alt="image-20220306154039330"></p> <p><img src="Kylin.assets/image-20220306154130969.png" alt="image-20220306154130969"></p> <p><img src="Kylin.assets/image-20220306154148296.png" alt="image-20220306154148296"></p> <p>一直Next直至完成</p></li> <li><p>build CUBE</p> <p><img src="Kylin.assets/image-20220306154342428.png" alt="image-20220306154342428"></p></li> <li><p>Build 完成</p> <p>Build 构建共花了156分钟</p> <p><img src="Kylin.assets/image-20220307095512272.png" alt="image-20220307095512272"></p></li> <li><p>数据图表展示及导出</p> <p><img src="Kylin.assets/image-20220307101012062.png" alt="image-20220307101012062"></p> <h4 id="mysql查询、hive查询、kylin查询对比"><a href="#mysql查询、hive查询、kylin查询对比" class="header-anchor">#</a> Mysql查询、Hive查询、Kylin查询对比</h4> <table><thead><tr><th style="text-align:left;">查询类型</th> <th>耗时</th></tr></thead> <tbody><tr><td style="text-align:left;">Mysql</td> <td>超时</td></tr> <tr><td style="text-align:left;">Kylin</td> <td>1秒以内</td></tr> <tr><td style="text-align:left;">Hive</td> <td>74.237秒</td></tr></tbody></table> <ul><li><p>Mysql查询超时</p> <p><img src="Kylin.assets/image-20220307095126321.png" alt="image-20220307095126321"></p></li> <li><p>Kylin查询秒级响应</p> <p><img src="Kylin.assets/image-20220307095155065.png" alt="image-20220307095155065"></p></li> <li><p>Hive查询74秒</p></li></ul> <p><img src="Kylin.assets/image-20220307095424409.png" alt="image-20220307095424409"></p></li></ol> <h2 id="四、kylin使用注意事项"><a href="#四、kylin使用注意事项" class="header-anchor">#</a> 四、Kylin使用注意事项</h2> <h4 id="只能按照构建model的连接条件写sql查询"><a href="#只能按照构建model的连接条件写sql查询" class="header-anchor">#</a> 只能按照构建Model的连接条件写SQL查询</h4> <p>​		在创建Model时候我们会指定表之间的关联关系，这个时候指定的关系，在后面查询SQL也只能查询这种关系的SQL。</p> <p><img src="Kylin.assets/image-20220307102420710.png" alt="image-20220307102420710"></p> <p><img src="Kylin.assets/image-20220307102308298.png" alt="image-20220307102308298"></p> <p>如果不按照设定的<code>join</code>类型，会提示错误</p> <p>示例：改成<code>LEFT JOIN</code>去查询，无法返回结果</p> <p><img src="Kylin.assets/image-20220307102534569.png" alt="image-20220307102534569"></p> <h4 id="只能按照构建-cube-时选择的维度字段分组统计"><a href="#只能按照构建-cube-时选择的维度字段分组统计" class="header-anchor">#</a> 只能按照构建 Cube 时选择的维度字段分组统计</h4> <p>分组统计、查询字段必须在创建<code>Cube</code>时选择上维度，否则无法当做条件查询。</p> <p>示例：我们使用未在维度中字段查询，提示报错</p> <p><img src="Kylin.assets/image-20220307102908506.png" alt="image-20220307102908506"></p> <h4 id="只能统计构建-cube-时选择的度量值字段"><a href="#只能统计构建-cube-时选择的度量值字段" class="header-anchor">#</a> <strong>只能统计构建</strong> <strong>Cube</strong> 时选择的度量值字段</h4> <p>在统计时候只能统计添加度量值字段（默认会有一个<code>count(*)</code>来统计数量。）</p> <p>示例：统计不在度量值的字段会提示报错</p> <p><img src="Kylin.assets/image-20220307103041884.png" alt="image-20220307103041884"></p> <h2 id="五、kylin每日自动构建cube"><a href="#五、kylin每日自动构建cube" class="header-anchor">#</a> 五、Kylin每日自动构建Cube</h2> <p>​		Kylin 提供了 Restful API，因次我们可以将构建 cube 的命令写到脚本中，将脚本交给
azkaban 或者 oozie 这样的调度工具，以实现定时调度的功能。</p> <p>认证密码加密方式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>${Authorization}计算方式:
Base64($username:$password)

Authorization: Basic ${Authorization}
Authorization: Basic QURNSU46S1lMSU4=
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>kylin_cube_build.sh 脚本如下:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#从第 1 个参数获取 cube_name</span>
<span class="token assign-left variable">cube_name</span><span class="token operator">=</span><span class="token variable">$1</span> <span class="token comment">#从第 2 个参数获取构建 cube 时间</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$2</span>&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token assign-left variable">do_date</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token keyword">else</span>
<span class="token assign-left variable">do_date</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> <span class="token parameter variable">-d</span> <span class="token string">'-1 day'</span> +%F<span class="token variable">`</span></span>
<span class="token keyword">fi</span>
<span class="token comment">#获取执行时间的 00:00:00 时间戳(0 时区)</span>
<span class="token assign-left variable">start_date_unix</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$do_date</span> 08:00:00&quot;</span> +%s<span class="token variable">`</span></span>
<span class="token comment">#秒级时间戳变毫秒级</span>
<span class="token assign-left variable">start_date</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$start_date_unix<span class="token operator">*</span><span class="token number">1000</span><span class="token variable">))</span></span>
<span class="token comment">#获取执行时间的 24:00 的时间戳</span>
<span class="token assign-left variable">stop_date</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$start_date<span class="token operator">+</span><span class="token number">86400000</span><span class="token variable">))</span></span>
<span class="token function">curl</span> <span class="token parameter variable">-X</span> PUT <span class="token parameter variable">-H</span> <span class="token string">&quot;Authorization: Basic QURNSU46S1lMSU4=&quot;</span> <span class="token parameter variable">-H</span>  <span class="token string">'Content-Type: application/json'</span> <span class="token parameter variable">-d</span> <span class="token string">'{&quot;startTime&quot;:'</span><span class="token variable">$start_date</span><span class="token string">',&quot;endTime&quot;:'</span><span class="token variable">$stop_date</span><span class="token string">', &quot;buildType&quot;:&quot;BUILD&quot;}'</span> http://192.168.60.15:7070/kylin/api/cubes/<span class="token variable">$cube_name</span>/build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>注：我们没有修改 kylin 的时区，因此 kylin 内部只识别 0 时区的时间，0 时区的 0 点是</p> <p>东 8 区的早上 8 点，因此我们在脚本里要写$do_date 08:00:00 来弥补时差问题。</p> <h2 id="六、bi工具集成"><a href="#六、bi工具集成" class="header-anchor">#</a> 六、BI工具集成</h2> <p>可以与 Kylin 结合使用的可视化工具很多，例如：</p> <p>ODBC：与 Tableau、Excel、PowerBI 等工具集成</p> <p><code>JDBC</code>：与 Saiku、BIRT 等 Java 工具集成</p> <p>RestAPI：与 JavaScript、Web 网页集成</p> <p>Kylin 开发团队还贡献了 <code>Zepplin</code>的插件，也可以使用 Zepplin 来访问 Kylin 服务。</p> <h3 id="jdbc"><a href="#jdbc" class="header-anchor">#</a> JDBC</h3> <ol><li><p>新建项目并导入依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.kylin/kylin-jdbc --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.kylin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>kylin-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>Java代码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author Jast
 * @description
 * @date 2022-03-07 11:22
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KylinTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//Kylin_JDBC 驱动</span>
        <span class="token class-name">String</span> <span class="token constant">KYLIN_DRIVER</span> <span class="token operator">=</span> <span class="token string">&quot;org.apache.kylin.jdbc.Driver&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//Kylin_URL</span>
        <span class="token class-name">String</span> <span class="token constant">KYLIN_URL</span> <span class="token operator">=</span>
                <span class="token string">&quot;jdbc:kylin://192.168.60.15:7070/FirstProject&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//Kylin 的用户名</span>
        <span class="token class-name">String</span> <span class="token constant">KYLIN_USER</span> <span class="token operator">=</span> <span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//Kylin 的密码</span>
        <span class="token class-name">String</span> <span class="token constant">KYLIN_PASSWD</span> <span class="token operator">=</span> <span class="token string">&quot;KYLIN&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//添加驱动信息</span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token constant">KYLIN_DRIVER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取连接</span>
        <span class="token class-name">Connection</span> connection <span class="token operator">=</span>
                <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token constant">KYLIN_URL</span><span class="token punctuation">,</span> <span class="token constant">KYLIN_USER</span><span class="token punctuation">,</span> <span class="token constant">KYLIN_PASSWD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//预编译 SQL</span>
        <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT SUM(LO_REVENUE) AS SUM1, D_YEAR, P_BRAND FROM LINEORDER  JOIN DATES ON  LO_ORDERDATE = D_DATEKEY JOIN PART ON  LO_PARTKEY = P_PARTKEY JOIN SUPPLIER ON LO_SUPPKEY = S_SUPPKEY WHERE   P_CATEGORY = 'MFGR#12' AND S_REGION = 'AMERICA' GROUP BY D_YEAR, P_BRAND ORDER BY D_YEAR, P_BRAND;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//执行查询</span>
        <span class="token class-name">ResultSet</span> resultSet <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//遍历打印</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> resultSet<span class="token punctuation">.</span>getDouble
                    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div></li></ol> <h3 id="zepplin"><a href="#zepplin" class="header-anchor">#</a> Zepplin</h3> <p>下载地址：<a href="https://zeppelin.apache.org/download.html" target="_blank" rel="noopener noreferrer">https://zeppelin.apache.org/download.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="安装与启动"><a href="#安装与启动" class="header-anchor">#</a> 安装与启动</h4> <ol><li><p>下载</p> <p>这个安装包较大，下载的这个版本1.6G</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">wget</span> https://dlcdn.apache.org/zeppelin/zeppelin-0.10.1/zeppelin-0.10.1-bin-all.tgz --no-check-certificate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>将<code>zeppelin-0.10.1.tar.gz</code>上传到Linux服务器</p></li> <li><p>解压、重命名</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> zeppelin-0.10.1-bin-all.tgz
<span class="token function">mv</span> zeppelin-0.10.1-bin-all zeppelin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>修改启动参数</p> <p>修改文件<code>zeppelin-site.xml</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mv</span> zeppelin-site.xml.template zeppelin-site.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改前：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>zeppelin.server.addr<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>127.0.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Server binding address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>zeppelin.server.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>8080<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Server port.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>修改后</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>zeppelin.server.addr<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>0.0.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Server binding address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>zeppelin.server.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>17890<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Server port.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>启动</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>functions.sh                 stop-interpreter.sh          zeppelin.sh                  
<span class="token punctuation">[</span>root@r-wb-15 zeppelin<span class="token punctuation">]</span><span class="token comment"># bin/zeppelin-daemon.sh start</span>
Please specify HADOOP_CONF_DIR <span class="token keyword">if</span> USE_HADOOP is <span class="token boolean">true</span>
Log <span class="token function">dir</span> doesn<span class="token string">'t exist, create /root/zeppelin/logs
Pid dir doesn'</span>t exist, create /root/zeppelin/run
Zeppelin start                                             <span class="token punctuation">[</span>  OK  <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ol> <h4 id="访问"><a href="#访问" class="header-anchor">#</a> 访问</h4> <p>访问地址<code>http://192.168.60.15:17890/</code></p> <p><img src="Kylin.assets/image-20220307142837713.png" alt="image-20220307142837713"></p> <h4 id="配置kylin"><a href="#配置kylin" class="header-anchor">#</a> 配置Kylin</h4> <ol><li><p>点击右上角 anonymous 选择 Interpreter</p> <p><img src="Kylin.assets/image-20220307144027100.png" alt="image-20220307144027100"></p></li> <li><p>搜索<code>Kylin</code>并配置基本信息</p> <p><img src="Kylin.assets/image-20220307144235300.png" alt="image-20220307144235300"></p></li></ol> <h4 id="使用zepplin查询kylin"><a href="#使用zepplin查询kylin" class="header-anchor">#</a> 使用Zepplin查询Kylin</h4> <ol><li><p>点击<code>Notebook</code>-&gt;<code>Create new note</code></p> <p><img src="Kylin.assets/image-20220307144340191.png" alt="image-20220307144340191"></p></li> <li><p>填写<code>Note Name</code>和<code>Default Interpreter</code></p> <ol><li><p><img src="Kylin.assets/image-20220307144515002.png" alt="image-20220307144515002"></p> <p><img src="Kylin.assets/image-20220307144621902.png" alt="image-20220307144621902"></p> <blockquote><p>如果上面<code>Default Interpreter</code>没有选择默认的为<code>Kylin</code>，每次输入指定的<code>SQL</code>需要在前面加上<code>%kylin</code></p> <p><img src="Kylin.assets/image-20220307144947387.png" alt="image-20220307144947387"></p></blockquote></li></ol></li> <li><p>查询<code>Kylin</code></p> <p><img src="Kylin.assets/image-20220307144843459.png" alt="image-20220307144843459"></p></li></ol></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/03/10, 16:49:38</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/072cb2/"><div>
            TODO-Clickhouse-Explain查看执行计划
            <!----></div></a> <span class="date">07-02</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f4e4dc/"><div>
            Ambari自定义服务开发-metainfo详细介绍
            <!----></div></a> <span class="date">07-01</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/4983ce/"><div>
            IoTDB服务安装教程-单机版
            <!----></div></a> <span class="date">07-01</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:745925668@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://datamining.blog.csdn.net/" title="CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2016-2025
    <span><a href="https://datamining.blog.csdn.net/">Jast-zsh</a> | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.a5c64990.js" defer></script><script src="/assets/js/2.9cc65402.js" defer></script><script src="/assets/js/270.8151a5d3.js" defer></script>
  </body>
</html>
